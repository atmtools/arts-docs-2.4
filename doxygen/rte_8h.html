<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: rte.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.4.0(git:4fb77825)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('rte_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rte.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declaration of functions in <a class="el" href="rte_8cc.html" title="Functions to solve radiative transfer tasks.">rte.cc</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="agenda__class_8h_source.html">agenda_class.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arts_8h_source.html">arts.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="auto__md_8h_source.html">auto_md.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="complex_8h_source.html">complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="jacobian_8h_source.html">jacobian.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matpackI_8h_source.html">matpackI.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matpackII_8h_source.html">matpackII.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matpackIII_8h_source.html">matpackIII.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="optproperties_8h_source.html">optproperties.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ppath_8h_source.html">ppath.h</a>&quot;</code><br />
</div>
<p><a href="rte_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a869331bf4ae5a03ae1b5f3c684e18610"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a869331bf4ae5a03ae1b5f3c684e18610">adapt_stepwise_partial_derivatives</a> (<a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;dK_dx, <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;dS_dx, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_f_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_line_of_sight, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_vmrs, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_temperature, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_pressure, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jacobian_species, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jacobian_wind, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lte, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const bool &amp;jacobian_do)</td></tr>
<tr class="memdesc:a869331bf4ae5a03ae1b5f3c684e18610"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adapts clearsky partial derivatives.  <a href="rte_8h.html#a869331bf4ae5a03ae1b5f3c684e18610">More...</a><br /></td></tr>
<tr class="separator:a869331bf4ae5a03ae1b5f3c684e18610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a575171c69ce06a82458db816fe6817d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a575171c69ce06a82458db816fe6817d1">adjust_los</a> (<a class="el" href="classVectorView.html">VectorView</a> los, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim)</td></tr>
<tr class="memdesc:a575171c69ce06a82458db816fe6817d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensures that the zenith and azimuth angles of a line-of-sight vector are inside defined ranges.  <a href="rte_8h.html#a575171c69ce06a82458db816fe6817d1">More...</a><br /></td></tr>
<tr class="separator:a575171c69ce06a82458db816fe6817d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82342977d9b6ca7b99a1fb8dd2fd546b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a82342977d9b6ca7b99a1fb8dd2fd546b">apply_iy_unit</a> (<a class="el" href="classMatrixView.html">MatrixView</a> iy, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;n, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;i_pol)</td></tr>
<tr class="memdesc:a82342977d9b6ca7b99a1fb8dd2fd546b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs conversion from radiance to other units, as well as applies refractive index to fulfill the n2-law of radiance.  <a href="rte_8h.html#a82342977d9b6ca7b99a1fb8dd2fd546b">More...</a><br /></td></tr>
<tr class="separator:a82342977d9b6ca7b99a1fb8dd2fd546b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29412101765cdcad820a88ba3fc374b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#ac29412101765cdcad820a88ba3fc374b">apply_iy_unit2</a> (<a class="el" href="classTensor3View.html">Tensor3View</a> J, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> iy, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;n, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;i_pol)</td></tr>
<tr class="memdesc:ac29412101765cdcad820a88ba3fc374b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Largely as <em>apply_iy_unit</em> but operates on jacobian data.  <a href="rte_8h.html#ac29412101765cdcad820a88ba3fc374b">More...</a><br /></td></tr>
<tr class="separator:ac29412101765cdcad820a88ba3fc374b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaa4b90d0ae5df2c53c4aede88bc9dde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#abaa4b90d0ae5df2c53c4aede88bc9dde">bending_angle1d</a> (<a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;alpha, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath)</td></tr>
<tr class="memdesc:abaa4b90d0ae5df2c53c4aede88bc9dde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the bending angle for a 1D atmosphere.  <a href="rte_8h.html#abaa4b90d0ae5df2c53c4aede88bc9dde">More...</a><br /></td></tr>
<tr class="separator:abaa4b90d0ae5df2c53c4aede88bc9dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34d779c23e0baa2b84a12e89b46ac3d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a34d779c23e0baa2b84a12e89b46ac3d0">defocusing_general</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;dlf, const <a class="el" href="classAgenda.html">Agenda</a> &amp;ppath_step_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lat_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lon_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> z_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> refellipsoid, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> z_surface, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lmax, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lraytrace, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;dza, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a34d779c23e0baa2b84a12e89b46ac3d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defocusing for arbitrary geometry (zenith angle part only)  <a href="rte_8h.html#a34d779c23e0baa2b84a12e89b46ac3d0">More...</a><br /></td></tr>
<tr class="separator:a34d779c23e0baa2b84a12e89b46ac3d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3569110b3bd722854e8c74f66d682401"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a3569110b3bd722854e8c74f66d682401">defocusing_sat2sat</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;dlf, const <a class="el" href="classAgenda.html">Agenda</a> &amp;ppath_step_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lat_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lon_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> z_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> refellipsoid, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> z_surface, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lmax, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_lraytrace, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;dza, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:a3569110b3bd722854e8c74f66d682401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates defocusing for limb measurements between two satellites.  <a href="rte_8h.html#a3569110b3bd722854e8c74f66d682401">More...</a><br /></td></tr>
<tr class="separator:a3569110b3bd722854e8c74f66d682401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503628846269c3508d94586ef5737db0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a503628846269c3508d94586ef5737db0">dotprod_with_los</a> (<a class="el" href="classConstVectorView.html">ConstVectorView</a> los, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;u, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;v, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;<a class="el" href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a>, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim)</td></tr>
<tr class="memdesc:a503628846269c3508d94586ef5737db0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the dot product between a field and a LOS.  <a href="rte_8h.html#a503628846269c3508d94586ef5737db0">More...</a><br /></td></tr>
<tr class="separator:a503628846269c3508d94586ef5737db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a47395262affef65d6b53b6dc91c1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a49a47395262affef65d6b53b6dc91c1a">ext2trans</a> (<a class="el" href="classMatrixView.html">MatrixView</a> trans_mat, <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;icase, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> ext_mat_av, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;l_step)</td></tr>
<tr class="memdesc:a49a47395262affef65d6b53b6dc91c1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an extinction matrix to a transmission matrix.  <a href="rte_8h.html#a49a47395262affef65d6b53b6dc91c1a">More...</a><br /></td></tr>
<tr class="separator:a49a47395262affef65d6b53b6dc91c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf12808edf084d4810751d718f19c501"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#adf12808edf084d4810751d718f19c501">get_iy</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classMatrix.html">Matrix</a> &amp;iy, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;nlte_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> rte_pos, <a class="el" href="classConstVectorView.html">ConstVectorView</a> rte_los, <a class="el" href="classConstVectorView.html">ConstVectorView</a> rte_pos2, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_main_agenda)</td></tr>
<tr class="memdesc:adf12808edf084d4810751d718f19c501"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic call of <em>iy_main_agenda</em>.  <a href="rte_8h.html#adf12808edf084d4810751d718f19c501">More...</a><br /></td></tr>
<tr class="separator:adf12808edf084d4810751d718f19c501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35001fc0e0fd1aed10e3289b6a9b1ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#ac35001fc0e0fd1aed10e3289b6a9b1ac">get_iy_of_background</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classMatrix.html">Matrix</a> &amp;iy, <a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;diy_dx, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> iy_transmission, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;iy_id, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;jacobian_do, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, <a class="el" href="classConstVectorView.html">ConstVectorView</a> rte_pos2, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;nlte_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;stokes_dim, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> surface_props_data, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_main_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_space_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_surface_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_cloudbox_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;iy_agenda_call1, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:ac35001fc0e0fd1aed10e3289b6a9b1ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines iy of the "background" of a propgation path.  <a href="rte_8h.html#ac35001fc0e0fd1aed10e3289b6a9b1ac">More...</a><br /></td></tr>
<tr class="separator:ac35001fc0e0fd1aed10e3289b6a9b1ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a285e9c0738d22752782b878655ba2e4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a285e9c0738d22752782b878655ba2e4f">get_ppath_atmvars</a> (<a class="el" href="classVector.html">Vector</a> &amp;ppath_p, <a class="el" href="classVector.html">Vector</a> &amp;ppath_t, <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;ppath_nlte, <a class="el" href="classMatrix.html">Matrix</a> &amp;ppath_vmr, <a class="el" href="classMatrix.html">Matrix</a> &amp;ppath_wind, <a class="el" href="classMatrix.html">Matrix</a> &amp;ppath_mag, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, <a class="el" href="classConstVectorView.html">ConstVectorView</a> p_grid, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> t_field, const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;nlte_field, <a class="el" href="classConstTensor4View.html">ConstTensor4View</a> vmr_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> wind_u_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> wind_v_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> wind_w_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> mag_u_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> mag_v_field, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> mag_w_field)</td></tr>
<tr class="memdesc:a285e9c0738d22752782b878655ba2e4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines pressure, temperature, VMR, winds and magnetic field for each propgataion path point.  <a href="rte_8h.html#a285e9c0738d22752782b878655ba2e4f">More...</a><br /></td></tr>
<tr class="separator:a285e9c0738d22752782b878655ba2e4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73d329f4fc10440318a1f672ba02470"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#af73d329f4fc10440318a1f672ba02470">get_ppath_cloudvars</a> (<a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;clear2cloudy, <a class="el" href="classMatrix.html">Matrix</a> &amp;ppath_pnd, <a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;ppath_dpnd_dx, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, const <a class="el" href="classTensor4.html">Tensor4</a> &amp;pnd_field, const <a class="el" href="array_8h.html#ac48f73312253e57be4cef9d0f6213b20">ArrayOfTensor4</a> &amp;dpnd_field_dx)</td></tr>
<tr class="memdesc:af73d329f4fc10440318a1f672ba02470"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the particle fields along a propagation path.  <a href="rte_8h.html#af73d329f4fc10440318a1f672ba02470">More...</a><br /></td></tr>
<tr class="separator:af73d329f4fc10440318a1f672ba02470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479d8a031238eb16ac5ff71eb26540e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a479d8a031238eb16ac5ff71eb26540e2">get_ppath_f</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;ppath_f, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;rte_alonglos_v, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> ppath_wind)</td></tr>
<tr class="memdesc:a479d8a031238eb16ac5ff71eb26540e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the Doppler shifted frequencies along the propagation path.  <a href="rte_8h.html#a479d8a031238eb16ac5ff71eb26540e2">More...</a><br /></td></tr>
<tr class="separator:a479d8a031238eb16ac5ff71eb26540e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff69fdef1097da2fe07ccff87ed90342"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRange.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#aff69fdef1097da2fe07ccff87ed90342">get_rowindex_for_mblock</a> (const <a class="el" href="classSparse.html">Sparse</a> &amp;sensor_response, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;imblock)</td></tr>
<tr class="memdesc:aff69fdef1097da2fe07ccff87ed90342"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the "range" of <em>y</em> corresponding to a measurement block.  <a href="rte_8h.html#aff69fdef1097da2fe07ccff87ed90342">More...</a><br /></td></tr>
<tr class="separator:aff69fdef1097da2fe07ccff87ed90342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce9409c2e5b08f1bc43d28d394c7617"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#afce9409c2e5b08f1bc43d28d394c7617">get_stepwise_blackbody_radiation</a> (<a class="el" href="classVectorView.html">VectorView</a> B, <a class="el" href="classVectorView.html">VectorView</a> dB_dT, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_f_grid, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_temperature, const bool &amp;do_temperature_derivative)</td></tr>
<tr class="memdesc:afce9409c2e5b08f1bc43d28d394c7617"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the blackbody radiation at propagation path point.  <a href="rte_8h.html#afce9409c2e5b08f1bc43d28d394c7617">More...</a><br /></td></tr>
<tr class="separator:afce9409c2e5b08f1bc43d28d394c7617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abefe7d261f8442c98771b4fb6fdf2a0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#abefe7d261f8442c98771b4fb6fdf2a0c">get_stepwise_clearsky_propmat</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;K, <a class="el" href="classStokesVector.html">StokesVector</a> &amp;S, <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lte, <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;dK_dx, <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;dS_dx, const <a class="el" href="classAgenda.html">Agenda</a> &amp;propmat_clearsky_agenda, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_f_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_magnetic_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_line_of_sight, const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;ppath_nlte, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_vmrs, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_temperature, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_pressure, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jacobian_species, const bool &amp;jacobian_do)</td></tr>
<tr class="memdesc:abefe7d261f8442c98771b4fb6fdf2a0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the clearsky propgation matrix and NLTE contributions.  <a href="rte_8h.html#abefe7d261f8442c98771b4fb6fdf2a0c">More...</a><br /></td></tr>
<tr class="separator:abefe7d261f8442c98771b4fb6fdf2a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e77464e3855c1ce387c0faaeee1a574"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a1e77464e3855c1ce387c0faaeee1a574">get_stepwise_effective_source</a> (<a class="el" href="classMatrixView.html">MatrixView</a> J, <a class="el" href="classTensor3View.html">Tensor3View</a> dJ_dx, const <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;K, const <a class="el" href="classStokesVector.html">StokesVector</a> &amp;a, const <a class="el" href="classStokesVector.html">StokesVector</a> &amp;S, const <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;dK_dx, const <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;da_dx, const <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;dS_dx, <a class="el" href="classConstVectorView.html">ConstVectorView</a> B, <a class="el" href="classConstVectorView.html">ConstVectorView</a> dB_dT, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const bool &amp;jacobian_do)</td></tr>
<tr class="memdesc:a1e77464e3855c1ce387c0faaeee1a574"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the effective source at propagation path point.  <a href="rte_8h.html#a1e77464e3855c1ce387c0faaeee1a574">More...</a><br /></td></tr>
<tr class="separator:a1e77464e3855c1ce387c0faaeee1a574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6216bdff6aa1d80d6ca90d37e5bcd20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#ab6216bdff6aa1d80d6ca90d37e5bcd20">get_stepwise_frequency_grid</a> (<a class="el" href="classVectorView.html">VectorView</a> ppath_f_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_wind, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_line_of_sight, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;rte_alonglos_v, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim)</td></tr>
<tr class="memdesc:ab6216bdff6aa1d80d6ca90d37e5bcd20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inverse of get_stepwise_f_partials.  <a href="rte_8h.html#ab6216bdff6aa1d80d6ca90d37e5bcd20">More...</a><br /></td></tr>
<tr class="separator:ab6216bdff6aa1d80d6ca90d37e5bcd20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b062cea0c5d940657c5f249142937f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#aa4b062cea0c5d940657c5f249142937f">get_stepwise_f_partials</a> (<a class="el" href="classVector.html">Vector</a> &amp;f_partials, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;component, <a class="el" href="classConstVectorView.html">ConstVectorView</a> &amp;ppath_line_of_sight, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim)</td></tr>
<tr class="memdesc:aa4b062cea0c5d940657c5f249142937f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ratio that a partial derivative with regards to frequency relates to the wind of come component.  <a href="rte_8h.html#aa4b062cea0c5d940657c5f249142937f">More...</a><br /></td></tr>
<tr class="separator:aa4b062cea0c5d940657c5f249142937f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6a5e62576072d4d2756b016b90dbbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#afe6a5e62576072d4d2756b016b90dbbf">get_stepwise_scattersky_propmat</a> (<a class="el" href="classStokesVector.html">StokesVector</a> &amp;ap, <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;Kp, <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;dap_dx, <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;dKp_dx, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> ppath_1p_pnd, const <a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;ppath_dpnd_dx, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> ppath_1p_id, const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;scat_data, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_line_of_sight, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_temperature, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const bool &amp;jacobian_do)</td></tr>
<tr class="memdesc:afe6a5e62576072d4d2756b016b90dbbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the contribution by scattering at propagation path point.  <a href="rte_8h.html#afe6a5e62576072d4d2756b016b90dbbf">More...</a><br /></td></tr>
<tr class="separator:afe6a5e62576072d4d2756b016b90dbbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b6f40391482735c54ee78f98f5bbb0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a25b6f40391482735c54ee78f98f5bbb0">get_stepwise_scattersky_source</a> (<a class="el" href="classStokesVector.html">StokesVector</a> &amp;Sp, <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;dSp_dx, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, <a class="el" href="classConstVectorView.html">ConstVectorView</a> ppath_1p_pnd, const <a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;ppath_dpnd_dx, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> ppath_1p_id, const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;scat_data, <a class="el" href="classConstTensor7View.html">ConstTensor7View</a> cloudbox_field, <a class="el" href="classConstVectorView.html">ConstVectorView</a> za_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> aa_grid, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> ppath_line_of_sight, const <a class="el" href="structGridPos.html">GridPos</a> &amp;ppath_pressure, const <a class="el" href="classVector.html">Vector</a> &amp;temperature, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const bool &amp;jacobian_do, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;t_interp_order=1)</td></tr>
<tr class="memdesc:a25b6f40391482735c54ee78f98f5bbb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the stepwise scattering source terms.  <a href="rte_8h.html#a25b6f40391482735c54ee78f98f5bbb0">More...</a><br /></td></tr>
<tr class="separator:a25b6f40391482735c54ee78f98f5bbb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb44b6a9b379d514ad97eb7a734bb4ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#acb44b6a9b379d514ad97eb7a734bb4ee">get_stepwise_transmission_matrix</a> (<a class="el" href="classTensor3View.html">Tensor3View</a> <a class="el" href="transmissionmatrix_8h.html#a57eca45abd82de6b67e4b9d7f12ebffa">cumulative_transmission</a>, <a class="el" href="classTensor3View.html">Tensor3View</a> T, <a class="el" href="classTensor4View.html">Tensor4View</a> dT_dx_close, <a class="el" href="classTensor4View.html">Tensor4View</a> dT_dx_far, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> cumulative_transmission_close, const <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;K_close, const <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;K_far, const <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;dK_close_dx, const <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;dK_far_dx, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ppath_distance, const bool &amp;first_level, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;dr_dT_close=0, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;dr_dT_far=0, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;it=-1)</td></tr>
<tr class="memdesc:acb44b6a9b379d514ad97eb7a734bb4ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes layer transmission matrix and cumulative transmission.  <a href="rte_8h.html#acb44b6a9b379d514ad97eb7a734bb4ee">More...</a><br /></td></tr>
<tr class="separator:acb44b6a9b379d514ad97eb7a734bb4ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab990f38193123ec2fae58e9c7f94b248"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#ab990f38193123ec2fae58e9c7f94b248">iyb_calc</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classVector.html">Vector</a> &amp;iyb, <a class="el" href="array_8h.html#abd238db55339e04459dc977232efcab2">ArrayOfVector</a> &amp;iyb_aux, <a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;diyb_dx, <a class="el" href="classMatrix.html">Matrix</a> &amp;geo_pos_matrix, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;imblock, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;nlte_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;stokes_dim, <a class="el" href="classConstVectorView.html">ConstVectorView</a> f_grid, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> sensor_pos, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> sensor_los, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> transmitter_pos, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> mblock_dlos_grid, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_main_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;geo_pos_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;j_analytical_do, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="array_8h.html#a1341df8a0de42e2564bdc1ccba192e6f">ArrayOfArrayOfIndex</a> &amp;jacobian_indices, const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;iy_aux_vars, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity)</td></tr>
<tr class="memdesc:ab990f38193123ec2fae58e9c7f94b248"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs calculations for one measurement block, on iy-level.  <a href="rte_8h.html#ab990f38193123ec2fae58e9c7f94b248">More...</a><br /></td></tr>
<tr class="separator:ab990f38193123ec2fae58e9c7f94b248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a616f245fdff0cbbcaf1e2ad1f3ac02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a5a616f245fdff0cbbcaf1e2ad1f3ac02">iy_transmission_mult</a> (<a class="el" href="classTensor3.html">Tensor3</a> &amp;iy_trans_total, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> iy_trans_old, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> iy_trans_new)</td></tr>
<tr class="memdesc:a5a616f245fdff0cbbcaf1e2ad1f3ac02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplicates iy_transmission with transmissions.  <a href="rte_8h.html#a5a616f245fdff0cbbcaf1e2ad1f3ac02">More...</a><br /></td></tr>
<tr class="separator:a5a616f245fdff0cbbcaf1e2ad1f3ac02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9803b5ae182a5e932242ce9ed78ad1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#ad9803b5ae182a5e932242ce9ed78ad1a">iy_transmission_mult</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;iy_new, <a class="el" href="classConstTensor3View.html">ConstTensor3View</a> iy_trans, <a class="el" href="classConstMatrixView.html">ConstMatrixView</a> iy_old)</td></tr>
<tr class="memdesc:ad9803b5ae182a5e932242ce9ed78ad1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplicates iy_transmission with iy-variable.  <a href="rte_8h.html#ad9803b5ae182a5e932242ce9ed78ad1a">More...</a><br /></td></tr>
<tr class="separator:ad9803b5ae182a5e932242ce9ed78ad1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a555f53cb5c474955d53ed6d3affddb9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a555f53cb5c474955d53ed6d3affddb9d">mirror_los</a> (<a class="el" href="classVector.html">Vector</a> &amp;los_mirrored, <a class="el" href="classConstVectorView.html">ConstVectorView</a> los, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim)</td></tr>
<tr class="memdesc:a555f53cb5c474955d53ed6d3affddb9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the backward direction for a given line-of-sight.  <a href="rte_8h.html#a555f53cb5c474955d53ed6d3affddb9d">More...</a><br /></td></tr>
<tr class="separator:a555f53cb5c474955d53ed6d3affddb9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73cf17ff8f66057952e7c7dcc23fe5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#aa73cf17ff8f66057952e7c7dcc23fe5b">pos2true_latlon</a> (<a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;lat, <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;lon, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lat_grid, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lat_true, <a class="el" href="classConstVectorView.html">ConstVectorView</a> lon_true, <a class="el" href="classConstVectorView.html">ConstVectorView</a> pos)</td></tr>
<tr class="memdesc:aa73cf17ff8f66057952e7c7dcc23fe5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the true alt and lon for an "ARTS position".  <a href="rte_8h.html#aa73cf17ff8f66057952e7c7dcc23fe5b">More...</a><br /></td></tr>
<tr class="separator:aa73cf17ff8f66057952e7c7dcc23fe5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c2cbcf93ed654a8962b4e7978b63ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#af4c2cbcf93ed654a8962b4e7978b63ff">rtmethods_jacobian_init</a> (<a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jac_species_i, <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jac_scat_i, <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jac_is_t, <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jac_wind_i, <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jac_mag_i, <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;jac_other, <a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;diy_dx, <a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;diy_dpath, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;<a class="el" href="legacy__continua_8cc.html#ab269c6a72273579c35715ec77b41b634">ns</a>, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;nf, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;np, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;nq, const <a class="el" href="abs__species__tags_8h.html#a9acace966aca851b6275436e0c984317">ArrayOfArrayOfSpeciesTag</a> &amp;abs_species, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;scat_species, const <a class="el" href="array_8h.html#ac48f73312253e57be4cef9d0f6213b20">ArrayOfTensor4</a> &amp;dpnd_field_dx, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;iy_agenda_call1, const bool is_active=false)</td></tr>
<tr class="memdesc:af4c2cbcf93ed654a8962b4e7978b63ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fixes the initial steps around Jacobian calculations, to be done inside radiative transfer WSMs.  <a href="rte_8h.html#af4c2cbcf93ed654a8962b4e7978b63ff">More...</a><br /></td></tr>
<tr class="separator:af4c2cbcf93ed654a8962b4e7978b63ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8632e52c968c67b5966d52c8a802e0f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a8632e52c968c67b5966d52c8a802e0f2">rtmethods_jacobian_finalisation</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;diy_dx, <a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;diy_dpath, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;<a class="el" href="legacy__continua_8cc.html#ab269c6a72273579c35715ec77b41b634">ns</a>, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;nf, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;np, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, const <a class="el" href="classVector.html">Vector</a> &amp;ppvar_p, const <a class="el" href="classVector.html">Vector</a> &amp;ppvar_t, const <a class="el" href="classMatrix.html">Matrix</a> &amp;ppvar_vmr, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;iy_agenda_call1, const <a class="el" href="classTensor3.html">Tensor3</a> &amp;iy_transmission, const <a class="el" href="classAgenda.html">Agenda</a> &amp;water_p_eq_agenda, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> jac_species_i, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> jac_is_t)</td></tr>
<tr class="memdesc:a8632e52c968c67b5966d52c8a802e0f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fixes the last steps to made on the Jacobian in some radiative transfer WSMs.  <a href="rte_8h.html#a8632e52c968c67b5966d52c8a802e0f2">More...</a><br /></td></tr>
<tr class="separator:a8632e52c968c67b5966d52c8a802e0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa176a090bd2ebce5ce17a2bc2cb02a2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#aa176a090bd2ebce5ce17a2bc2cb02a2d">rtmethods_unit_conversion</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;iy, <a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;diy_dx, <a class="el" href="classTensor3.html">Tensor3</a> &amp;ppvar_iy, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;<a class="el" href="legacy__continua_8cc.html#ab269c6a72273579c35715ec77b41b634">ns</a>, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;np, const <a class="el" href="classVector.html">Vector</a> &amp;f_grid, const <a class="el" href="structPpath.html">Ppath</a> &amp;ppath, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;j_analytical_do, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit)</td></tr>
<tr class="memdesc:aa176a090bd2ebce5ce17a2bc2cb02a2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function handles the unit conversion to be done at the end of some radiative transfer WSMs.  <a href="rte_8h.html#aa176a090bd2ebce5ce17a2bc2cb02a2d">More...</a><br /></td></tr>
<tr class="separator:aa176a090bd2ebce5ce17a2bc2cb02a2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a56fd416d009f7fb8713c69654043a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a3a56fd416d009f7fb8713c69654043a6">yCalc_mblock_loop_body</a> (bool &amp;failed, <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;fail_msg, <a class="el" href="array_8h.html#af3bf202f3dc8d9ac77050666489125e8">ArrayOfArrayOfVector</a> &amp;iyb_aux_array, <a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classVector.html">Vector</a> &amp;y, <a class="el" href="classVector.html">Vector</a> &amp;y_f, <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;y_pol, <a class="el" href="classMatrix.html">Matrix</a> &amp;y_pos, <a class="el" href="classMatrix.html">Matrix</a> &amp;y_los, <a class="el" href="classMatrix.html">Matrix</a> &amp;y_geo, <a class="el" href="classMatrix.html">Matrix</a> &amp;jacobian, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;nlte_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;stokes_dim, const <a class="el" href="classVector.html">Vector</a> &amp;f_grid, const <a class="el" href="classMatrix.html">Matrix</a> &amp;sensor_pos, const <a class="el" href="classMatrix.html">Matrix</a> &amp;sensor_los, const <a class="el" href="classMatrix.html">Matrix</a> &amp;transmitter_pos, const <a class="el" href="classMatrix.html">Matrix</a> &amp;mblock_dlos_grid, const <a class="el" href="classSparse.html">Sparse</a> &amp;sensor_response, const <a class="el" href="classVector.html">Vector</a> &amp;sensor_response_f, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;sensor_response_pol, const <a class="el" href="classMatrix.html">Matrix</a> &amp;sensor_response_dlos, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;iy_unit, const <a class="el" href="classAgenda.html">Agenda</a> &amp;iy_main_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;geo_pos_agenda, const <a class="el" href="classAgenda.html">Agenda</a> &amp;jacobian_agenda, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;jacobian_do, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="array_8h.html#a1341df8a0de42e2564bdc1ccba192e6f">ArrayOfArrayOfIndex</a> &amp;jacobian_indices, const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;iy_aux_vars, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;verbosity, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;mblock_index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;n1y, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;j_analytical_do)</td></tr>
<tr class="memdesc:a3a56fd416d009f7fb8713c69654043a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs calculations for one measurement block, on y-level.  <a href="rte_8h.html#a3a56fd416d009f7fb8713c69654043a6">More...</a><br /></td></tr>
<tr class="separator:a3a56fd416d009f7fb8713c69654043a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15dd450928d2d680799563ee90585c83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rte_8h.html#a15dd450928d2d680799563ee90585c83">ze_cfac</a> (<a class="el" href="classVector.html">Vector</a> &amp;<a class="el" href="rational_8h.html#a9d17423dcac5ef9a46461190a4b3ba67">fac</a>, const <a class="el" href="classVector.html">Vector</a> &amp;f_grid, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;ze_tref, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;k2)</td></tr>
<tr class="memdesc:a15dd450928d2d680799563ee90585c83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates factor to convert back-scattering to Ze.  <a href="rte_8h.html#a15dd450928d2d680799563ee90585c83">More...</a><br /></td></tr>
<tr class="separator:a15dd450928d2d680799563ee90585c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declaration of functions in <a class="el" href="rte_8cc.html" title="Functions to solve radiative transfer tasks.">rte.cc</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson <a href="#" onclick="location.href='mai'+'lto:'+'Pat'+'ri'+'ck.'+'Er'+'iks'+'so'+'n@c'+'ha'+'lme'+'rs'+'.se'; return false;">Patri<span style="display: none;">.nosp@m.</span>ck.E<span style="display: none;">.nosp@m.</span>rikss<span style="display: none;">.nosp@m.</span>on@c<span style="display: none;">.nosp@m.</span>halme<span style="display: none;">.nosp@m.</span>rs.s<span style="display: none;">.nosp@m.</span>e</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-05-29 </dd></dl>

<p class="definition">Definition in file <a class="el" href="rte_8h_source.html">rte.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a869331bf4ae5a03ae1b5f3c684e18610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a869331bf4ae5a03ae1b5f3c684e18610">&#9670;&nbsp;</a></span>adapt_stepwise_partial_derivatives()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adapt_stepwise_partial_derivatives </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>dK_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dS_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_line_of_sight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_vmrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_species</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_wind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adapts clearsky partial derivatives. </p>
<p>The following fields:</p>
<p>Wind VMR</p>
<p>Adaptation means changing unit by user input</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dK_dx</td><td>Propagation matrix derivatives at propagation path point, adapted for wind and VMR units </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dS_dx</td><td>NLTE source adjustment derivatives at propagation path point, adapted for wind and VMR units </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_quantities</td><td>as WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_f_grid</td><td>Wind-adjusted frequency grid at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_line_of_sight</td><td>Line of sight at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_vmrs</td><td>Volume mixing ratio of atmospheric species at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_temperature</td><td>Temperature of atmosphere at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_pressure</td><td>Pressure of atmosphere at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_species</td><td>Index list showing where and how the Jacobian needs to compute VMRs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_wind</td><td>Index list showing where and how the Jacobian needs to compute Wind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lte</td><td>Boolean index for whether or not the atmosphere is in LTE at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_do</td><td>As WSV</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00059">59</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="jacobian_8cc_source.html#l01029">dxdvmrscf()</a>, <a class="el" href="rte_8cc_source.html#l01541">get_stepwise_f_partials()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="rte_8cc.html#aecb0595df4387ead0ca6df2b6d650212">PROPMAT_SUBSUBTAG</a>, and <a class="el" href="jacobian_8cc_source.html#l01001">vmrunitscf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__rte_8cc_source.html#l00563">iyEmissionStandard()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="a575171c69ce06a82458db816fe6817d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a575171c69ce06a82458db816fe6817d1">&#9670;&nbsp;</a></span>adjust_los()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjust_los </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ensures that the zenith and azimuth angles of a line-of-sight vector are inside defined ranges. </p>
<p>This function should not be used blindly, just when you know that the out-of-bounds values are obtained by an OK operation. As when making a disturbance calculation where e.g. the zenith angle is shifted with a small value. This function then handles the case when the original zenith angle is 0 or 180 and the disturbance then moves the angle outside the defined range.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">los</td><td>LOS vector, defined as e.g. rte_los. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-04-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00140">140</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="legacy__continua_8cc_source.html#l20626">abs</a>, <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="ppath_8cc_source.html#l00312">cart2zaaa()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22180">dx</a>, and <a class="el" href="ppath_8cc_source.html#l00347">zaaa2cart()</a>.</p>

<p class="reference">Referenced by <a class="el" href="rte_8cc_source.html#l00372">defocusing_general_sub()</a>, <a class="el" href="rte_8cc_source.html#l00613">defocusing_sat2sat()</a>, <a class="el" href="rte_8cc_source.html#l01935">iyb_calc_body()</a>, <a class="el" href="ppath_8cc_source.html#l04095">raytrace_3d_linear_basic()</a>, and <a class="el" href="m__surface_8cc_source.html#l01581">surfaceSemiSpecularBy3beams()</a>.</p>

</div>
</div>
<a id="a82342977d9b6ca7b99a1fb8dd2fd546b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82342977d9b6ca7b99a1fb8dd2fd546b">&#9670;&nbsp;</a></span>apply_iy_unit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_iy_unit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>i_pol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs conversion from radiance to other units, as well as applies refractive index to fulfill the n2-law of radiance. </p>
<p>Use <em>apply_iy_unit2</em> for conversion of jacobian data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iy</td><td><a class="el" href="classTensor3.html" title="The Tensor3 class.">Tensor3</a> with data to be converted, where column dimension corresponds to Stokes dimensionality and row dimension corresponds to frequency. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_unit</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Refractive index at the observation position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_pol</td><td>Polarisation indexes. See documentation of y_pol.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2010-04-07 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00163">163</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="physics__funcs_8cc_source.html#l00165">invplanck()</a>, <a class="el" href="physics__funcs_8cc_source.html#l00192">invrayjean()</a>, <a class="el" href="autoarts_8h_source.html#l03690">ARTS::Var::iy()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="array_8h_source.html#l00195">Array&lt; base &gt;::nelem()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, and <a class="el" href="rte_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="rte_8cc_source.html#l02553">rtmethods_unit_conversion()</a>.</p>

</div>
</div>
<a id="ac29412101765cdcad820a88ba3fc374b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac29412101765cdcad820a88ba3fc374b">&#9670;&nbsp;</a></span>apply_iy_unit2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_iy_unit2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a>&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>i_pol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Largely as <em>apply_iy_unit</em> but operates on jacobian data. </p>
<p>The associated spectrum data <em>iy</em> must be in radiance. That is, the spectrum can only be converted to Tb after the jacobian data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">J</td><td><a class="el" href="classTensor3.html" title="The Tensor3 class.">Tensor3</a> with data to be converted, where column dimension corresponds to Stokes dimensionality and row dimension corresponds to frequency. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy</td><td>Associated radiance data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_unit</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Refractive index at the observation position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_pol</td><td>Polarisation indexes. See documentation of y_pol.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2010-04-10 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00238">238</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="physics__funcs_8cc_source.html#l00098">dinvplanckdI()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="physics__funcs_8cc_source.html#l00192">invrayjean()</a>, <a class="el" href="autoarts_8h_source.html#l03690">ARTS::Var::iy()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="matpackIII_8h_source.html#l00150">ConstTensor3View::ncols()</a>, <a class="el" href="array_8h_source.html#l00195">Array&lt; base &gt;::nelem()</a>, <a class="el" href="matpackIII_8h_source.html#l00144">ConstTensor3View::npages()</a>, <a class="el" href="matpackIII_8h_source.html#l00147">ConstTensor3View::nrows()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, and <a class="el" href="rte_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="rte_8cc_source.html#l02553">rtmethods_unit_conversion()</a>.</p>

</div>
</div>
<a id="abaa4b90d0ae5df2c53c4aede88bc9dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa4b90d0ae5df2c53c4aede88bc9dde">&#9670;&nbsp;</a></span>bending_angle1d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bending_angle1d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the bending angle for a 1D atmosphere. </p>
<p>The expression used assumes a 1D atmosphere, that allows the bending angle to be calculated by start and end LOS. This is an approximation for 2D and 3D, but a very small one and the function should in general be OK also for 2D and 3D.</p>
<p>The expression is taken from Kursinski et al., The GPS radio occultation technique, TAO, 2000.</p>
<p>FIXMEDOC@Patrick, if this function only returns a numeric, have it defined as "Numeric bending_angle1d(ppath)" since this is better code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>Propagation path.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>alpha Bending angle</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-04-05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00327">327</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="rte_8cc_source.html#l00613">defocusing_sat2sat()</a>.</p>

</div>
</div>
<a id="a34d779c23e0baa2b84a12e89b46ac3d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34d779c23e0baa2b84a12e89b46ac3d0">&#9670;&nbsp;</a></span>defocusing_general()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void defocusing_general </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>dlf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lat_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lon_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>z_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>refellipsoid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>z_surface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lraytrace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>dza</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defocusing for arbitrary geometry (zenith angle part only) </p>
<p>Estimates the defocusing loss factor by calculating two paths with zenith angle off-sets. The distance between the two path at the optical path length between the transmitter and the receiver, divided with the corresponding distance for free space propagation, gives the defocusing loss.</p>
<p>The azimuth (gain) factor is not calculated. The path calculations are here done starting from the transmitter, which is the reversed direction compared to the ordinary path calculations starting at the receiver.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>The workspace. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dlf</td><td>Defocusing loss factor (1 for no loss) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_step_agenda</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_field</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">refellipsoid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_surface</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_lmax</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_lraytrace</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dza</td><td>Size of angular shift to apply. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>As the WSV with the same name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-04-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00494">494</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="rte_8cc_source.html#l00372">defocusing_general_sub()</a>, <a class="el" href="constants_8cc.html#ac705b70c1bdd2b02d631e9d9e8bbaed4">DEG2RAD</a>, <a class="el" href="geodetic_8cc_source.html#l00182">distance2D()</a>, <a class="el" href="geodetic_8cc_source.html#l00618">distance3D()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="autoarts_8h_source.html#l03962">ARTS::Var::lat_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04039">ARTS::Var::lo()</a>, <a class="el" href="autoarts_8h_source.html#l04090">ARTS::Var::lon_grid()</a>, <a class="el" href="legacy__continua_8cc_source.html#l20629">max</a>, <a class="el" href="rte_8cc_source.html#l02290">mirror_los()</a>, <a class="el" href="autoarts_8h_source.html#l04763">ARTS::Var::p_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="autoarts_8h_source.html#l05183">ARTS::Var::ppath_lmax()</a>, <a class="el" href="autoarts_8h_source.html#l05195">ARTS::Var::ppath_lraytrace()</a>, <a class="el" href="autoarts_8h_source.html#l05220">ARTS::Var::ppath_step_agenda()</a>, <a class="el" href="geodetic_8cc_source.html#l01135">refell2r()</a>, <a class="el" href="autoarts_8h_source.html#l05519">ARTS::Var::refellipsoid()</a>, <a class="el" href="autoarts_8h_source.html#l05651">ARTS::Var::rte_los()</a>, <a class="el" href="autoarts_8h_source.html#l05672">ARTS::Var::rte_pos()</a>, <a class="el" href="autoarts_8h_source.html#l07112">ARTS::Var::verbosity()</a>, <a class="el" href="autoarts_8h_source.html#l07690">ARTS::Var::z_field()</a>, and <a class="el" href="autoarts_8h_source.html#l07754">ARTS::Var::z_surface()</a>.</p>

</div>
</div>
<a id="a3569110b3bd722854e8c74f66d682401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3569110b3bd722854e8c74f66d682401">&#9670;&nbsp;</a></span>defocusing_sat2sat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void defocusing_sat2sat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>dlf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_step_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lat_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lon_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>z_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>refellipsoid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>z_surface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_lraytrace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>dza</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates defocusing for limb measurements between two satellites. </p>
<p>The expressions used assume a 1D atmosphere, and can only be applied on limb sounding geometry. The function works for 2D and 3D and should give OK estimates. Both the zenith angle (loss) and azimuth angle (gain) terms are considered.</p>
<p>The expressions is taken from Kursinski et al., The GPS radio occultation technique, TAO, 2000.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>The workspace. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dlf</td><td>Defocusing loss factor (1 for no loss) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_step_agenda</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_field</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">refellipsoid</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_surface</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_lmax</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_lraytrace</td><td>As the WSV with the same name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dza</td><td>Size of angular shift to apply. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>As the WSV with the same name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-04-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00613">613</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="complex_8h_source.html#l00056">a1</a>, <a class="el" href="complex_8h_source.html#l00058">a2</a>, <a class="el" href="rte_8cc_source.html#l00140">adjust_los()</a>, <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="rte_8cc_source.html#l00327">bending_angle1d()</a>, <a class="el" href="ppath_8h_source.html#l00054">Ppath::constant</a>, <a class="el" href="constants_8cc.html#ac705b70c1bdd2b02d631e9d9e8bbaed4">DEG2RAD</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="ppath_8cc_source.html#l00525">find_tanpoint()</a>, <a class="el" href="autoarts_8h_source.html#l03962">ARTS::Var::lat_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04090">ARTS::Var::lon_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04763">ARTS::Var::p_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="ppath_8cc_source.html#l05206">ppath_calc()</a>, <a class="el" href="autoarts_8h_source.html#l05183">ARTS::Var::ppath_lmax()</a>, <a class="el" href="autoarts_8h_source.html#l05195">ARTS::Var::ppath_lraytrace()</a>, <a class="el" href="autoarts_8h_source.html#l05220">ARTS::Var::ppath_step_agenda()</a>, <a class="el" href="ppath_8cc_source.html#l01494">ppath_what_background()</a>, <a class="el" href="autoarts_8h_source.html#l05519">ARTS::Var::refellipsoid()</a>, <a class="el" href="autoarts_8h_source.html#l05651">ARTS::Var::rte_los()</a>, <a class="el" href="autoarts_8h_source.html#l05672">ARTS::Var::rte_pos()</a>, <a class="el" href="autoarts_8h_source.html#l07112">ARTS::Var::verbosity()</a>, <a class="el" href="autoarts_8h_source.html#l07690">ARTS::Var::z_field()</a>, and <a class="el" href="autoarts_8h_source.html#l07754">ARTS::Var::z_surface()</a>.</p>

</div>
</div>
<a id="a503628846269c3508d94586ef5737db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503628846269c3508d94586ef5737db0">&#9670;&nbsp;</a></span>dotprod_with_los()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> dotprod_with_los </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the dot product between a field and a LOS. </p>
<p>The line-of-sight shall be given as in the ppath structure (i.e. the viewing direction), but the dot product is calculated for the photon direction. The field is specified by its three components.</p>
<p>The returned value can be written as |f|*cos(theta), where |f| is the field strength, and theta the angle between the field and photon vectors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">los</td><td>Pppath line-of-sight. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>U-component of field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>V-component of field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>W-component of field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The result of the dot product</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-12-12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00730">730</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="constants_8cc.html#ac705b70c1bdd2b02d631e9d9e8bbaed4">DEG2RAD</a>, <a class="el" href="rte_8cc_source.html#l02290">mirror_los()</a>, <a class="el" href="rational_8h_source.html#l00620">sqrt()</a>, and <a class="el" href="linefunctions_8cc_source.html#l00042">w()</a>.</p>

<p class="reference">Referenced by <a class="el" href="rte_8cc_source.html#l01257">get_ppath_f()</a>, <a class="el" href="rte_8cc_source.html#l01541">get_stepwise_f_partials()</a>, <a class="el" href="rte_8cc_source.html#l01521">get_stepwise_frequency_grid()</a>, and <a class="el" href="m__abs_8cc_source.html#l01074">propmat_clearskyAddFaraday()</a>.</p>

</div>
</div>
<a id="a49a47395262affef65d6b53b6dc91c1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49a47395262affef65d6b53b6dc91c1a">&#9670;&nbsp;</a></span>ext2trans()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ext2trans </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>trans_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>icase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>ext_mat_av</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>l_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an extinction matrix to a transmission matrix. </p>
<p>The function performs the calculations differently depending on the conditions, to improve the speed. There are three cases: <br  />
</p><ol type="1">
<li>Scalar RT and/or the matrix ext_mat_av is diagonal. <br  />
</li>
<li>Special expression for "azimuthally_random" case. <br  />
</li>
<li>The total general case.</li>
</ol>
<p>If the structure of <em>ext_mat</em> is known, <em>icase</em> can be set to "case index" (1, 2 or 3) and some time is saved. This includes that no asserts are performed on <em>ext_mat</em>.</p>
<p>Otherwise, <em>icase</em> must be set to 0. <em>ext_mat</em> is then analysed and <em>icase</em> is set by the function and is returned.</p>
<p>trans_mat must be sized before calling the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">trans_mat</td><td>Transmission matrix of slab. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">icase</td><td>Index giving ext_mat case. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext_mat</td><td>Averaged extinction matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lstep</td><td>The length of the RTE step.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson (based on earlier version started by Claudia) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2013-05-17 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00800">800</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="lin__alg_8cc_source.html#l00963">cayley_hamilton_fitted_method_4x4_propmat_to_transmat__eigen()</a>, <a class="el" href="autoarts_8h_source.html#l03390">ARTS::Var::ext_mat()</a>, <a class="el" href="rte_8cc_source.html#l00751">ext_mat_case()</a>, <a class="el" href="logic_8cc_source.html#l00295">is_singular()</a>, <a class="el" href="lin__alg_8cc_source.html#l00391">matrix_exp()</a>, <a class="el" href="matpackI_8cc_source.html#l00432">ConstMatrixView::ncols()</a>, <a class="el" href="matpackI_8cc_source.html#l00429">ConstMatrixView::nrows()</a>, <a class="el" href="legacy__continua_8cc_source.html#l21712">q</a>, and <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>.</p>

<p class="reference">Referenced by <a class="el" href="montecarlo_8cc_source.html#l00544">get_ppath_transmat()</a>, <a class="el" href="test__omp_8cc_source.html#l00023">main()</a>, and <a class="el" href="montecarlo_8cc_source.html#l01054">mcPathTraceRadar()</a>.</p>

</div>
</div>
<a id="adf12808edf084d4810751d718f19c501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf12808edf084d4810751d718f19c501">&#9670;&nbsp;</a></span>get_iy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_iy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>nlte_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>rte_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>rte_los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>rte_pos2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_main_agenda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic call of <em>iy_main_agenda</em>. </p>
<p>This function is an interface to <em>iy_main_agenda</em> that can be used when only <em>iy</em> is of interest. That is, jacobian and auxilary parts are deactivated/ignored.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>The workspace </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iy</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cloudbox_on</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlte_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rte_pos</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rte_los</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_unit</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_main_agenda</td><td>As the WSV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-08-08 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00877">877</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02782">ARTS::Var::cloudbox_on()</a>, <a class="el" href="autoarts_8h_source.html#l03007">ARTS::Var::diy_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="autoarts_8h_source.html#l03690">ARTS::Var::iy()</a>, <a class="el" href="autoarts_8h_source.html#l03704">ARTS::Var::iy_agenda_call1()</a>, <a class="el" href="autoarts_8h_source.html#l03719">ARTS::Var::iy_aux()</a>, <a class="el" href="autoarts_8h_source.html#l03735">ARTS::Var::iy_aux_vars()</a>, <a class="el" href="autoarts_8h_source.html#l03775">ARTS::Var::iy_id()</a>, <a class="el" href="autoarts_8h_source.html#l03794">ARTS::Var::iy_main_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l24221">iy_main_agendaExecute()</a>, <a class="el" href="autoarts_8h_source.html#l03836">ARTS::Var::iy_transmission()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l04604">ARTS::Var::nlte_field()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="autoarts_8h_source.html#l05651">ARTS::Var::rte_los()</a>, <a class="el" href="autoarts_8h_source.html#l05672">ARTS::Var::rte_pos()</a>, and <a class="el" href="autoarts_8h_source.html#l05696">ARTS::Var::rte_pos2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__doit_8cc_source.html#l02912">DoitGetIncoming()</a>, and <a class="el" href="m__doit_8cc_source.html#l03208">DoitGetIncoming1DAtm()</a>.</p>

</div>
</div>
<a id="ac35001fc0e0fd1aed10e3289b6a9b1ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac35001fc0e0fd1aed10e3289b6a9b1ac">&#9670;&nbsp;</a></span>get_iy_of_background()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_iy_of_background </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>diy_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>iy_transmission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>rte_pos2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>nlte_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>stokes_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>surface_props_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_main_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_space_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_surface_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_cloudbox_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_agenda_call1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines iy of the "background" of a propgation path. </p>
<p>The task is to determine <em>iy</em> and related variables for the background, or to continue the raditiave calculations "backwards". The details here depends on the method selected for the agendas.</p>
<p>Each background is handled by an agenda. Several of these agandes can involve recursive calls of <em>iy_main_agenda</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td>The workspace </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iy</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diy_dx</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_transmission</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_do</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cloudbox_on</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stokes_dim</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_unit</td><td>As the WSV. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">surface_props_data</td><td>As the WSV. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_main_agenda</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_space_agenda</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_surface_agenda</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_cloudbox_agenda</td><td>As the WSV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009-10-08 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l00916">916</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="check__input_8cc_source.html#l00694">chk_not_empty()</a>, <a class="el" href="autoarts_8h_source.html#l02782">ARTS::Var::cloudbox_on()</a>, <a class="el" href="messages_8h_source.html#l00207">CREATE_OUT3</a>, <a class="el" href="autoarts_8h_source.html#l03007">ARTS::Var::diy_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03333">ARTS::Var::dsurface_emission_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03344">ARTS::Var::dsurface_names()</a>, <a class="el" href="autoarts_8h_source.html#l03356">ARTS::Var::dsurface_rmatrix_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="autoarts_8h_source.html#l03690">ARTS::Var::iy()</a>, <a class="el" href="autoarts_8h_source.html#l03704">ARTS::Var::iy_agenda_call1()</a>, <a class="el" href="autoarts_8h_source.html#l03742">ARTS::Var::iy_cloudbox_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l23996">iy_cloudbox_agendaExecute()</a>, <a class="el" href="autoarts_8h_source.html#l03775">ARTS::Var::iy_id()</a>, <a class="el" href="autoarts_8h_source.html#l03794">ARTS::Var::iy_main_agenda()</a>, <a class="el" href="autoarts_8h_source.html#l03801">ARTS::Var::iy_space_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l24299">iy_space_agendaExecute()</a>, <a class="el" href="autoarts_8h_source.html#l03808">ARTS::Var::iy_surface_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l24341">iy_surface_agendaExecute()</a>, <a class="el" href="autoarts_8h_source.html#l03836">ARTS::Var::iy_transmission()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="autoarts_8h_source.html#l04604">ARTS::Var::nlte_field()</a>, <a class="el" href="autoarts_8h_source.html#l01300">ARTS::Var::Ppath::pos()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="ppath_8cc_source.html#l01494">ppath_what_background()</a>, <a class="el" href="autoarts_8h_source.html#l05696">ARTS::Var::rte_pos2()</a>, <a class="el" href="autoarts_8h_source.html#l05715">ARTS::Var::rtp_los()</a>, <a class="el" href="autoarts_8h_source.html#l05774">ARTS::Var::rtp_pos()</a>, <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>, <a class="el" href="rte_8cc.html#a852fef45f2301dc351c222341e35b608">SURFACE_MAINTAG</a>, and <a class="el" href="autoarts_8h_source.html#l06745">ARTS::Var::surface_props_data()</a>.</p>

<p class="reference">Referenced by <a class="el" href="propmat__field_8cc_source.html#l00122">emission_from_propmat_field()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, and <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>.</p>

</div>
</div>
<a id="a285e9c0738d22752782b878655ba2e4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a285e9c0738d22752782b878655ba2e4f">&#9670;&nbsp;</a></span>get_ppath_atmvars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_ppath_atmvars </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_nlte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_vmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_wind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_mag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>nlte_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor4View.html">ConstTensor4View</a>&#160;</td>
          <td class="paramname"><em>vmr_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>wind_u_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>wind_v_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>wind_w_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>mag_u_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>mag_v_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>mag_w_field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines pressure, temperature, VMR, winds and magnetic field for each propgataion path point. </p>
<p>The output variables are sized inside the function. For VMR the dimensions are [ species, propagation path point ].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_p</td><td>Pressure for each ppath point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_t</td><td>Temperature for each ppath point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_vmr</td><td>VMR values for each ppath point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_wind</td><td>Wind vector for each ppath point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_mag</td><td>Mag. field vector for each ppath point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vmr_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wind_u_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wind_v_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wind_w_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mag_u_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mag_v_field</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mag_w_field</td><td>As the WSV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009-10-05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01034">1034</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="special__interp_8cc_source.html#l00101">interp_atmfield_by_itw()</a>, <a class="el" href="special__interp_8cc_source.html#l00075">interp_atmfield_gp2itw()</a>, <a class="el" href="interpolation_8cc_source.html#l00741">interpweights()</a>, <a class="el" href="special__interp_8cc_source.html#l00718">itw2p()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="autoarts_8h_source.html#l04130">ARTS::Var::mag_u_field()</a>, <a class="el" href="autoarts_8h_source.html#l04164">ARTS::Var::mag_v_field()</a>, <a class="el" href="autoarts_8h_source.html#l04197">ARTS::Var::mag_w_field()</a>, <a class="el" href="autoarts_8h_source.html#l04604">ARTS::Var::nlte_field()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, <a class="el" href="autoarts_8h_source.html#l04763">ARTS::Var::p_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="matpackI_8cc_source.html#l00404">Vector::resize()</a>, <a class="el" href="matpackI_8cc_source.html#l01056">Matrix::resize()</a>, <a class="el" href="autoarts_8h_source.html#l06947">ARTS::Var::t_field()</a>, <a class="el" href="autoarts_8h_source.html#l07130">ARTS::Var::vmr_field()</a>, <a class="el" href="autoarts_8h_source.html#l07211">ARTS::Var::wind_u_field()</a>, <a class="el" href="autoarts_8h_source.html#l07246">ARTS::Var::wind_v_field()</a>, and <a class="el" href="autoarts_8h_source.html#l07279">ARTS::Var::wind_w_field()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__rte_8cc_source.html#l00563">iyEmissionStandard()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="af73d329f4fc10440318a1f672ba02470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73d329f4fc10440318a1f672ba02470">&#9670;&nbsp;</a></span>get_ppath_cloudvars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_ppath_cloudvars </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>clear2cloudy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_pnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_dpnd_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor4.html">Tensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#ac48f73312253e57be4cef9d0f6213b20">ArrayOfTensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>dpnd_field_dx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the particle fields along a propagation path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">clear2cloudy</td><td>Mapping of index. See code for details. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_pnd</td><td>The particle number density for each path point (also outside cloudbox). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_dpnd_dx</td><td>dpnd_field_dx for each path point (also outside cloudbox). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>As the WSV. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cloubox_limits</td><td>As the WSV. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pnd_field</td><td>As the WSV. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dpnd_field_dx</td><td>As the WSV. <br  />
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok, Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-18 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01153">1153</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="autoarts_8h_source.html#l02762">ARTS::Var::cloudbox_limits()</a>, <a class="el" href="autoarts_8h_source.html#l03251">ARTS::Var::dpnd_field_dx()</a>, <a class="el" href="interpolation_8cc_source.html#l00473">gridpos_copy()</a>, <a class="el" href="special__interp_8cc_source.html#l00101">interp_atmfield_by_itw()</a>, <a class="el" href="special__interp_8cc_source.html#l00165">interp_cloudfield_gp2itw()</a>, <a class="el" href="cloudbox_8cc_source.html#l00499">is_gp_inside_cloudbox()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="legacy__continua_8cc_source.html#l20629">max</a>, <a class="el" href="legacy__continua_8cc_source.html#l20628">min</a>, <a class="el" href="autoarts_8h_source.html#l05081">ARTS::Var::pnd_field()</a>, <a class="el" href="rational_8h_source.html#l00628">pow()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, and <a class="el" href="matpackI_8cc_source.html#l01056">Matrix::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="a479d8a031238eb16ac5ff71eb26540e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479d8a031238eb16ac5ff71eb26540e2">&#9670;&nbsp;</a></span>get_ppath_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_ppath_f </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>rte_alonglos_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>ppath_wind</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the Doppler shifted frequencies along the propagation path. </p>
<p>ppath_doppler[ nf,np]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ppath_f</td><td>Doppler shifted f_grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath</td><td>Propagation path. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>Original f_grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rte_alonglos_v</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_wind</td><td>See get_ppath_atmvars.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2013-02-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01257">1257</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="rte_8cc_source.html#l00730">dotprod_with_los()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="matpackI_8cc_source.html#l01056">Matrix::resize()</a>, <a class="el" href="autoarts_8h_source.html#l05628">ARTS::Var::rte_alonglos_v()</a>, and <a class="el" href="rte_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__rte_8cc_source.html#l00563">iyEmissionStandard()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="aff69fdef1097da2fe07ccff87ed90342"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff69fdef1097da2fe07ccff87ed90342">&#9670;&nbsp;</a></span>get_rowindex_for_mblock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRange.html">Range</a> get_rowindex_for_mblock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSparse.html">Sparse</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>imblock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the "range" of <em>y</em> corresponding to a measurement block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sensor_response</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mblock_index</td><td>Index of the measurement block.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The range.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009-10-16 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01301">1301</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l04258">ARTS::Var::mblock_index()</a>, and <a class="el" href="autoarts_8h_source.html#l06300">ARTS::Var::sensor_response()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00329">jacobianCalcFreqShift()</a>, <a class="el" href="m__jacobian_8cc_source.html#l00479">jacobianCalcFreqStretch()</a>, <a class="el" href="m__jacobian_8cc_source.html#l00677">jacobianCalcPointingZaInterp()</a>, <a class="el" href="m__jacobian_8cc_source.html#l00808">jacobianCalcPointingZaRecalc()</a>, <a class="el" href="m__jacobian_8cc_source.html#l01012">jacobianCalcPolyfit()</a>, <a class="el" href="m__rte_8cc_source.html#l01749">yCalc()</a>, and <a class="el" href="rte_8cc_source.html#l02595">yCalc_mblock_loop_body()</a>.</p>

</div>
</div>
<a id="afce9409c2e5b08f1bc43d28d394c7617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce9409c2e5b08f1bc43d28d394c7617">&#9670;&nbsp;</a></span>get_stepwise_blackbody_radiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_blackbody_radiation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>dB_dT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>do_temperature_derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the blackbody radiation at propagation path point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>Blackbody radiation at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dB_dT</td><td>Blackbody radiation temperature derivative at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_f_grid</td><td>Wind-adjusted frequency grid at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_temperature</td><td>Temperature of atmosphere at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_temperature_derivative</td><td>Fill dB_dT?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01307">1307</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="physics__funcs_8cc_source.html#l00337">dplanck_dt()</a>, <a class="el" href="matpackI_8cc_source.html#l00051">ConstVectorView::nelem()</a>, and <a class="el" href="physics__funcs_8cc_source.html#l00269">planck()</a>.</p>

<p class="reference">Referenced by <a class="el" href="propmat__field_8cc_source.html#l00122">emission_from_propmat_field()</a>, <a class="el" href="m__rte_8cc_source.html#l00563">iyEmissionStandard()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, and <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>.</p>

</div>
</div>
<a id="abefe7d261f8442c98771b4fb6fdf2a0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abefe7d261f8442c98771b4fb6fdf2a0c">&#9670;&nbsp;</a></span>get_stepwise_clearsky_propmat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_clearsky_propmat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStokesVector.html">StokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>dK_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dS_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>propmat_clearsky_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_magnetic_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_line_of_sight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_nlte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_vmrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_species</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the clearsky propgation matrix and NLTE contributions. </p>
<p>Basically a wrapper for calls to the propagation clearsky agenda</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ws</td><td>The workspace </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">K</td><td>Propagation matrix at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">S</td><td>NLTE source adjustment at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lte</td><td>Boolean index for whether or not the atmosphere is in LTE at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dK_dx</td><td>Propagation matrix derivatives at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dS_dx</td><td>NLTE source adjustment derivatives at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">propmat_clearsky_agenda</td><td>As WSA </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_quantities</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_f_grid</td><td>Wind-adjusted frequency grid at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_mag_field</td><td>Magnetic field at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_line_of_sight</td><td>Line of sight at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_nlte</td><td>NLTE distribution at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_vmrs</td><td>Volume mixing ratio of atmospheric species at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_temperature</td><td>Temperature of atmosphere at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_pressure</td><td>Pressure of atmosphere at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_species</td><td>Index list showing where and how the Jacobian needs to compute VMRs </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_do</td><td>As WSV</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01322">1322</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l03021">ARTS::Var::dnlte_dx_source()</a>, <a class="el" href="autoarts_8h_source.html#l03269">ARTS::Var::dpropmat_clearsky_dx()</a>, <a class="el" href="jacobian_8cc_source.html#l01107">equivalent_propmattype_index()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="autoarts_8h_source.html#l04648">ARTS::Var::nlte_source()</a>, <a class="el" href="autoarts_8h_source.html#l05398">ARTS::Var::propmat_clearsky()</a>, <a class="el" href="autoarts_8h_source.html#l05405">ARTS::Var::propmat_clearsky_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l23513">propmat_clearsky_agendaExecute()</a>, <a class="el" href="rte_8cc.html#aecb0595df4387ead0ca6df2b6d650212">PROPMAT_SUBSUBTAG</a>, <a class="el" href="rte_8cc.html#a572f7b83f46ed616a2958437b5e6d4f4">SCATSPECIES_MAINTAG</a>, and <a class="el" href="propagationmatrix_8h_source.html#l00934">PropagationMatrix::SetZero()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__rte_8cc_source.html#l00563">iyEmissionStandard()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="a1e77464e3855c1ce387c0faaeee1a574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e77464e3855c1ce387c0faaeee1a574">&#9670;&nbsp;</a></span>get_stepwise_effective_source()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_effective_source </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a>&#160;</td>
          <td class="paramname"><em>dJ_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classStokesVector.html">StokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classStokesVector.html">StokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>dK_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>da_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dS_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>dB_dT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the effective source at propagation path point. </p>
<p>Computes</p>
<p>J = K^-1 (a B + S)</p>
<p>and</p>
<p>dJ = - K^-1 dK/dx K^-1 (a B + S) + K^-1 (da B + a dB + dS)</p>
<p>Assumes zeroes for the a and K if nothing is happening but checks all other variables</p>
<p>FIXME: This function should be removed</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">J</td><td>Source term for RTE at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dJ_dx</td><td>Source term derivative for RTE at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">K</td><td>Propagation matrix, clearsky+scattersky, at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td><a class="el" href="namespaceAbsorption.html" title="Namespace to contain things required for absorption calculations.">Absorption</a> vector, clearsky+scattersky, at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>NLTE source adjustment, clearsky+scattersky, at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dK_dx</td><td>Propagation matrix derivatives, clearsky+scattersky, at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">da_dx</td><td><a class="el" href="namespaceAbsorption.html" title="Namespace to contain things required for absorption calculations.">Absorption</a> vector derivatives, clearsky+scattersky, at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dS_dx</td><td>NLTE source adjustment derivatives, clearsky+scattersky, at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">B</td><td>Blackbody radiation at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dB_dT</td><td>Blackbody radiation temperature derivative at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_quantities</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_do</td><td>As WSV</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01427">1427</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="propagationmatrix_8h_source.html#l00221">PropagationMatrix::IsEmpty()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00247">PropagationMatrix::IsRotational()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="propagationmatrix_8cc_source.html#l01506">PropagationMatrix::MatrixInverseAtPosition()</a>, <a class="el" href="complex_8cc_source.html#l01579">mult()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, <a class="el" href="propagationmatrix_8h_source.html#l00204">PropagationMatrix::NumberOfFrequencies()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00201">PropagationMatrix::StokesDimensions()</a>, <a class="el" href="rte_8cc.html#a1dbb83493062e53b78fcdfc73b3205db">TEMPERATURE_MAINTAG</a>, and <a class="el" href="propagationmatrix_8h_source.html#l01266">StokesVector::VectorAtPosition()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>.</p>

</div>
</div>
<a id="aa4b062cea0c5d940657c5f249142937f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b062cea0c5d940657c5f249142937f">&#9670;&nbsp;</a></span>get_stepwise_f_partials()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_f_partials </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>f_partials</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>component</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_line_of_sight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the ratio that a partial derivative with regards to frequency relates to the wind of come component. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ppath_f_grid</td><td>Wind-adjusted frequency grid wind derivative at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">component</td><td>The wind component [0 is full, 1 is u, 2 is v, 3 is w, rest are undefined] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_line_of_sight</td><td>Line of sight at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As WSV</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01541">1541</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="rte_8cc_source.html#l00730">dotprod_with_los()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="matpackI_8cc_source.html#l00404">Vector::resize()</a>, and <a class="el" href="rte_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="rte_8cc_source.html#l00059">adapt_stepwise_partial_derivatives()</a>.</p>

</div>
</div>
<a id="ab6216bdff6aa1d80d6ca90d37e5bcd20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6216bdff6aa1d80d6ca90d37e5bcd20">&#9670;&nbsp;</a></span>get_stepwise_frequency_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_frequency_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_wind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_line_of_sight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>rte_alonglos_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inverse of get_stepwise_f_partials. </p>
<p>Computes practical frequency grid due to wind for propmat_clearsky_agenda</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ppath_f_grid</td><td>Wind-adjusted frequency grid at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_wind</td><td>Wind vector at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_line_of_sight</td><td>Line of sight at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rte_alonglos_v</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As WSV</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01521">1521</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="rte_8cc_source.html#l00730">dotprod_with_los()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05628">ARTS::Var::rte_alonglos_v()</a>, and <a class="el" href="rte_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>.</p>

</div>
</div>
<a id="afe6a5e62576072d4d2756b016b90dbbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6a5e62576072d4d2756b016b90dbbf">&#9670;&nbsp;</a></span>get_stepwise_scattersky_propmat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_scattersky_propmat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStokesVector.html">StokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>Kp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dap_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>dKp_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>ppath_1p_pnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_dpnd_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&#160;</td>
          <td class="paramname"><em>ppath_1p_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_line_of_sight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the contribution by scattering at propagation path point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ap</td><td><a class="el" href="namespaceAbsorption.html" title="Namespace to contain things required for absorption calculations.">Absorption</a> vector scattersky at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Kp</td><td>Propagation matrix scattersky at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dap_dx</td><td><a class="el" href="namespaceAbsorption.html" title="Namespace to contain things required for absorption calculations.">Absorption</a> vector scattersky derivatives at propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dKp_dx</td><td>Propagation matrix scattersky derivatives at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_quantities</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_1p_pnd</td><td>Particulate number density at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_data</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_line_of_sight</td><td>Line of sight at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_temperature</td><td>Temperature at propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As WSV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_do</td><td>As WSV</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok, Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01591">1591</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="jacobian_8h_source.html#l00405">FOR_ANALYTICAL_JACOBIANS_DO</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="rte_8cc_source.html#l02290">mirror_los()</a>, <a class="el" href="matpackIV_8cc_source.html#l00057">ConstTensor4View::nbooks()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00204">PropagationMatrix::NumberOfFrequencies()</a>, <a class="el" href="optproperties_8cc_source.html#l00102">opt_prop_Bulk()</a>, <a class="el" href="optproperties_8cc_source.html#l00248">opt_prop_NScatElems()</a>, <a class="el" href="optproperties_8cc_source.html#l00148">opt_prop_ScatSpecBulk()</a>, <a class="el" href="autoarts_8h_source.html#l05840">ARTS::Var::scat_data()</a>, <a class="el" href="autoarts_8h_source.html#l05862">ARTS::Var::scat_data_mono()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00392">PropagationMatrix::SetAtPosition()</a>, <a class="el" href="propagationmatrix_8h_source.html#l01285">StokesVector::SetAtPosition()</a>, <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>, and <a class="el" href="propagationmatrix_8h_source.html#l00201">PropagationMatrix::StokesDimensions()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="a25b6f40391482735c54ee78f98f5bbb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b6f40391482735c54ee78f98f5bbb0">&#9670;&nbsp;</a></span>get_stepwise_scattersky_source()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_scattersky_source </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStokesVector.html">StokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="propagationmatrix_8h.html#a73f70f451b0dcdab09c33e9326a9b6ec">ArrayOfStokesVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dSp_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>ppath_1p_pnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_dpnd_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&#160;</td>
          <td class="paramname"><em>ppath_1p_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor7View.html">ConstTensor7View</a>&#160;</td>
          <td class="paramname"><em>cloudbox_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>za_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>aa_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>ppath_line_of_sight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structGridPos.html">GridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>t_interp_order</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the stepwise scattering source terms. </p>
<p>Uses new, unified phase matrix extraction scheme.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Sp</td><td>Out: The scattering source term </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dSp_dx</td><td>Out: The derivative of the scattering source term ...</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok \adapted from non-stepwise function </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2018-03-29 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01708">1708</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l01717">ARTS::Var::aa_grid()</a>, <a class="el" href="math__funcs_8cc_source.html#l00296">AngIntegrate_trapezoid()</a>, <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="autoarts_8h_source.html#l02676">ARTS::Var::cloudbox_field()</a>, <a class="el" href="jacobian_8h_source.html#l00405">FOR_ANALYTICAL_JACOBIANS_DO</a>, <a class="el" href="interpolation_8cc_source.html#l00473">gridpos_copy()</a>, <a class="el" href="interpolation_8cc_source.html#l00970">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l00741">interpweights()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="matpackI_8cc_source.html#l00051">ConstVectorView::nelem()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00204">PropagationMatrix::NumberOfFrequencies()</a>, <a class="el" href="optproperties_8cc_source.html#l00881">pha_mat_1ScatElem()</a>, <a class="el" href="autoarts_8h_source.html#l05840">ARTS::Var::scat_data()</a>, <a class="el" href="propagationmatrix_8h_source.html#l01285">StokesVector::SetAtPosition()</a>, <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00201">PropagationMatrix::StokesDimensions()</a>, <a class="el" href="array_8h_source.html#l00343">TotalNumberOfElements()</a>, and <a class="el" href="autoarts_8h_source.html#l07771">ARTS::Var::za_grid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, and <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>.</p>

</div>
</div>
<a id="acb44b6a9b379d514ad97eb7a734bb4ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb44b6a9b379d514ad97eb7a734bb4ee">&#9670;&nbsp;</a></span>get_stepwise_transmission_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_stepwise_transmission_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a>&#160;</td>
          <td class="paramname"><em>cumulative_transmission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a>&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor4View.html">Tensor4View</a>&#160;</td>
          <td class="paramname"><em>dT_dx_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor4View.html">Tensor4View</a>&#160;</td>
          <td class="paramname"><em>dT_dx_far</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>cumulative_transmission_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>K_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPropagationMatrix.html">PropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>K_far</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>dK_close_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="propagationmatrix_8h.html#aae38a705b6331dfc88d51daaaf4a1d4f">ArrayOfPropagationMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>dK_far_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath_distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>first_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>dr_dT_close</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>dr_dT_far</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>it</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes layer transmission matrix and cumulative transmission. </p>
<p>FIXME: This function should be removed</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cumulative_transmission</td><td>Present accumulation of transmission for Jacobian computations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">T</td><td>Layer transmission </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dT_close_dx</td><td>Layer transmission derivative due to the close propagation path point </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dT_far_dx</td><td>Layer transmission derivative due to the far propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cumulative_transmission_close</td><td>Past accumulation of transmission for Jacobian computations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">K_close</td><td>Level propagation matrix due to the close propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">K_far</td><td>Level propagation matrix due to the far propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dK_close_dx</td><td>Level propagation matrix derivatives due to the close propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dK_far_dx</td><td>Level propagation matrix derivatives due to the far propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppath_distance</td><td>Thickness of the layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">first_level</td><td>Boolean for if this is the first level, i.e., there is no cumulative_transmission_close </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dr_dT_close</td><td>Thickness of the layer derivative due to temperature of the close propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dr_dT_far</td><td>Thickness of the layer derivative due to temperature of the far propagation path point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">it</td><td>Index to temperature derivatives</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Richard Larsson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-09-21 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l01879">1879</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="propagationmatrix_8cc_source.html#l00033">compute_transmission_matrix()</a>, <a class="el" href="propagationmatrix_8cc_source.html#l00478">compute_transmission_matrix_and_derivative()</a>, <a class="el" href="transmissionmatrix_8cc_source.html#l01527">cumulative_transmission()</a>, <a class="el" href="lin__alg_8cc_source.html#l02240">id_mat()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="complex_8cc_source.html#l01579">mult()</a>, <a class="el" href="matpackIII_8h_source.html#l00150">ConstTensor3View::ncols()</a>, <a class="el" href="array_8h_source.html#l00195">Array&lt; base &gt;::nelem()</a>, <a class="el" href="propagationmatrix_8h_source.html#l00204">PropagationMatrix::NumberOfFrequencies()</a>, and <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>.</p>

</div>
</div>
<a id="ad9803b5ae182a5e932242ce9ed78ad1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9803b5ae182a5e932242ce9ed78ad1a">&#9670;&nbsp;</a></span>iy_transmission_mult() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iy_transmission_mult </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>iy_trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>iy_old</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiplicates iy_transmission with iy-variable. </p>
<p>The operation can be written as:</p>
<p>iy_new = T * iy_old</p>
<p>where T is the transmission corresponding to <em>iy_transmission</em> and iy_old is a variable matching iy.</p>
<p>iy_new* is sized by the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">iy_new</td><td>Updated version of iy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_trans</td><td>A variable matching <em>iy_transmission</em>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_old</td><td>A variable matching <em>iy</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2018-04-10 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02273">2273</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="complex_8cc_source.html#l01579">mult()</a>, <a class="el" href="matpackI_8cc_source.html#l00432">ConstMatrixView::ncols()</a>, <a class="el" href="matpackIII_8h_source.html#l00150">ConstTensor3View::ncols()</a>, <a class="el" href="matpackIII_8h_source.html#l00144">ConstTensor3View::npages()</a>, <a class="el" href="matpackI_8cc_source.html#l00429">ConstMatrixView::nrows()</a>, <a class="el" href="matpackIII_8h_source.html#l00147">ConstTensor3View::nrows()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, and <a class="el" href="matpackI_8cc_source.html#l01056">Matrix::resize()</a>.</p>

</div>
</div>
<a id="a5a616f245fdff0cbbcaf1e2ad1f3ac02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a616f245fdff0cbbcaf1e2ad1f3ac02">&#9670;&nbsp;</a></span>iy_transmission_mult() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iy_transmission_mult </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_trans_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>iy_trans_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstTensor3View.html">ConstTensor3View</a>&#160;</td>
          <td class="paramname"><em>iy_trans_new</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiplicates iy_transmission with transmissions. </p>
<p>That is, a multiplication of <em>iy_transmission</em> with another variable having same structure and holding transmission values.</p>
<p>The "new path" is assumed to be further away from the sensor than the propagtion path already included in iy_transmission. That is, the operation can be written as:</p>
<p>Ttotal = Told * Tnew</p>
<p>where Told is the transmission corresponding to <em>iy_transmission</em> and Tnew corresponds to <em>tau</em>.</p>
<p>iy_trans_new* is sized by the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">iy_trans_total</td><td>Updated version of <em>iy_transmission</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_trans_old</td><td>A variable matching <em>iy_transmission</em>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iy_trans_new</td><td>A variable matching <em>iy_transmission</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009-10-06 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02253">2253</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="complex_8cc_source.html#l01579">mult()</a>, <a class="el" href="matpackIII_8h_source.html#l00150">ConstTensor3View::ncols()</a>, <a class="el" href="matpackIII_8h_source.html#l00144">ConstTensor3View::npages()</a>, <a class="el" href="matpackIII_8h_source.html#l00147">ConstTensor3View::nrows()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, and <a class="el" href="matpackIII_8cc_source.html#l00664">Tensor3::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, <a class="el" href="m__surface_8cc_source.html#l00407">iySurfaceRtpropAgenda()</a>, and <a class="el" href="m__surface_8cc_source.html#l00536">iySurfaceRtpropCalc()</a>.</p>

</div>
</div>
<a id="ab990f38193123ec2fae58e9c7f94b248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab990f38193123ec2fae58e9c7f94b248">&#9670;&nbsp;</a></span>iyb_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iyb_calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>iyb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#abd238db55339e04459dc977232efcab2">ArrayOfVector</a> &amp;&#160;</td>
          <td class="paramname"><em>iyb_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a4bbdfc095689c41c0f78c6397202e75e">ArrayOfMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>diyb_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>geo_pos_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>imblock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>nlte_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>stokes_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>sensor_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>sensor_los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>transmitter_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstMatrixView.html">ConstMatrixView</a>&#160;</td>
          <td class="paramname"><em>mblock_dlos_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_main_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>geo_pos_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>j_analytical_do</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a1341df8a0de42e2564bdc1ccba192e6f">ArrayOfArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_aux_vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs calculations for one measurement block, on iy-level. </p>
<p>FIXMEDOC@Patrick This function lacks all documentation</p>
<p>The parameters mainly matches WSVs. </p>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02051">2051</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="arts__omp_8cc_source.html#l00046">arts_omp_get_max_threads()</a>, <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="autoarts_8h_source.html#l02782">ARTS::Var::cloudbox_on()</a>, <a class="el" href="messages_8h_source.html#l00207">CREATE_OUT3</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="jacobian_8h_source.html#l00412">FOR_ANALYTICAL_JACOBIANS_DO2</a>, <a class="el" href="autoarts_8h_source.html#l03544">ARTS::Var::geo_pos()</a>, <a class="el" href="autoarts_8h_source.html#l03551">ARTS::Var::geo_pos_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l23915">geo_pos_agendaExecute()</a>, <a class="el" href="autoarts_8h_source.html#l03735">ARTS::Var::iy_aux_vars()</a>, <a class="el" href="autoarts_8h_source.html#l03794">ARTS::Var::iy_main_agenda()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="autoarts_8h_source.html#l03873">ARTS::Var::iyb()</a>, <a class="el" href="rte_8cc_source.html#l01935">iyb_calc_body()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="autoarts_8h_source.html#l04247">ARTS::Var::mblock_dlos_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04258">ARTS::Var::mblock_index()</a>, <a class="el" href="array_8h_source.html#l00195">Array&lt; base &gt;::nelem()</a>, <a class="el" href="autoarts_8h_source.html#l04604">ARTS::Var::nlte_field()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="matpackI_8cc_source.html#l01056">Matrix::resize()</a>, <a class="el" href="autoarts_8h_source.html#l06201">ARTS::Var::sensor_los()</a>, <a class="el" href="autoarts_8h_source.html#l06279">ARTS::Var::sensor_pos()</a>, <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>, and <a class="el" href="autoarts_8h_source.html#l07093">ARTS::Var::transmitter_pos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00808">jacobianCalcPointingZaRecalc()</a>, and <a class="el" href="rte_8cc_source.html#l02595">yCalc_mblock_loop_body()</a>.</p>

</div>
</div>
<a id="a555f53cb5c474955d53ed6d3affddb9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a555f53cb5c474955d53ed6d3affddb9d">&#9670;&nbsp;</a></span>mirror_los()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mirror_los </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>los_mirrored</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the backward direction for a given line-of-sight. </p>
<p>This function can be used to get the LOS to apply for extracting single scattering properties, if the propagation path LOS is given.</p>
<p>A viewing direction of aa=0 is assumed for 1D. This corresponds to positive za for 2D.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">los_mirrored</td><td>The line-of-sight for reversed direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">los</td><td>A line-of-sight </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2011-07-15 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02290">2290</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, and <a class="el" href="matpackI_8cc_source.html#l00404">Vector::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="montecarlo_8cc_source.html#l00326">cloudy_rt_vars_at_gp()</a>, <a class="el" href="rte_8cc_source.html#l00494">defocusing_general()</a>, <a class="el" href="rte_8cc_source.html#l00730">dotprod_with_los()</a>, <a class="el" href="rte_8cc_source.html#l01591">get_stepwise_scattersky_propmat()</a>, <a class="el" href="m__montecarlo_8cc_source.html#l00548">MCRadar()</a>, <a class="el" href="m__abs_8cc_source.html#l01202">propmat_clearskyAddParticles()</a>, <a class="el" href="m__zeeman_8cc_source.html#l00035">propmat_clearskyAddZeeman()</a>, and <a class="el" href="montecarlo_8cc_source.html#l01391">Sample_los()</a>.</p>

</div>
</div>
<a id="aa73cf17ff8f66057952e7c7dcc23fe5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73cf17ff8f66057952e7c7dcc23fe5b">&#9670;&nbsp;</a></span>pos2true_latlon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pos2true_latlon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lat_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lat_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>lon_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classConstVectorView.html">ConstVectorView</a>&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the true alt and lon for an "ARTS position". </p>
<p>The function disentangles if the geographical position shall be taken from lat_grid and lon_grid, or lat_true and lon_true.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">lat</td><td>True latitude. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lon</td><td>True longitude. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat_true</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon_true</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>A position, as defined for rt calculations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2011-07-15 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02314">2314</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="interpolation_8cc_source.html#l00156">gridpos()</a>, <a class="el" href="interpolation_8cc_source.html#l00970">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l00741">interpweights()</a>, <a class="el" href="autoarts_8h_source.html#l03933">ARTS::Var::lat()</a>, <a class="el" href="autoarts_8h_source.html#l03962">ARTS::Var::lat_grid()</a>, <a class="el" href="autoarts_8h_source.html#l03985">ARTS::Var::lat_true()</a>, <a class="el" href="autoarts_8h_source.html#l04064">ARTS::Var::lon()</a>, <a class="el" href="autoarts_8h_source.html#l04113">ARTS::Var::lon_true()</a>, and <a class="el" href="matpackI_8cc_source.html#l00051">ConstVectorView::nelem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__surface_8cc_source.html#l00140">InterpGriddedField2ToPosition()</a>, <a class="el" href="m__surface_8cc_source.html#l01837">surface_complex_refr_indexFromGriddedField5()</a>, <a class="el" href="m__surface_8cc_source.html#l01931">surface_reflectivityFromGriddedField6()</a>, <a class="el" href="m__surface_8cc_source.html#l02070">surface_scalar_reflectivityFromGriddedField4()</a>, <a class="el" href="m__surface_8cc_source.html#l02225">surface_typeInterpTypeMask()</a>, <a class="el" href="m__surface_8cc_source.html#l00989">surfaceTelsem()</a>, and <a class="el" href="m__telsem_8cc_source.html#l00084">telsemSurfaceTypeLandSea()</a>.</p>

</div>
</div>
<a id="a8632e52c968c67b5966d52c8a802e0f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8632e52c968c67b5966d52c8a802e0f2">&#9670;&nbsp;</a></span>rtmethods_jacobian_finalisation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtmethods_jacobian_finalisation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>diy_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>diy_dpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>nf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>ppvar_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>ppvar_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>ppvar_vmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_agenda_call1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_transmission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>water_p_eq_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a>&#160;</td>
          <td class="paramname"><em>jac_species_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a>&#160;</td>
          <td class="paramname"><em>jac_is_t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fixes the last steps to made on the Jacobian in some radiative transfer WSMs. </p>
<p>The method applies iy_transmission, maps from ppath to the retrieval grids and applies non-standard Jacobian units.</p>
<p>See iyEmissonStandard for usage example.</p>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-11-19 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02416">2416</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="autoarts_8h_source.html#l03007">ARTS::Var::diy_dx()</a>, <a class="el" href="jacobian_8cc_source.html#l00337">diy_from_path_to_rgrids()</a>, <a class="el" href="jacobian_8h_source.html#l00405">FOR_ANALYTICAL_JACOBIANS_DO</a>, <a class="el" href="autoarts_8h_source.html#l03704">ARTS::Var::iy_agenda_call1()</a>, <a class="el" href="autoarts_8h_source.html#l03836">ARTS::Var::iy_transmission()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="complex_8cc_source.html#l01579">mult()</a>, <a class="el" href="matpackIII_8h_source.html#l00144">ConstTensor3View::npages()</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, <a class="el" href="physics__funcs_8cc_source.html#l00219">number_density()</a>, <a class="el" href="rational_8h_source.html#l00628">pow()</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, <a class="el" href="autoarts_8h_source.html#l05304">ARTS::Var::ppvar_p()</a>, <a class="el" href="autoarts_8h_source.html#l05330">ARTS::Var::ppvar_t()</a>, <a class="el" href="autoarts_8h_source.html#l05372">ARTS::Var::ppvar_vmr()</a>, <a class="el" href="matpackI_8cc_source.html#l01056">Matrix::resize()</a>, <a class="el" href="complex_8cc_source.html#l01509">transpose()</a>, <a class="el" href="autoarts_8h_source.html#l07165">ARTS::Var::water_p_eq_agenda()</a>, and <a class="el" href="auto__md_8cc_source.html#l25260">water_p_eq_agendaExecute()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="af4c2cbcf93ed654a8962b4e7978b63ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4c2cbcf93ed654a8962b4e7978b63ff">&#9670;&nbsp;</a></span>rtmethods_jacobian_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtmethods_jacobian_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_species_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_scat_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_is_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_wind_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_mag_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>diy_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>diy_dpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>nf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="abs__species__tags_8h.html#a9acace966aca851b6275436e0c984317">ArrayOfArrayOfSpeciesTag</a> &amp;&#160;</td>
          <td class="paramname"><em>abs_species</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_species</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#ac48f73312253e57be4cef9d0f6213b20">ArrayOfTensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>dpnd_field_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_agenda_call1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_active</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fixes the initial steps around Jacobian calculations, to be done inside radiative transfer WSMs. </p>
<p>See iyEmissonStandard for usage example.</p>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-11-20 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02348">2348</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02157">ARTS::Var::abs_species()</a>, <a class="el" href="autoarts_8h_source.html#l02782">ARTS::Var::cloudbox_on()</a>, <a class="el" href="autoarts_8h_source.html#l03007">ARTS::Var::diy_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03251">ARTS::Var::dpnd_field_dx()</a>, <a class="el" href="jacobian_8h_source.html#l00405">FOR_ANALYTICAL_JACOBIANS_DO</a>, <a class="el" href="jacobian_8h_source.html#l00412">FOR_ANALYTICAL_JACOBIANS_DO2</a>, <a class="el" href="jacobian_8cc_source.html#l00596">get_pointers_for_analytical_jacobians()</a>, <a class="el" href="autoarts_8h_source.html#l03704">ARTS::Var::iy_agenda_call1()</a>, <a class="el" href="jacobian_8cc_source.html#l00058">jac_ranges_indices()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="jacobian_8h.html#ae291f1803efc715646afefed1f4a8af0a6adf97f83acf6453d4a6a4b1070f3754">None</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, <a class="el" href="autoarts_8h_source.html#l06086">ARTS::Var::scat_species()</a>, and <a class="el" href="jacobian_8h.html#acf759e9b0c52ebf2d337b773bc0b8bc6aca5ea8fec77a196cd5fd3e1a7e956ff1">VMR</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__cloudradar_8cc_source.html#l00049">iyActiveSingleScat()</a>, <a class="el" href="m__cloudradar_8cc_source.html#l00680">iyActiveSingleScat2()</a>, <a class="el" href="m__rte_8cc_source.html#l00563">iyEmissionStandard()</a>, <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>, and <a class="el" href="m__transmitter_8cc_source.html#l00655">iyTransmissionStandard()</a>.</p>

</div>
</div>
<a id="aa176a090bd2ebce5ce17a2bc2cb02a2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa176a090bd2ebce5ce17a2bc2cb02a2d">&#9670;&nbsp;</a></span>rtmethods_unit_conversion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtmethods_unit_conversion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#acd5bc6b3e65b1cf49969c13c346ded99">ArrayOfTensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>diy_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>ppvar_iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structPpath.html">Ppath</a> &amp;&#160;</td>
          <td class="paramname"><em>ppath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>j_analytical_do</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function handles the unit conversion to be done at the end of some radiative transfer WSMs. </p>
<p>The method hanldes both <em>iy</em> and analytical parts of the Jacobian.</p>
<p>See iyEmissonStandard for usage example.</p>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-11-19 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02553">2553</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="rte_8cc_source.html#l00163">apply_iy_unit()</a>, <a class="el" href="rte_8cc_source.html#l00238">apply_iy_unit2()</a>, <a class="el" href="autoarts_8h_source.html#l03007">ARTS::Var::diy_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="jacobian_8h_source.html#l00412">FOR_ANALYTICAL_JACOBIANS_DO2</a>, <a class="el" href="autoarts_8h_source.html#l03690">ARTS::Var::iy()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="legacy__continua_8cc_source.html#l22183">ns</a>, <a class="el" href="autoarts_8h_source.html#l05139">ARTS::Var::ppath()</a>, and <a class="el" href="autoarts_8h_source.html#l05246">ARTS::Var::ppvar_iy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__rte_8cc_source.html#l00172">iyEmissionStandardSequential()</a>, <a class="el" href="m__fos_8cc_source.html#l00855">iyHybrid()</a>, and <a class="el" href="m__fos_8cc_source.html#l01416">iyHybrid2()</a>.</p>

</div>
</div>
<a id="a3a56fd416d009f7fb8713c69654043a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a56fd416d009f7fb8713c69654043a6">&#9670;&nbsp;</a></span>yCalc_mblock_loop_body()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yCalc_mblock_loop_body </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>failed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>fail_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#af3bf202f3dc8d9ac77050666489125e8">ArrayOfArrayOfVector</a> &amp;&#160;</td>
          <td class="paramname"><em>iyb_aux_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>y_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>y_pol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>y_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>y_los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>y_geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEnergyLevelMap.html">EnergyLevelMap</a> &amp;&#160;</td>
          <td class="paramname"><em>nlte_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>stokes_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_los</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>transmitter_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mblock_dlos_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSparse.html">Sparse</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_response_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_response_pol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>sensor_response_dlos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_main_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>geo_pos_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAgenda.html">Agenda</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_agenda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a1341df8a0de42e2564bdc1ccba192e6f">ArrayOfArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;&#160;</td>
          <td class="paramname"><em>iy_aux_vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>mblock_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>n1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>j_analytical_do</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs calculations for one measurement block, on y-level. </p>
<p>The parameters mainly matches WSVs. </p>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02595">2595</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="autoarts_8h_source.html#l02782">ARTS::Var::cloudbox_on()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="jacobian_8h_source.html#l00412">FOR_ANALYTICAL_JACOBIANS_DO2</a>, <a class="el" href="autoarts_8h_source.html#l03551">ARTS::Var::geo_pos_agenda()</a>, <a class="el" href="rte_8cc_source.html#l01301">get_rowindex_for_mblock()</a>, <a class="el" href="matpackI_8h_source.html#l00327">Range::get_start()</a>, <a class="el" href="autoarts_8h_source.html#l03735">ARTS::Var::iy_aux_vars()</a>, <a class="el" href="autoarts_8h_source.html#l03794">ARTS::Var::iy_main_agenda()</a>, <a class="el" href="autoarts_8h_source.html#l03856">ARTS::Var::iy_unit()</a>, <a class="el" href="autoarts_8h_source.html#l03873">ARTS::Var::iyb()</a>, <a class="el" href="rte_8cc_source.html#l02051">iyb_calc()</a>, <a class="el" href="autoarts_8h_source.html#l03892">ARTS::Var::jacobian()</a>, <a class="el" href="autoarts_8h_source.html#l03899">ARTS::Var::jacobian_agenda()</a>, <a class="el" href="auto__md_8cc_source.html#l24546">jacobian_agendaExecute()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="autoarts_8h_source.html#l04247">ARTS::Var::mblock_dlos_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04258">ARTS::Var::mblock_index()</a>, <a class="el" href="complex_8cc_source.html#l01579">mult()</a>, <a class="el" href="autoarts_8h_source.html#l04604">ARTS::Var::nlte_field()</a>, <a class="el" href="autoarts_8h_source.html#l06201">ARTS::Var::sensor_los()</a>, <a class="el" href="autoarts_8h_source.html#l06279">ARTS::Var::sensor_pos()</a>, <a class="el" href="autoarts_8h_source.html#l06300">ARTS::Var::sensor_response()</a>, <a class="el" href="autoarts_8h_source.html#l06340">ARTS::Var::sensor_response_dlos()</a>, <a class="el" href="autoarts_8h_source.html#l06376">ARTS::Var::sensor_response_f()</a>, <a class="el" href="autoarts_8h_source.html#l06411">ARTS::Var::sensor_response_pol()</a>, <a class="el" href="autoarts_8h_source.html#l06650">ARTS::Var::stokes_dim()</a>, <a class="el" href="autoarts_8h_source.html#l07093">ARTS::Var::transmitter_pos()</a>, <a class="el" href="autoarts_8h_source.html#l07112">ARTS::Var::verbosity()</a>, <a class="el" href="autoarts_8h_source.html#l07401">ARTS::Var::y()</a>, <a class="el" href="autoarts_8h_source.html#l07466">ARTS::Var::y_f()</a>, <a class="el" href="autoarts_8h_source.html#l07480">ARTS::Var::y_geo()</a>, <a class="el" href="autoarts_8h_source.html#l07498">ARTS::Var::y_los()</a>, <a class="el" href="autoarts_8h_source.html#l07515">ARTS::Var::y_pol()</a>, <a class="el" href="autoarts_8h_source.html#l07531">ARTS::Var::y_pos()</a>, and <a class="el" href="autoarts_8h_source.html#l07542">ARTS::Var::yb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__rte_8cc_source.html#l01749">yCalc()</a>.</p>

</div>
</div>
<a id="a15dd450928d2d680799563ee90585c83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15dd450928d2d680799563ee90585c83">&#9670;&nbsp;</a></span>ze_cfac()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ze_cfac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>fac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>ze_tref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>k2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates factor to convert back-scattering to Ze. </p>
<p>The vector <em>fac</em> shall be sized to match f_grid, before calling the function.</p>
<p>If k2 &lt;= 0, the K" factor is calculated. Otherwise the input k2 is applied
as "hard-coded".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">fac</td><td><a class="el" href="classVector.html" title="The Vector class.">Vector</a> with factors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>As the WSV. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z_tref</td><td>Reference temperature for conversion to Ze. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>Reference dielectric factor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-05-20 </dd></dl>

<p class="definition">Definition at line <a class="el" href="rte_8cc_source.html#l02736">2736</a> of file <a class="el" href="rte_8cc_source.html">rte.cc</a>.</p>

<p class="reference">References <a class="el" href="legacy__continua_8cc_source.html#l20626">abs</a>, <a class="el" href="refraction_8cc_source.html#l00071">complex_n_water_liebe93()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="math__funcs_8cc_source.html#l00063">fac()</a>, <a class="el" href="constants_8cc.html#a9d0fb1720e9df57970c08cc4e3ee0bc0">PI</a>, and <a class="el" href="rte_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__montecarlo_8cc_source.html#l00548">MCRadar()</a>, and <a class="el" href="m__cloudradar_8cc_source.html#l01190">yActive()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="rte_8h.html">rte.h</a></li>
    <li class="footer">Generated on Thu Oct 15 2020 08:53:05 for ARTS by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
