<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: oem.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.4.0(git:4fb77825)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('oem_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">oem.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="oem_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifndef _ARTS_OEM_H_</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#define _ARTS_OEM_H_</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;invlib/algebra.h&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;invlib/algebra/precision_matrix.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;invlib/algebra/solvers.h&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;invlib/interfaces/arts_wrapper.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;invlib/map.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;invlib/optimization.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;invlib/profiling/timer.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//  Type Aliases</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="namespaceoem.html">   29</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoem.html">oem</a> {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">   32</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classVector.html">Vector</a> = invlib::Vector&lt;ArtsVector&gt;;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespaceoem.html#a6dead99de47f1704cff777837f5044e9">   34</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classMatrix.html">Matrix</a> = invlib::Matrix&lt;ArtsMatrix&gt;;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespaceoem.html#ab339bcff7f08ef7f7c51a05fe8224135">   36</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#ab339bcff7f08ef7f7c51a05fe8224135">MatrixReference</a> = invlib::Matrix&lt;ArtsMatrixReference&lt;::Matrix&gt;&gt;;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">   38</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classCovarianceMatrix.html">CovarianceMatrix</a> = invlib::Matrix&lt;ArtsCovarianceMatrixWrapper&gt;;</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespaceoem.html#a39aefe1f71e25848d95bf605dffe1a2d">   39</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a39aefe1f71e25848d95bf605dffe1a2d">Identity</a> = invlib::MatrixIdentity&lt;Matrix&gt;;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// OEM Formulations</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">using</span> invlib::Formulation;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardModel&gt;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespaceoem.html#a5511ae2b5e2f5ac4842748039ed99e8a">   57</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a5511ae2b5e2f5ac4842748039ed99e8a">OEM_STANDARD</a> = invlib::MAP&lt;ForwardModel,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                 <a class="code" href="namespaceoem.html#a6dead99de47f1704cff777837f5044e9">Matrix</a>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                 <a class="code" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">CovarianceMatrix</a>,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                 <a class="code" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">CovarianceMatrix</a>,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                 <a class="code" href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">Vector</a>,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                 Formulation::STANDARD,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                 invlib::Rodgers531&gt;;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardModel&gt;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="namespaceoem.html#aaf5723d672c14297d8cca54521fc7c98">   74</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#aaf5723d672c14297d8cca54521fc7c98">OEM_NFORM</a> = invlib::MAP&lt;ForwardModel,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                              <a class="code" href="namespaceoem.html#a6dead99de47f1704cff777837f5044e9">Matrix</a>,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                              <a class="code" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">CovarianceMatrix</a>,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                              <a class="code" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">CovarianceMatrix</a>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                              <a class="code" href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">Vector</a>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                              Formulation::NFORM&gt;;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ForwardModel&gt;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespaceoem.html#a1dedb105e8f358ca2798a1c7b609f580">   90</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a1dedb105e8f358ca2798a1c7b609f580">OEM_MFORM</a> = invlib::MAP&lt;ForwardModel,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                              <a class="code" href="namespaceoem.html#a6dead99de47f1704cff777837f5044e9">Matrix</a>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                              <a class="code" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">CovarianceMatrix</a>,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                              <a class="code" href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">CovarianceMatrix</a>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                              <a class="code" href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">Vector</a>,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                              Formulation::MFORM&gt;;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">// Solvers</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> TransformationMatrixType,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          <span class="keyword">typename</span> SolverType = invlib::Standard&gt;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classoem_1_1NormalizingSolver.html">  113</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoem_1_1NormalizingSolver.html">NormalizingSolver</a> : SolverType {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Params&gt;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classoem_1_1NormalizingSolver.html#a329b7c8b5375d7dc35f30fd8e5247cb9">  116</a></span>&#160;  <a class="code" href="classoem_1_1NormalizingSolver.html#a329b7c8b5375d7dc35f30fd8e5247cb9">NormalizingSolver</a>(<span class="keyword">const</span> TransformationMatrixType &amp;trans,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    <span class="keywordtype">bool</span> apply,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    Params... params)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      : SolverType(params...), <a class="code" href="classoem_1_1NormalizingSolver.html#a6537be2689c69a576e1594d19a5798ba">apply_</a>(apply), <a class="code" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">trans_</a>(trans) {}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> MatrixType, <span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classoem_1_1NormalizingSolver.html#a49b244ca9a698145614133feafd14a7e">  132</a></span>&#160;  <span class="keyword">auto</span> <a class="code" href="classoem_1_1NormalizingSolver.html#a49b244ca9a698145614133feafd14a7e">solve</a>(<span class="keyword">const</span> <a class="code" href="matpackI_8h.html#ad94d14aeb1d269a3069e70a6be5aa6a1">MatrixType</a> &amp;A, <span class="keyword">const</span> VectorType &amp;v) -&gt;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keyword">typename</span> VectorType::ResultType {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">typename</span> VectorType::ResultType <a class="code" href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoem_1_1NormalizingSolver.html#a6537be2689c69a576e1594d19a5798ba">apply_</a>) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">typename</span> VectorType::ResultType vv = <a class="code" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">trans_</a> * v;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keyword">auto</span> &amp;&amp;ww = <a class="code" href="covariance__matrix_8cc.html#aa8a1164863690b8ff9ab7f439da5cbda">SolverType::solve</a>(<a class="code" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">trans_</a> * A * <a class="code" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">trans_</a>, vv);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a> = <a class="code" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">trans_</a> * ww;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a> = <a class="code" href="covariance__matrix_8cc.html#aa8a1164863690b8ff9ab7f439da5cbda">SolverType::solve</a>(A, v);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      VectorType u = v - A * <a class="code" href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classoem_1_1NormalizingSolver.html#a6537be2689c69a576e1594d19a5798ba">  148</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classoem_1_1NormalizingSolver.html#a6537be2689c69a576e1594d19a5798ba">apply_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">  150</a></span>&#160;  <span class="keyword">const</span> TransformationMatrixType &amp;<a class="code" href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">trans_</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;};</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="namespaceoem.html#abc6dc7a5cb64498fe2b0cf33350282dc">  158</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classoem_1_1NormalizingSolver.html">Std</a> = <a class="code" href="classoem_1_1NormalizingSolver.html">NormalizingSolver&lt;Matrix, invlib::Standard&gt;</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="namespaceoem.html#acf3495e3a48870f7d0283a1bf0a64098">  166</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classoem_1_1NormalizingSolver.html">CG</a> = <a class="code" href="classoem_1_1NormalizingSolver.html">NormalizingSolver&lt;Matrix, invlib::ConjugateGradient&lt;&gt;</a>&gt;;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="namespaceoem.html#a9958bea7157fa0f5a72027b936d52ec1">  169</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a9958bea7157fa0f5a72027b936d52ec1">GN</a> = invlib::GaussNewton&lt;Numeric, Std&gt;;</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="namespaceoem.html#a71d313d2d45438601a48a8ad72a7f540">  171</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a71d313d2d45438601a48a8ad72a7f540">GN_CG</a> = invlib::GaussNewton&lt;Numeric, CG&gt;;</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="namespaceoem.html#a5572926b564f0e50c8c63ddc36f68bb1">  173</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a5572926b564f0e50c8c63ddc36f68bb1">LM</a> = invlib::LevenbergMarquardt&lt;Numeric, CovarianceMatrix, Std&gt;;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="namespaceoem.html#a333b9b6ecfa4a0675ce7dede06659522">  175</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespaceoem.html#a333b9b6ecfa4a0675ce7dede06659522">LM_CG</a> = invlib::LevenbergMarquardt&lt;Numeric, CovarianceMatrix, CG&gt;;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">//  Custom Log Class</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog.html">  188</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structoem_1_1OptimizerLog.html">OptimizerLog</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> RealType, <span class="keyword">typename</span> DampingMatrix, <span class="keyword">typename</span> Solver&gt;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html">  196</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structoem_1_1OptimizerLog.html">OptimizerLog</a>&lt;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    invlib::LevenbergMarquardt&lt;RealType, DampingMatrix, Solver&gt;&gt; {</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#aa64603413c848ed6f34ed52e37d2698f">  199</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">auto</span> name = <span class="stringliteral">&quot;Levenberg-Marquardt&quot;</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#a95e35c686f0450fdb292868c1b1e64db">  202</a></span>&#160;  <span class="keyword">static</span> std::string <a class="code" href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#a95e35c686f0450fdb292868c1b1e64db">header</a>() {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    std::string out = <span class="stringliteral">&quot;Gamma Factor&quot;</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#a7435095f88d862e402b155cb22609aa6">  208</a></span>&#160;  <span class="keyword">static</span> std::string <a class="code" href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#a7435095f88d862e402b155cb22609aa6">log</a>(</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">const</span> invlib::LevenbergMarquardt&lt;RealType, DampingMatrix, Solver&gt; &amp;g,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="classVector.html">Vector</a> &amp;gamma_history_,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordtype">size_t</span> i) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    std::string lambda = std::to_string(g.get_lambda());</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    std::string out(15 - std::min&lt;size_t&gt;(lambda.size(), 15), <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    out += lambda;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    gamma_history_[i] = g.get_lambda();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;};</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> RealType, <span class="keyword">typename</span> Solver&gt;</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html">  222</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structoem_1_1OptimizerLog.html">OptimizerLog</a>&lt;invlib::GaussNewton&lt;RealType, Solver&gt;&gt; {</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#af66cc89990f765ef8f13e201a0b78cce">  224</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keyword">auto</span> name = <span class="stringliteral">&quot;Gauss-Newton&quot;</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#a4613baabff0f095558990274ab9e32d0">  227</a></span>&#160;  <span class="keyword">static</span> std::string <a class="code" href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#a4613baabff0f095558990274ab9e32d0">header</a>() { <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>; }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#a9e9ae30110e80531b0bf33bb268d6e07">  229</a></span>&#160;  <span class="keyword">static</span> std::string <a class="code" href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#a9e9ae30110e80531b0bf33bb268d6e07">log</a>(<span class="keyword">const</span> invlib::GaussNewton&lt;RealType, Solver&gt; &amp;,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                         <a class="code" href="classVector.html">Vector</a> &amp;,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                         <span class="keywordtype">size_t</span>) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;};</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword">template</span> &lt;invlib::LogType type&gt;</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html">  244</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoem_1_1ArtsLog.html">ArtsLog</a> {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a7cd942bd3301f5d475408f5fa702692f">  253</a></span>&#160;  <a class="code" href="classoem_1_1ArtsLog.html#a7cd942bd3301f5d475408f5fa702692f">ArtsLog</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v, ::<a class="code" href="classVector.html">Vector</a> &amp;g, <span class="keywordtype">bool</span> l = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      : <a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a>(v), <a class="code" href="classoem_1_1ArtsLog.html#a1e72be9edf6f6e181d31782a263d7a36">gamma_history_</a>(g), <a class="code" href="classoem_1_1ArtsLog.html#a56e373040f6d0e35cd470d3be69e7f12">linear_</a>(l), <a class="code" href="classoem_1_1ArtsLog.html#a761f5a1b546e6751cc75526598ab9c2e">finalized_</a>(false) {}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#ac56a88d7bb7f9c338ac973513de1dfe5">  257</a></span>&#160;  <a class="code" href="classoem_1_1ArtsLog.html#ac56a88d7bb7f9c338ac973513de1dfe5">~ArtsLog</a>() {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a> &gt;= 1) &amp;&amp; (!<a class="code" href="classoem_1_1ArtsLog.html#a761f5a1b546e6751cc75526598ab9c2e">finalized_</a>)) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      std::cout &lt;&lt; invlib::separator() &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Error during OEM computation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      std::cout &lt;&lt; invlib::center(<span class="stringliteral">&quot;----&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Params&gt;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a1d2b3087572593d3ebacd17584154970">  273</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoem_1_1ArtsLog.html#a1d2b3087572593d3ebacd17584154970">init</a>(Params &amp;... params) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a> &gt;= 1) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      std::tuple&lt;Params &amp;...&gt; tuple(params...);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keyword">auto</span> &amp;<a class="code" href="namespaceARTS_1_1Var.html#adb488742dfe7a156414f354acd168e75">y</a> = std::get&lt;4&gt;(tuple);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <a class="code" href="classoem_1_1ArtsLog.html#a9cfd916a3a13d5f314dd22cab00b16cf">scaling_factor_</a> = 1.0 / <span class="keyword">static_cast&lt;</span><a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a><span class="keyword">&gt;</span>(<a class="code" href="namespaceARTS_1_1Var.html#adb488742dfe7a156414f354acd168e75">y</a>.nelem());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      std::cout &lt;&lt; invlib::center(<span class="stringliteral">&quot;MAP Computation&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="comment">// Print formulation.</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordtype">int</span> formulation = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::get&lt;6&gt;(tuple));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">switch</span> (formulation) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;Formulation: Standard&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;Formulation: N-Form&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;Formulation: M-Form&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// Print optimization method.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keyword">using</span> OptimizationType = <span class="keyword">typename</span> std::decay&lt;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <span class="keyword">typename</span> std::tuple_element&lt;5, decltype(tuple)&gt;::type&gt;::type;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Method:      &quot;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                &lt;&lt; invlib::OptimizerLog&lt;OptimizationType&gt;::name;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      std::cout &lt;&lt; std::setw(5) &lt;&lt; <span class="stringliteral">&quot;Step&quot;</span> &lt;&lt; std::setw(15) &lt;&lt; <span class="stringliteral">&quot;Total Cost&quot;</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      std::cout &lt;&lt; std::setw(15) &lt;&lt; <span class="stringliteral">&quot;x-Cost&quot;</span> &lt;&lt; std::setw(15) &lt;&lt; <span class="stringliteral">&quot;y-Cost&quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      std::cout &lt;&lt; std::setw(15) &lt;&lt; <span class="stringliteral">&quot;Conv. Crit.&quot;</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      std::cout &lt;&lt; std::setw(15) &lt;&lt; <a class="code" href="structoem_1_1OptimizerLog.html">OptimizerLog&lt;OptimizationType&gt;::header</a>();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      std::cout &lt;&lt; std::endl &lt;&lt; invlib::separator() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Params&gt;</div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a14066108d106f8ca519ef2b01a410ccb">  319</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoem_1_1ArtsLog.html#a14066108d106f8ca519ef2b01a410ccb">step</a>(<span class="keyword">const</span> Params &amp;... params) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a> &gt;= 1) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      std::tuple&lt;<span class="keyword">const</span> Params &amp;...&gt; tuple(params...);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">using</span> OptimizationType = <span class="keyword">typename</span> std::decay&lt;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <span class="keyword">typename</span> std::tuple_element&lt;5, decltype(tuple)&gt;::type&gt;::type;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keyword">auto</span> step_number = std::get&lt;0&gt;(tuple);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      std::cout &lt;&lt; std::setw(5) &lt;&lt; step_number;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">if</span> (step_number == 0) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="classoem_1_1ArtsLog.html#a86aca57f72a439596da0aaa86516fab3">start_cost_</a> = std::get&lt;1&gt;(tuple);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      std::cout &lt;&lt; std::setw(15) &lt;&lt; scaling_factor_ * std::get&lt;1&gt;(tuple);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      std::cout &lt;&lt; std::setw(15) &lt;&lt; scaling_factor_ * std::get&lt;2&gt;(tuple);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      std::cout &lt;&lt; std::setw(15) &lt;&lt; scaling_factor_ * std::get&lt;3&gt;(tuple);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span> (std::isnan(std::get&lt;4&gt;(tuple))) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        std::cout &lt;&lt; std::setw(15) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        std::cout &lt;&lt; std::setw(15) &lt;&lt; std::get&lt;4&gt;(tuple);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      std::cout &lt;&lt; OptimizerLog&lt;OptimizationType&gt;::log(</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          std::get&lt;5&gt;(tuple), <a class="code" href="classoem_1_1ArtsLog.html#a1e72be9edf6f6e181d31782a263d7a36">gamma_history_</a>, std::get&lt;0&gt;(tuple));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Params&gt;</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a7f911815dde4ea801960b8dd8b433bd7">  351</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoem_1_1ArtsLog.html#a7f911815dde4ea801960b8dd8b433bd7">finalize</a>(<span class="keyword">const</span> Params &amp;... params) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a> &gt;= 1) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      std::cout &lt;&lt; invlib::separator() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      std::tuple&lt;<span class="keyword">const</span> Params &amp;...&gt; tuple(params...);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Total number of steps:            &quot;</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      std::cout &lt;&lt; std::get&lt;1&gt;(tuple) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Final scaled cost function value: &quot;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      std::cout &lt;&lt; std::get&lt;2&gt;(tuple) * <a class="code" href="classoem_1_1ArtsLog.html#a9cfd916a3a13d5f314dd22cab00b16cf">scaling_factor_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordtype">bool</span> converged = std::get&lt;0&gt;(tuple);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">if</span> (converged) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;OEM computation converged.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classoem_1_1ArtsLog.html#a56e373040f6d0e35cd470d3be69e7f12">linear_</a>) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Linear OEM computation finished.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;OEM computation DID NOT converge!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="classoem_1_1ArtsLog.html#a761f5a1b546e6751cc75526598ab9c2e">finalized_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Params&gt;</div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#aa2048a67d92b7a076cc32c2622915110">  378</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoem_1_1ArtsLog.html#aa2048a67d92b7a076cc32c2622915110">time</a>(<span class="keyword">const</span> Params &amp;... params) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a> &gt;= 1) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      std::tuple&lt;<span class="keyword">const</span> Params &amp;...&gt; tuple(params...);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Elapsed Time for Retrieval:                       &quot;</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      std::cout &lt;&lt; std::get&lt;0&gt;(tuple) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Time in inversion_iterate Agenda (No Jacobian):   &quot;</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      std::cout &lt;&lt; std::get&lt;1&gt;(tuple) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Time in inversion_iterate Agenda (With Jacobian): &quot;</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      std::cout &lt;&lt; std::get&lt;2&gt;(tuple) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      std::cout &lt;&lt; invlib::center(<span class="stringliteral">&quot;----&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">  397</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">verbosity_</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a1e72be9edf6f6e181d31782a263d7a36">  399</a></span>&#160;  <a class="code" href="classVector.html">Vector</a> <a class="code" href="classoem_1_1ArtsLog.html#a1e72be9edf6f6e181d31782a263d7a36">gamma_history_</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a9cfd916a3a13d5f314dd22cab00b16cf">  401</a></span>&#160;  <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="classoem_1_1ArtsLog.html#a9cfd916a3a13d5f314dd22cab00b16cf">scaling_factor_</a> = 0.0;</div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a86aca57f72a439596da0aaa86516fab3">  403</a></span>&#160;  <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="classoem_1_1ArtsLog.html#a86aca57f72a439596da0aaa86516fab3">start_cost_</a> = 0.0;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a56e373040f6d0e35cd470d3be69e7f12">  405</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classoem_1_1ArtsLog.html#a56e373040f6d0e35cd470d3be69e7f12">linear_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classoem_1_1ArtsLog.html#a761f5a1b546e6751cc75526598ab9c2e">  407</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classoem_1_1ArtsLog.html#a761f5a1b546e6751cc75526598ab9c2e">finalized_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;};</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">//  Exception Handling</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> E&gt;</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="namespaceoem.html#aba5a4f073b66de221b22d802537b1a1f">  425</a></span>&#160;std::vector&lt;std::string&gt; <a class="code" href="namespaceoem.html#aba5a4f073b66de221b22d802537b1a1f">handle_nested_exception</a>(<span class="keyword">const</span> E &amp;e, <span class="keywordtype">int</span> level = 0) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">const</span> std::exception *re;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  std::vector&lt;std::string&gt; errors{};</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  re = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>std::exception *<span class="keyword">&gt;</span>(&amp;e);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (re) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    std::string s{};</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// If invlib level, extend error description.</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (level == 0) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      s = <span class="stringliteral">&quot;Run-time error in oem computation: &quot;</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    s += re-&gt;what();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    errors.push_back(s);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    std::rethrow_if_nested(e);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;ne) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    std::vector&lt;std::string&gt; sv(<a class="code" href="namespaceoem.html#aba5a4f073b66de221b22d802537b1a1f">handle_nested_exception</a>(ne, level + 1));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    errors.insert(errors.end(), sv.begin(), sv.end());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">return</span> errors;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">// Forward model interface</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html">  462</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#a7a0656a5588752135ebc87e6a16bcbf6">  465</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classoem_1_1AgendaWrapper.html#a7a0656a5588752135ebc87e6a16bcbf6">m</a> = 0;</div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#ae9e8e78fb6e14a0df9c2c93dd051b2f2">  467</a></span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classoem_1_1AgendaWrapper.html#ae9e8e78fb6e14a0df9c2c93dd051b2f2">n</a> = 0;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#aef9155542a67ead98532683dbde0ab39">  483</a></span>&#160;  <a class="code" href="classoem_1_1AgendaWrapper.html#aef9155542a67ead98532683dbde0ab39">AgendaWrapper</a>(<a class="code" href="classWorkspace.html">Workspace</a> *ws,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> measurement_space_dimension,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> state_space_dimension,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                ::<a class="code" href="classMatrix.html">Matrix</a> &amp;arts_jacobian,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                ::<a class="code" href="classVector.html">Vector</a> &amp;arts_y,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                <span class="keyword">const</span> <a class="code" href="classAgenda.html">Agenda</a> *<a class="code" href="namespaceARTS_1_1Var.html#af9cecac8f38afac27c0a68127879cff7">inversion_iterate_agenda</a>)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      : <a class="code" href="classoem_1_1AgendaWrapper.html#a7a0656a5588752135ebc87e6a16bcbf6">m</a>(measurement_space_dimension),</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#ae9e8e78fb6e14a0df9c2c93dd051b2f2">n</a>(state_space_dimension),</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#a29c5964a46c05ff5b91e1fedef9ef04a">inversion_iterate_agenda_</a>(<a class="code" href="namespaceARTS_1_1Var.html#af9cecac8f38afac27c0a68127879cff7">inversion_iterate_agenda</a>),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#af17a41e6381f04e5bd11243667b47465">iteration_counter_</a>(0),</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#afd36c09d1e559d1cafb48cd8687edb2f">jacobian_</a>(arts_jacobian),</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">reuse_jacobian_</a>((arts_jacobian.<a class="code" href="namespaceARTS_1_1Var.html#a01d28833ca2da397e5bf34c75b8358d0">nrows</a>() != 0) &amp;&amp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        (arts_jacobian.<a class="code" href="namespaceARTS_1_1Var.html#ae7a4e0ef46cae9d1f309d4bf9267c41c">ncols</a>() != 0) &amp;&amp; (arts_y.<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>() != 0)),</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#abb778eb5e0bad36db20cd8e9274ebb8c">ws_</a>(ws),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>(arts_y) {}</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#acbad221f606cbcf9a5492b7d220873a1">  503</a></span>&#160;  ArtsVector <a class="code" href="classoem_1_1AgendaWrapper.html#acbad221f606cbcf9a5492b7d220873a1">get_measurement_vector</a>() { <span class="keywordflow">return</span> <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>; }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#aa885d71bfefb020bf9b964ec95f6957a">  505</a></span>&#160;  <a class="code" href="classoem_1_1AgendaWrapper.html#aa885d71bfefb020bf9b964ec95f6957a">AgendaWrapper</a>(<span class="keyword">const</span> <a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#a41f1ae98474c9100f318502ea80bf3c8">  506</a></span>&#160;  <a class="code" href="classoem_1_1AgendaWrapper.html#a41f1ae98474c9100f318502ea80bf3c8">AgendaWrapper</a>(<a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> &amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#ab9e2d876288e2b8ddeefc5c9bd63a9b4">  507</a></span>&#160;  <a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> &amp;<a class="code" href="classoem_1_1AgendaWrapper.html#ab9e2d876288e2b8ddeefc5c9bd63a9b4">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> &amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#aab40b20df3f6a7acfad648d974f4fdb6">  508</a></span>&#160;  <a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> &amp;<a class="code" href="classoem_1_1AgendaWrapper.html#aab40b20df3f6a7acfad648d974f4fdb6">operator=</a>(<a class="code" href="classoem_1_1AgendaWrapper.html">AgendaWrapper</a> &amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#ae69c0f102fad2f1f3ddb026739f0dd99">  521</a></span>&#160;  <a class="code" href="namespaceoem.html#ab339bcff7f08ef7f7c51a05fe8224135">MatrixReference</a> <a class="code" href="classoem_1_1AgendaWrapper.html#ae69c0f102fad2f1f3ddb026739f0dd99">Jacobian</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;xi, <a class="code" href="classVector.html">Vector</a> &amp;yi) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">reuse_jacobian_</a>) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <a class="code" href="auto__md_8cc.html#a4176c1c53e09b61a5d0bff9705f7db86">inversion_iterate_agendaExecute</a>(</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          *<a class="code" href="classoem_1_1AgendaWrapper.html#abb778eb5e0bad36db20cd8e9274ebb8c">ws_</a>, <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>, <a class="code" href="classoem_1_1AgendaWrapper.html#afd36c09d1e559d1cafb48cd8687edb2f">jacobian_</a>, xi, 1, 0, *<a class="code" href="classoem_1_1AgendaWrapper.html#a29c5964a46c05ff5b91e1fedef9ef04a">inversion_iterate_agenda_</a>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      yi = <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <a class="code" href="classoem_1_1AgendaWrapper.html#af17a41e6381f04e5bd11243667b47465">iteration_counter_</a> += 1;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">reuse_jacobian_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      yi = <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classoem_1_1AgendaWrapper.html#afd36c09d1e559d1cafb48cd8687edb2f">jacobian_</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#a1bf10328a4793e877c94c12715449a9d">  543</a></span>&#160;  <a class="code" href="classVector.html">Vector</a> <a class="code" href="classoem_1_1AgendaWrapper.html#a1bf10328a4793e877c94c12715449a9d">evaluate</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;xi) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">reuse_jacobian_</a>) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="classMatrix.html">Matrix</a> dummy;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <a class="code" href="auto__md_8cc.html#a4176c1c53e09b61a5d0bff9705f7db86">inversion_iterate_agendaExecute</a>(*<a class="code" href="classoem_1_1AgendaWrapper.html#abb778eb5e0bad36db20cd8e9274ebb8c">ws_</a>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                      <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                      dummy,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                      xi,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                      0,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                      <a class="code" href="classoem_1_1AgendaWrapper.html#af17a41e6381f04e5bd11243667b47465">iteration_counter_</a>,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                      *<a class="code" href="classoem_1_1AgendaWrapper.html#a29c5964a46c05ff5b91e1fedef9ef04a">inversion_iterate_agenda_</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <a class="code" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">reuse_jacobian_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#a29c5964a46c05ff5b91e1fedef9ef04a">  561</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classAgenda.html">Agenda</a> *<a class="code" href="classoem_1_1AgendaWrapper.html#a29c5964a46c05ff5b91e1fedef9ef04a">inversion_iterate_agenda_</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#af17a41e6381f04e5bd11243667b47465">  562</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classoem_1_1AgendaWrapper.html#af17a41e6381f04e5bd11243667b47465">iteration_counter_</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#afd36c09d1e559d1cafb48cd8687edb2f">  564</a></span>&#160;  <a class="code" href="namespaceoem.html#ab339bcff7f08ef7f7c51a05fe8224135">MatrixReference</a> <a class="code" href="classoem_1_1AgendaWrapper.html#afd36c09d1e559d1cafb48cd8687edb2f">jacobian_</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">  566</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">reuse_jacobian_</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#abb778eb5e0bad36db20cd8e9274ebb8c">  568</a></span>&#160;  <a class="code" href="classWorkspace.html">Workspace</a> *<a class="code" href="classoem_1_1AgendaWrapper.html#abb778eb5e0bad36db20cd8e9274ebb8c">ws_</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">  570</a></span>&#160;  <a class="code" href="classVector.html">Vector</a> <a class="code" href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">yi_</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;};</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;}  <span class="comment">// namespace oem</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="oem_8h.html#ab13e1b1d2add3d0a142d72dadbd32e69">  582</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="oem_8h.html#ab13e1b1d2add3d0a142d72dadbd32e69">Tensor4Clip</a>(<a class="code" href="classTensor4.html">Tensor4</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                 <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&amp; iq,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                 <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&amp; limit_low,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                 <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&amp; limit_high) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// Sizes</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nq = <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.nbooks();</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">if</span> (iq &lt; -1) <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Argument *iq* must be &gt;= -1.&quot;</span>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">if</span> (iq &gt;= nq) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    ostringstream os;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Argument *iq* is too high.\n&quot;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;You have selected index: &quot;</span> &lt;&lt; iq &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;but the number of quantities is only: &quot;</span> &lt;&lt; nq &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;(Note that zero-based indexing is used)\n&quot;</span>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> ifirst = 0, ilast = nq - 1;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">if</span> (iq &gt; -1) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    ifirst = iq;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    ilast = iq;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">if</span> (!std::isinf(limit_low)) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> i = ifirst; i &lt;= ilast; i++) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> p = 0; p &lt; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.npages(); p++) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> r = 0; r &lt; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.nrows(); r++) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> c = 0; c &lt; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.ncols(); c++) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>(i, p, r, c) &lt; limit_low) <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>(i, p, r, c) = limit_low;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">if</span> (!std::isinf(limit_high)) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> i = ifirst; i &lt;= ilast; i++) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> p = 0; p &lt; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.npages(); p++) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> r = 0; r &lt; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.nrows(); r++) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> c = 0; c &lt; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.ncols(); c++) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>(i, p, r, c) &gt; limit_high) <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>(i, p, r, c) = limit_high;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">// OEM error checking</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="oem_8h.html#aafbc8ba89ea349a05dcd72f94a872bb8">  666</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="oem_8h.html#aafbc8ba89ea349a05dcd72f94a872bb8">OEM_checks</a>(<a class="code" href="classWorkspace.html">Workspace</a>&amp; ws,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">yf</a>,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <a class="code" href="classMatrix.html">Matrix</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keyword">const</span> <a class="code" href="classAgenda.html">Agenda</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#af9cecac8f38afac27c0a68127879cff7">inversion_iterate_agenda</a>,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#ab4ab4f45580211424dc9145a60fd9753">xa</a>,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keyword">const</span> <a class="code" href="classCovarianceMatrix.html">CovarianceMatrix</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#afeff6a580e5feed359a0bb6e22440950">covmat_sx</a>,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#adb488742dfe7a156414f354acd168e75">y</a>,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keyword">const</span> <a class="code" href="classCovarianceMatrix.html">CovarianceMatrix</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a90403d44446706b3bb2eaf2a6b3dd184">covmat_se</a>,</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfRetrievalQuantity</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">jacobian_quantities</a>,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keyword">const</span> <a class="code" href="classmy__basic__string.html">String</a>&amp; method,</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; x_norm,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&amp; max_iter,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&amp; stop_dx,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; lm_ga_settings,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&amp; clear_matrices,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&amp; display_progress) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nq = <a class="code" href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">jacobian_quantities</a>.nelem();</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> n = <a class="code" href="namespaceARTS_1_1Var.html#ab4ab4f45580211424dc9145a60fd9753">xa</a>.nelem();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> m = <a class="code" href="namespaceARTS_1_1Var.html#adb488742dfe7a156414f354acd168e75">y</a>.nelem();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.nelem() != n) &amp;&amp; (<a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.nelem() != 0))</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="stringliteral">&quot;The length of *x* must be either the same as *xa* or 0.&quot;</span>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#afeff6a580e5feed359a0bb6e22440950">covmat_sx</a>.ncols() != <a class="code" href="namespaceARTS_1_1Var.html#afeff6a580e5feed359a0bb6e22440950">covmat_sx</a>.nrows())</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;*covmat_sx* must be a square matrix.&quot;</span>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#afeff6a580e5feed359a0bb6e22440950">covmat_sx</a>.ncols() != n)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Inconsistency in size between *x* and *covmat_sx*.&quot;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">yf</a>.nelem() != m) &amp;&amp; (<a class="code" href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">yf</a>.nelem() != 0))</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="stringliteral">&quot;The length of *yf* must be either the same as *y* or 0.&quot;</span>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#a90403d44446706b3bb2eaf2a6b3dd184">covmat_se</a>.ncols() != <a class="code" href="namespaceARTS_1_1Var.html#a90403d44446706b3bb2eaf2a6b3dd184">covmat_se</a>.nrows())</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;*covmat_se* must be a square matrix.&quot;</span>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#a90403d44446706b3bb2eaf2a6b3dd184">covmat_se</a>.ncols() != m)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Inconsistency in size between *y* and *covmat_se*.&quot;</span>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>.nrows() != m) &amp;&amp; (!<a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>.empty()))</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="stringliteral">&quot;The number of rows of the jacobian must be either the number of elements in *y* or 0.&quot;</span>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>.ncols() != n) &amp;&amp; (!<a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>.empty()))</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="stringliteral">&quot;The number of cols of the jacobian must be either the number of elements in *xa* or 0.&quot;</span>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <a class="code" href="classArray.html">ArrayOfArrayOfIndex</a> jacobian_indices;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordtype">bool</span> any_affine;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="jacobian_8cc.html#adf2fcbfc88a09e39adb444b5da70930c">jac_ranges_indices</a>(jacobian_indices, any_affine, <a class="code" href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">jacobian_quantities</a>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keywordflow">if</span> (jacobian_indices.<a class="code" href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">nelem</a>() != nq)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="stringliteral">&quot;Different number of elements in *jacobian_quantities* &quot;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="stringliteral">&quot;and *jacobian_indices*.&quot;</span>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span> (nq &amp;&amp; jacobian_indices[nq - 1][1] + 1 != n)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="stringliteral">&quot;Size of *covmat_sx* do not agree with Jacobian &quot;</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="stringliteral">&quot;information (*jacobian_indices*).&quot;</span>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// Check GINs</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">if</span> (!(method == <span class="stringliteral">&quot;li&quot;</span> || method == <span class="stringliteral">&quot;gn&quot;</span> || method == <span class="stringliteral">&quot;li_m&quot;</span> ||</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        method == <span class="stringliteral">&quot;gn_m&quot;</span> || method == <span class="stringliteral">&quot;ml&quot;</span> || method == <span class="stringliteral">&quot;lm&quot;</span> ||</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        method == <span class="stringliteral">&quot;li_cg&quot;</span> || method == <span class="stringliteral">&quot;gn_cg&quot;</span> || method == <span class="stringliteral">&quot;li_cg_m&quot;</span> ||</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        method == <span class="stringliteral">&quot;gn_cg_m&quot;</span> || method == <span class="stringliteral">&quot;lm_cg&quot;</span> || method == <span class="stringliteral">&quot;ml_cg&quot;</span>)) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="stringliteral">&quot;Valid options for *method* are \&quot;nl\&quot;, \&quot;gn\&quot; and &quot;</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="stringliteral">&quot;\&quot;ml\&quot; or \&quot;lm\&quot;.&quot;</span>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (!(x_norm.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() == 0 || x_norm.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() == n)) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="stringliteral">&quot;The vector *x_norm* must have length 0 or match &quot;</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="stringliteral">&quot;*covmat_sx*.&quot;</span>);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (x_norm.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() &gt; 0 &amp;&amp; <a class="code" href="legacy__continua_8cc.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(x_norm) &lt;= 0) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;All values in *x_norm* must be &gt; 0.&quot;</span>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (max_iter &lt;= 0) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;The argument *max_iter* must be &gt; 0.&quot;</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">if</span> (stop_dx &lt;= 0) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;The argument *stop_dx* must be &gt; 0.&quot;</span>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">if</span> ((method == <span class="stringliteral">&quot;ml&quot;</span>) || (method == <span class="stringliteral">&quot;lm&quot;</span>) || (method == <span class="stringliteral">&quot;lm_cg&quot;</span>) ||</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      (method == <span class="stringliteral">&quot;ml_cg&quot;</span>)) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (lm_ga_settings.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() != 6) {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          <span class="stringliteral">&quot;When using \&quot;ml\&quot;, *lm_ga_setings* must be a &quot;</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="stringliteral">&quot;vector of length 6.&quot;</span>);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="legacy__continua_8cc.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(lm_ga_settings) &lt; 0) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">throw</span> runtime_error(</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          <span class="stringliteral">&quot;The vector *lm_ga_setings* can not contain any &quot;</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <span class="stringliteral">&quot;negative value.&quot;</span>);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="keywordflow">if</span> (clear_matrices &lt; 0 || clear_matrices &gt; 1)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Valid options for *clear_matrices* are 0 and 1.&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">if</span> (display_progress &lt; 0 || display_progress &gt; 1)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Valid options for *display_progress* are 0 and 1.&quot;</span>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="comment">// If necessary compute yf and jacobian.</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>.nelem() == 0) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a> = <a class="code" href="namespaceARTS_1_1Var.html#ab4ab4f45580211424dc9145a60fd9753">xa</a>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="auto__md_8cc.html#a4176c1c53e09b61a5d0bff9705f7db86">inversion_iterate_agendaExecute</a>(</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        ws, <a class="code" href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">yf</a>, <a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>, <a class="code" href="namespaceARTS_1_1Var.html#ab4ab4f45580211424dc9145a60fd9753">xa</a>, 1, 0, <a class="code" href="namespaceARTS_1_1Var.html#af9cecac8f38afac27c0a68127879cff7">inversion_iterate_agenda</a>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">yf</a>.nelem() == 0) || (<a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>.empty())) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="auto__md_8cc.html#a4176c1c53e09b61a5d0bff9705f7db86">inversion_iterate_agendaExecute</a>(</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        ws, <a class="code" href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">yf</a>, <a class="code" href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">jacobian</a>, <a class="code" href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">x</a>, 1, 0, <a class="code" href="namespaceARTS_1_1Var.html#af9cecac8f38afac27c0a68127879cff7">inversion_iterate_agenda</a>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor">#endif  // _ARTS_OEM_H_</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassMatrix_html"><div class="ttname"><a href="classMatrix.html">Matrix</a></div><div class="ttdoc">The Matrix class.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8h_source.html#l01193">matpackI.h:1193</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a9cfd916a3a13d5f314dd22cab00b16cf"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a9cfd916a3a13d5f314dd22cab00b16cf">oem::ArtsLog::scaling_factor_</a></div><div class="ttdeci">Numeric scaling_factor_</div><div class="ttdoc">Scaling factor for the cost.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00401">oem.h:401</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_acbad221f606cbcf9a5492b7d220873a1"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#acbad221f606cbcf9a5492b7d220873a1">oem::AgendaWrapper::get_measurement_vector</a></div><div class="ttdeci">ArtsVector get_measurement_vector()</div><div class="ttdoc">Return most recently simulated measurement vector.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00503">oem.h:503</a></div></div>
<div class="ttc" id="aclassoem_1_1NormalizingSolver_html_a2587a6d1b58b9920dc60f540f5840cd8"><div class="ttname"><a href="classoem_1_1NormalizingSolver.html#a2587a6d1b58b9920dc60f540f5840cd8">oem::NormalizingSolver::trans_</a></div><div class="ttdeci">const TransformationMatrixType &amp; trans_</div><div class="ttdoc">The transformation matrix.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00150">oem.h:150</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_a41f1ae98474c9100f318502ea80bf3c8"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#a41f1ae98474c9100f318502ea80bf3c8">oem::AgendaWrapper::AgendaWrapper</a></div><div class="ttdeci">AgendaWrapper(AgendaWrapper &amp;&amp;)=delete</div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_a341022bbaa2a83d6790f56e743e459d3"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#a341022bbaa2a83d6790f56e743e459d3">oem::AgendaWrapper::reuse_jacobian_</a></div><div class="ttdeci">bool reuse_jacobian_</div><div class="ttdoc">Flag whether to reuse Jacobian from previous calculation.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00566">oem.h:566</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a750085e9b1eb18fb917b5fd5a3c82149"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">ARTS::Var::jacobian_quantities</a></div><div class="ttdeci">ArrayOfRetrievalQuantity jacobian_quantities(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l03924">autoarts.h:3924</a></div></div>
<div class="ttc" id="alinefunctions_8cc_html_a3b4555133ea360cd068890a3e3cefaf5"><div class="ttname"><a href="linefunctions_8cc.html#a3b4555133ea360cd068890a3e3cefaf5">w</a></div><div class="ttdeci">Complex w(Complex z) noexcept</div><div class="ttdoc">The Faddeeva function.</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8cc_source.html#l00042">linefunctions.cc:42</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a14066108d106f8ca519ef2b01a410ccb"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a14066108d106f8ca519ef2b01a410ccb">oem::ArtsLog::step</a></div><div class="ttdeci">void step(const Params &amp;... params)</div><div class="ttdoc">Print step to command line.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00319">oem.h:319</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a1e72be9edf6f6e181d31782a263d7a36"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a1e72be9edf6f6e181d31782a263d7a36">oem::ArtsLog::gamma_history_</a></div><div class="ttdeci">Vector gamma_history_</div><div class="ttdoc">Reference to ARTS vector holding the LM gamma history.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00399">oem.h:399</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a7f911815dde4ea801960b8dd8b433bd7"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a7f911815dde4ea801960b8dd8b433bd7">oem::ArtsLog::finalize</a></div><div class="ttdeci">void finalize(const Params &amp;... params)</div><div class="ttdoc">Finalize log output.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00351">oem.h:351</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html">oem::AgendaWrapper</a></div><div class="ttdoc">Interface to ARTS inversion_iterate_agenda.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00462">oem.h:462</a></div></div>
<div class="ttc" id="anamespaceoem_html_a6dead99de47f1704cff777837f5044e9"><div class="ttname"><a href="namespaceoem.html#a6dead99de47f1704cff777837f5044e9">oem::Matrix</a></div><div class="ttdeci">invlib::Matrix&lt; ArtsMatrix &gt; Matrix</div><div class="ttdoc">invlib wrapper type for ARTS matrices.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00034">oem.h:34</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_abb778eb5e0bad36db20cd8e9274ebb8c"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#abb778eb5e0bad36db20cd8e9274ebb8c">oem::AgendaWrapper::ws_</a></div><div class="ttdeci">Workspace * ws_</div><div class="ttdoc">Pointer to current ARTS workspace.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00568">oem.h:568</a></div></div>
<div class="ttc" id="aclassoem_1_1NormalizingSolver_html_a49b244ca9a698145614133feafd14a7e"><div class="ttname"><a href="classoem_1_1NormalizingSolver.html#a49b244ca9a698145614133feafd14a7e">oem::NormalizingSolver::solve</a></div><div class="ttdeci">auto solve(const MatrixType &amp;A, const VectorType &amp;v) -&gt; typename VectorType::ResultType</div><div class="ttdoc">Solve linear system.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00132">oem.h:132</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_ab4ab4f45580211424dc9145a60fd9753"><div class="ttname"><a href="namespaceARTS_1_1Var.html#ab4ab4f45580211424dc9145a60fd9753">ARTS::Var::xa</a></div><div class="ttdeci">Vector xa(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l07359">autoarts.h:7359</a></div></div>
<div class="ttc" id="aclassCovarianceMatrix_html"><div class="ttname"><a href="classCovarianceMatrix.html">CovarianceMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="covariance__matrix_8h_source.html#l00226">covariance_matrix.h:226</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_adb488742dfe7a156414f354acd168e75"><div class="ttname"><a href="namespaceARTS_1_1Var.html#adb488742dfe7a156414f354acd168e75">ARTS::Var::y</a></div><div class="ttdeci">Vector y(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l07401">autoarts.h:7401</a></div></div>
<div class="ttc" id="anamespaceoem_html_aaf5723d672c14297d8cca54521fc7c98"><div class="ttname"><a href="namespaceoem.html#aaf5723d672c14297d8cca54521fc7c98">oem::OEM_NFORM</a></div><div class="ttdeci">invlib::MAP&lt; ForwardModel, Matrix, CovarianceMatrix, CovarianceMatrix, Vector, Formulation::NFORM &gt; OEM_NFORM</div><div class="ttdoc">OEM n form.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00074">oem.h:79</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a7cd942bd3301f5d475408f5fa702692f"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a7cd942bd3301f5d475408f5fa702692f">oem::ArtsLog::ArtsLog</a></div><div class="ttdeci">ArtsLog(unsigned int v, ::Vector &amp;g, bool l=false)</div><div class="ttdoc">Create log.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00253">oem.h:253</a></div></div>
<div class="ttc" id="aoem_8h_html_aafbc8ba89ea349a05dcd72f94a872bb8"><div class="ttname"><a href="oem_8h.html#aafbc8ba89ea349a05dcd72f94a872bb8">OEM_checks</a></div><div class="ttdeci">void OEM_checks(Workspace &amp;ws, Vector &amp;x, Vector &amp;yf, Matrix &amp;jacobian, const Agenda &amp;inversion_iterate_agenda, const Vector &amp;xa, const CovarianceMatrix &amp;covmat_sx, const Vector &amp;y, const CovarianceMatrix &amp;covmat_se, const ArrayOfRetrievalQuantity &amp;jacobian_quantities, const String &amp;method, const Vector &amp;x_norm, const Index &amp;max_iter, const Numeric &amp;stop_dx, const Vector &amp;lm_ga_settings, const Index &amp;clear_matrices, const Index &amp;display_progress)</div><div class="ttdoc">Error checking for OEM method.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00666">oem.h:666</a></div></div>
<div class="ttc" id="anamespaceoem_html_a61d2fa534a725b003793d931c53f18c5"><div class="ttname"><a href="namespaceoem.html#a61d2fa534a725b003793d931c53f18c5">oem::CovarianceMatrix</a></div><div class="ttdeci">invlib::Matrix&lt; ArtsCovarianceMatrixWrapper &gt; CovarianceMatrix</div><div class="ttdoc">invlib wrapper type for ARTS the ARTS covariance class.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00038">oem.h:38</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_af9cecac8f38afac27c0a68127879cff7"><div class="ttname"><a href="namespaceARTS_1_1Var.html#af9cecac8f38afac27c0a68127879cff7">ARTS::Var::inversion_iterate_agenda</a></div><div class="ttdeci">Agenda inversion_iterate_agenda(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l03635">autoarts.h:3635</a></div></div>
<div class="ttc" id="aclassTensor4_html"><div class="ttname"><a href="classTensor4.html">Tensor4</a></div><div class="ttdoc">The Tensor4 class.</div><div class="ttdef"><b>Definition:</b> <a href="matpackIV_8h_source.html#l00421">matpackIV.h:421</a></div></div>
<div class="ttc" id="aclassAgenda_html"><div class="ttname"><a href="classAgenda.html">Agenda</a></div><div class="ttdoc">The Agenda class.</div><div class="ttdef"><b>Definition:</b> <a href="agenda__class_8h_source.html#l00044">agenda_class.h:44</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_af17a41e6381f04e5bd11243667b47465"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#af17a41e6381f04e5bd11243667b47465">oem::AgendaWrapper::iteration_counter_</a></div><div class="ttdeci">unsigned int iteration_counter_</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00562">oem.h:562</a></div></div>
<div class="ttc" id="aclassArray_html"><div class="ttname"><a href="classArray.html">Array</a></div><div class="ttdoc">This can be used to make arrays out of anything.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00108">array.h:108</a></div></div>
<div class="ttc" id="anamespaceoem_html_a9958bea7157fa0f5a72027b936d52ec1"><div class="ttname"><a href="namespaceoem.html#a9958bea7157fa0f5a72027b936d52ec1">oem::GN</a></div><div class="ttdeci">invlib::GaussNewton&lt; Numeric, Std &gt; GN</div><div class="ttdoc">OEM Gauss-Newton optimization using normed ARTS QR solver.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00169">oem.h:169</a></div></div>
<div class="ttc" id="anamespaceAbsorption_html_a5694bacde9aa335dc5ec69d50f201992"><div class="ttname"><a href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">Absorption::nelem</a></div><div class="ttdeci">Index nelem(const Lines &amp;l)</div><div class="ttdoc">Number of lines.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8h_source.html#l01820">absorptionlines.h:1820</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a56e373040f6d0e35cd470d3be69e7f12"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a56e373040f6d0e35cd470d3be69e7f12">oem::ArtsLog::linear_</a></div><div class="ttdeci">bool linear_</div><div class="ttdoc">Flag indicating whether forward model is linear.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00405">oem.h:405</a></div></div>
<div class="ttc" id="anamespaceoem_html_a71d313d2d45438601a48a8ad72a7f540"><div class="ttname"><a href="namespaceoem.html#a71d313d2d45438601a48a8ad72a7f540">oem::GN_CG</a></div><div class="ttdeci">invlib::GaussNewton&lt; Numeric, CG &gt; GN_CG</div><div class="ttdoc">Gauss-Newton (GN) optimization using normed CG solver.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00171">oem.h:171</a></div></div>
<div class="ttc" id="alegacy__continua_8cc_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="legacy__continua_8cc.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="legacy__continua_8cc_source.html#l20628">legacy_continua.cc:20628</a></div></div>
<div class="ttc" id="aauto__md_8cc_html_a4176c1c53e09b61a5d0bff9705f7db86"><div class="ttname"><a href="auto__md_8cc.html#a4176c1c53e09b61a5d0bff9705f7db86">inversion_iterate_agendaExecute</a></div><div class="ttdeci">void inversion_iterate_agendaExecute(Workspace &amp;ws, Vector &amp;yf, Matrix &amp;jacobian, const Vector &amp;x, const Index jacobian_do, const Index inversion_iteration_counter, const Agenda &amp;input_agenda)</div><div class="ttdef"><b>Definition:</b> <a href="auto__md_8cc_source.html#l23951">auto_md.cc:23951</a></div></div>
<div class="ttc" id="astructoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4_html_a9e9ae30110e80531b0bf33bb268d6e07"><div class="ttname"><a href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#a9e9ae30110e80531b0bf33bb268d6e07">oem::OptimizerLog&lt; invlib::GaussNewton&lt; RealType, Solver &gt; &gt;::log</a></div><div class="ttdeci">static std::string log(const invlib::GaussNewton&lt; RealType, Solver &gt; &amp;, Vector &amp;, size_t)</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00229">oem.h:229</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_ae69c0f102fad2f1f3ddb026739f0dd99"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#ae69c0f102fad2f1f3ddb026739f0dd99">oem::AgendaWrapper::Jacobian</a></div><div class="ttdeci">MatrixReference Jacobian(const Vector &amp;xi, Vector &amp;yi)</div><div class="ttdoc">Evaluate forward model and compute Jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00521">oem.h:521</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a1d2b3087572593d3ebacd17584154970"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a1d2b3087572593d3ebacd17584154970">oem::ArtsLog::init</a></div><div class="ttdeci">void init(Params &amp;... params)</div><div class="ttdoc">Initialize log output.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00273">oem.h:273</a></div></div>
<div class="ttc" id="aclassmy__basic__string_html"><div class="ttname"><a href="classmy__basic__string.html">my_basic_string&lt; char &gt;</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_ad18b23b258cb0b40a8b3b4e22517816c"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#ad18b23b258cb0b40a8b3b4e22517816c">oem::AgendaWrapper::yi_</a></div><div class="ttdeci">Vector yi_</div><div class="ttdoc">Cached simulation result.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00570">oem.h:570</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html"><div class="ttname"><a href="classoem_1_1ArtsLog.html">oem::ArtsLog</a></div><div class="ttdoc">OEM log output.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00244">oem.h:244</a></div></div>
<div class="ttc" id="anamespaceoem_html_a1dedb105e8f358ca2798a1c7b609f580"><div class="ttname"><a href="namespaceoem.html#a1dedb105e8f358ca2798a1c7b609f580">oem::OEM_MFORM</a></div><div class="ttdeci">invlib::MAP&lt; ForwardModel, Matrix, CovarianceMatrix, CovarianceMatrix, Vector, Formulation::MFORM &gt; OEM_MFORM</div><div class="ttdoc">OEM m form.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00090">oem.h:95</a></div></div>
<div class="ttc" id="aclassConstVectorView_html_a213a97c28cd05116cab820e32d2f102f"><div class="ttname"><a href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">ConstVectorView::nelem</a></div><div class="ttdeci">Index nelem() const</div><div class="ttdoc">Returns the number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8cc_source.html#l00051">matpackI.cc:51</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_aa885d71bfefb020bf9b964ec95f6957a"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#aa885d71bfefb020bf9b964ec95f6957a">oem::AgendaWrapper::AgendaWrapper</a></div><div class="ttdeci">AgendaWrapper(const AgendaWrapper &amp;)=delete</div></div>
<div class="ttc" id="amatpack_8h_html_ad9a8dbb27c0bbea7271d916036122f6a"><div class="ttname"><a href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a></div><div class="ttdeci">NUMERIC Numeric</div><div class="ttdoc">The type to use for all floating point numbers.</div><div class="ttdef"><b>Definition:</b> <a href="matpack_8h_source.html#l00033">matpack.h:33</a></div></div>
<div class="ttc" id="anamespaceoem_html_aba5a4f073b66de221b22d802537b1a1f"><div class="ttname"><a href="namespaceoem.html#aba5a4f073b66de221b22d802537b1a1f">oem::handle_nested_exception</a></div><div class="ttdeci">std::vector&lt; std::string &gt; handle_nested_exception(const E &amp;e, int level=0)</div><div class="ttdoc">Handle exception encountered within invlib.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00425">oem.h:425</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a0144fa80fe874510811bacfdc38b91bc"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a0144fa80fe874510811bacfdc38b91bc">ARTS::Var::yf</a></div><div class="ttdeci">Vector yf(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l07658">autoarts.h:7658</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_afeff6a580e5feed359a0bb6e22440950"><div class="ttname"><a href="namespaceARTS_1_1Var.html#afeff6a580e5feed359a0bb6e22440950">ARTS::Var::covmat_sx</a></div><div class="ttdeci">CovarianceMatrix covmat_sx(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02945">autoarts.h:2945</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a90403d44446706b3bb2eaf2a6b3dd184"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a90403d44446706b3bb2eaf2a6b3dd184">ARTS::Var::covmat_se</a></div><div class="ttdeci">CovarianceMatrix covmat_se(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02879">autoarts.h:2879</a></div></div>
<div class="ttc" id="amatpackI_8h_html_ad94d14aeb1d269a3069e70a6be5aa6a1"><div class="ttname"><a href="matpackI_8h.html#ad94d14aeb1d269a3069e70a6be5aa6a1">MatrixType</a></div><div class="ttdeci">Eigen::Matrix&lt; Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor &gt; MatrixType</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8h_source.html#l00109">matpackI.h:109</a></div></div>
<div class="ttc" id="astructoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4_html_a4613baabff0f095558990274ab9e32d0"><div class="ttname"><a href="structoem_1_1OptimizerLog_3_01invlib_1_1GaussNewton_3_01RealType_00_01Solver_01_4_01_4.html#a4613baabff0f095558990274ab9e32d0">oem::OptimizerLog&lt; invlib::GaussNewton&lt; RealType, Solver &gt; &gt;::header</a></div><div class="ttdeci">static std::string header()</div><div class="ttdoc">Name to append to header line.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00227">oem.h:227</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_a7a0656a5588752135ebc87e6a16bcbf6"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#a7a0656a5588752135ebc87e6a16bcbf6">oem::AgendaWrapper::m</a></div><div class="ttdeci">const unsigned int m</div><div class="ttdoc">Dimension of the measurement space.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00465">oem.h:465</a></div></div>
<div class="ttc" id="aoem_8h_html_ab13e1b1d2add3d0a142d72dadbd32e69"><div class="ttname"><a href="oem_8h.html#ab13e1b1d2add3d0a142d72dadbd32e69">Tensor4Clip</a></div><div class="ttdeci">void Tensor4Clip(Tensor4 &amp;x, const Index &amp;iq, const Numeric &amp;limit_low, const Numeric &amp;limit_high)</div><div class="ttdoc">Clip Tensor4.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00582">oem.h:582</a></div></div>
<div class="ttc" id="anamespaceoem_html_a39aefe1f71e25848d95bf605dffe1a2d"><div class="ttname"><a href="namespaceoem.html#a39aefe1f71e25848d95bf605dffe1a2d">oem::Identity</a></div><div class="ttdeci">invlib::MatrixIdentity&lt; Matrix &gt; Identity</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00039">oem.h:39</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a01d28833ca2da397e5bf34c75b8358d0"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a01d28833ca2da397e5bf34c75b8358d0">ARTS::Var::nrows</a></div><div class="ttdeci">Index nrows(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l04682">autoarts.h:4682</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_afd36c09d1e559d1cafb48cd8687edb2f"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#afd36c09d1e559d1cafb48cd8687edb2f">oem::AgendaWrapper::jacobian_</a></div><div class="ttdeci">MatrixReference jacobian_</div><div class="ttdoc">Reference to the jacobian WSV.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00564">oem.h:564</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_aef9155542a67ead98532683dbde0ab39"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#aef9155542a67ead98532683dbde0ab39">oem::AgendaWrapper::AgendaWrapper</a></div><div class="ttdeci">AgendaWrapper(Workspace *ws, unsigned int measurement_space_dimension, unsigned int state_space_dimension, ::Matrix &amp;arts_jacobian, ::Vector &amp;arts_y, const Agenda *inversion_iterate_agenda)</div><div class="ttdoc">Create inversion_iterate_agendaExecute wrapper.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00483">oem.h:483</a></div></div>
<div class="ttc" id="anamespaceoem_html_aa1efddaf6e1a5516b2db0bebc1479752"><div class="ttname"><a href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">oem::Vector</a></div><div class="ttdeci">invlib::Vector&lt; ArtsVector &gt; Vector</div><div class="ttdoc">invlib wrapper type for ARTS vectors.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00032">oem.h:32</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_a29c5964a46c05ff5b91e1fedef9ef04a"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#a29c5964a46c05ff5b91e1fedef9ef04a">oem::AgendaWrapper::inversion_iterate_agenda_</a></div><div class="ttdeci">const Agenda * inversion_iterate_agenda_</div><div class="ttdoc">Pointer to the inversion_iterate_agenda of the workspace.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00561">oem.h:561</a></div></div>
<div class="ttc" id="anamespaceoem_html"><div class="ttname"><a href="namespaceoem.html">oem</a></div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00029">oem.h:29</a></div></div>
<div class="ttc" id="astructoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4_html_a95e35c686f0450fdb292868c1b1e64db"><div class="ttname"><a href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#a95e35c686f0450fdb292868c1b1e64db">oem::OptimizerLog&lt; invlib::LevenbergMarquardt&lt; RealType, DampingMatrix, Solver &gt; &gt;::header</a></div><div class="ttdeci">static std::string header()</div><div class="ttdoc">Name to append to header line.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00202">oem.h:202</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_a1bf10328a4793e877c94c12715449a9d"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#a1bf10328a4793e877c94c12715449a9d">oem::AgendaWrapper::evaluate</a></div><div class="ttdeci">Vector evaluate(const Vector &amp;xi)</div><div class="ttdoc">Evaluate the ARTS forward model.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00543">oem.h:543</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a761f5a1b546e6751cc75526598ab9c2e"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a761f5a1b546e6751cc75526598ab9c2e">oem::ArtsLog::finalized_</a></div><div class="ttdeci">bool finalized_</div><div class="ttdoc">Flag indicating whether output has been finalized.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00407">oem.h:407</a></div></div>
<div class="ttc" id="anamespaceoem_html_ab339bcff7f08ef7f7c51a05fe8224135"><div class="ttname"><a href="namespaceoem.html#ab339bcff7f08ef7f7c51a05fe8224135">oem::MatrixReference</a></div><div class="ttdeci">invlib::Matrix&lt; ArtsMatrixReference&lt;::Matrix &gt; &gt; MatrixReference</div><div class="ttdoc">invlib wrapper type for ARTS matrices to be passed by reference.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00036">oem.h:36</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_a86aca57f72a439596da0aaa86516fab3"><div class="ttname"><a href="classoem_1_1ArtsLog.html#a86aca57f72a439596da0aaa86516fab3">oem::ArtsLog::start_cost_</a></div><div class="ttdeci">Numeric start_cost_</div><div class="ttdoc">Start cost (not computed by invlib)</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00403">oem.h:403</a></div></div>
<div class="ttc" id="aclassWorkspace_html"><div class="ttname"><a href="classWorkspace.html">Workspace</a></div><div class="ttdoc">Workspace class.</div><div class="ttdef"><b>Definition:</b> <a href="workspace__ng_8h_source.html#l00040">workspace_ng.h:40</a></div></div>
<div class="ttc" id="anamespaceoem_html_a5511ae2b5e2f5ac4842748039ed99e8a"><div class="ttname"><a href="namespaceoem.html#a5511ae2b5e2f5ac4842748039ed99e8a">oem::OEM_STANDARD</a></div><div class="ttdeci">invlib::MAP&lt; ForwardModel, Matrix, CovarianceMatrix, CovarianceMatrix, Vector, Formulation::STANDARD, invlib::Rodgers531 &gt; OEM_STANDARD</div><div class="ttdoc">OEM standard form.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00057">oem.h:63</a></div></div>
<div class="ttc" id="astructoem_1_1OptimizerLog_html"><div class="ttname"><a href="structoem_1_1OptimizerLog.html">oem::OptimizerLog</a></div><div class="ttdoc">Log customization for different optimization methods.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00188">oem.h:188</a></div></div>
<div class="ttc" id="anamespaceoem_html_a333b9b6ecfa4a0675ce7dede06659522"><div class="ttname"><a href="namespaceoem.html#a333b9b6ecfa4a0675ce7dede06659522">oem::LM_CG</a></div><div class="ttdeci">invlib::LevenbergMarquardt&lt; Numeric, CovarianceMatrix, CG &gt; LM_CG</div><div class="ttdoc">Levenberg-Marquardt (LM) optimization using normed CG solver.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00175">oem.h:175</a></div></div>
<div class="ttc" id="aclassoem_1_1NormalizingSolver_html"><div class="ttname"><a href="classoem_1_1NormalizingSolver.html">oem::NormalizingSolver</a></div><div class="ttdoc">Normalizing solver.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00113">oem.h:113</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_aab40b20df3f6a7acfad648d974f4fdb6"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#aab40b20df3f6a7acfad648d974f4fdb6">oem::AgendaWrapper::operator=</a></div><div class="ttdeci">AgendaWrapper &amp; operator=(AgendaWrapper &amp;&amp;)=delete</div></div>
<div class="ttc" id="aclassoem_1_1NormalizingSolver_html_a6537be2689c69a576e1594d19a5798ba"><div class="ttname"><a href="classoem_1_1NormalizingSolver.html#a6537be2689c69a576e1594d19a5798ba">oem::NormalizingSolver::apply_</a></div><div class="ttdeci">const bool apply_</div><div class="ttdoc">Whether or not to apply the transformation.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00148">oem.h:148</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_aae29ea0bb278ae3900f0a75f660d73b8"><div class="ttname"><a href="namespaceARTS_1_1Var.html#aae29ea0bb278ae3900f0a75f660d73b8">ARTS::Var::jacobian</a></div><div class="ttdeci">Matrix jacobian(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l03892">autoarts.h:3892</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_aeb141694315061634800e0ddc30701ca"><div class="ttname"><a href="namespaceARTS_1_1Var.html#aeb141694315061634800e0ddc30701ca">ARTS::Var::x</a></div><div class="ttdeci">Vector x(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l07346">autoarts.h:7346</a></div></div>
<div class="ttc" id="amatpack_8h_html_aedca4b4670b166565b5b40c700d65a7c"><div class="ttname"><a href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a></div><div class="ttdeci">INDEX Index</div><div class="ttdoc">The type to use for all integer numbers and indices.</div><div class="ttdef"><b>Definition:</b> <a href="matpack_8h_source.html#l00039">matpack.h:39</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_ae7a4e0ef46cae9d1f309d4bf9267c41c"><div class="ttname"><a href="namespaceARTS_1_1Var.html#ae7a4e0ef46cae9d1f309d4bf9267c41c">ARTS::Var::ncols</a></div><div class="ttdeci">Index ncols(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l04546">autoarts.h:4546</a></div></div>
<div class="ttc" id="aclassoem_1_1NormalizingSolver_html_a329b7c8b5375d7dc35f30fd8e5247cb9"><div class="ttname"><a href="classoem_1_1NormalizingSolver.html#a329b7c8b5375d7dc35f30fd8e5247cb9">oem::NormalizingSolver::NormalizingSolver</a></div><div class="ttdeci">NormalizingSolver(const TransformationMatrixType &amp;trans, bool apply, Params... params)</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00116">oem.h:116</a></div></div>
<div class="ttc" id="anamespaceoem_html_a5572926b564f0e50c8c63ddc36f68bb1"><div class="ttname"><a href="namespaceoem.html#a5572926b564f0e50c8c63ddc36f68bb1">oem::LM</a></div><div class="ttdeci">invlib::LevenbergMarquardt&lt; Numeric, CovarianceMatrix, Std &gt; LM</div><div class="ttdoc">Levenberg-Marquardt (LM) optimization using normed ARTS QR solver.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00173">oem.h:173</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_ab9e2d876288e2b8ddeefc5c9bd63a9b4"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#ab9e2d876288e2b8ddeefc5c9bd63a9b4">oem::AgendaWrapper::operator=</a></div><div class="ttdeci">AgendaWrapper &amp; operator=(const AgendaWrapper &amp;)=delete</div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdoc">The Vector class.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8h_source.html#l00860">matpackI.h:860</a></div></div>
<div class="ttc" id="ajacobian_8cc_html_adf2fcbfc88a09e39adb444b5da70930c"><div class="ttname"><a href="jacobian_8cc.html#adf2fcbfc88a09e39adb444b5da70930c">jac_ranges_indices</a></div><div class="ttdeci">void jac_ranges_indices(ArrayOfArrayOfIndex &amp;jis, bool &amp;any_affine, const ArrayOfRetrievalQuantity &amp;jqs, const bool &amp;before_affine)</div><div class="ttdoc">Determines the index range inside x and the Jacobian for each retrieval quantity.</div><div class="ttdef"><b>Definition:</b> <a href="jacobian_8cc_source.html#l00058">jacobian.cc:58</a></div></div>
<div class="ttc" id="aclassArray_html_a90ce1cf3f99646da9d0efd6e8a661369"><div class="ttname"><a href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">Array::nelem</a></div><div class="ttdeci">Index nelem() const</div><div class="ttdoc">Number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00195">array.h:195</a></div></div>
<div class="ttc" id="aclassoem_1_1AgendaWrapper_html_ae9e8e78fb6e14a0df9c2c93dd051b2f2"><div class="ttname"><a href="classoem_1_1AgendaWrapper.html#ae9e8e78fb6e14a0df9c2c93dd051b2f2">oem::AgendaWrapper::n</a></div><div class="ttdeci">const unsigned int n</div><div class="ttdoc">Dimension of the state space.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00467">oem.h:467</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_aa2048a67d92b7a076cc32c2622915110"><div class="ttname"><a href="classoem_1_1ArtsLog.html#aa2048a67d92b7a076cc32c2622915110">oem::ArtsLog::time</a></div><div class="ttdeci">void time(const Params &amp;... params)</div><div class="ttdoc">Print timing information to command line.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00378">oem.h:378</a></div></div>
<div class="ttc" id="astructoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4_html_a7435095f88d862e402b155cb22609aa6"><div class="ttname"><a href="structoem_1_1OptimizerLog_3_01invlib_1_1LevenbergMarquardt_3_01RealType_00_01DampingMatrix_00_01Solver_01_4_01_4.html#a7435095f88d862e402b155cb22609aa6">oem::OptimizerLog&lt; invlib::LevenbergMarquardt&lt; RealType, DampingMatrix, Solver &gt; &gt;::log</a></div><div class="ttdeci">static std::string log(const invlib::LevenbergMarquardt&lt; RealType, DampingMatrix, Solver &gt; &amp;g, Vector &amp;gamma_history_, size_t i)</div><div class="ttdoc">Returns the string to append to the log of a single step.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00208">oem.h:208</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_ad6b0dae251360ebe1bdc8647ee6a316d"><div class="ttname"><a href="classoem_1_1ArtsLog.html#ad6b0dae251360ebe1bdc8647ee6a316d">oem::ArtsLog::verbosity_</a></div><div class="ttdeci">int verbosity_</div><div class="ttdoc">Verbosity level of logger.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00397">oem.h:397</a></div></div>
<div class="ttc" id="aclassoem_1_1ArtsLog_html_ac56a88d7bb7f9c338ac973513de1dfe5"><div class="ttname"><a href="classoem_1_1ArtsLog.html#ac56a88d7bb7f9c338ac973513de1dfe5">oem::ArtsLog::~ArtsLog</a></div><div class="ttdeci">~ArtsLog()</div><div class="ttdoc">Finalizes log output if necessary.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00257">oem.h:257</a></div></div>
<div class="ttc" id="acovariance__matrix_8cc_html_aa8a1164863690b8ff9ab7f439da5cbda"><div class="ttname"><a href="covariance__matrix_8cc.html#aa8a1164863690b8ff9ab7f439da5cbda">solve</a></div><div class="ttdeci">void solve(VectorView w, const CovarianceMatrix &amp;A, ConstVectorView v)</div><div class="ttdef"><b>Definition:</b> <a href="covariance__matrix_8cc_source.html#l00594">covariance_matrix.cc:594</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="oem_8h.html">oem.h</a></li>
    <li class="footer">Generated on Thu Oct 15 2020 08:53:03 for ARTS by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
