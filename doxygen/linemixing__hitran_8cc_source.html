<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: linemixing_hitran.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.4.0(git:4fb77825)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('linemixing__hitran_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">linemixing_hitran.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="linemixing__hitran_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (C) 2020</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Richard Larsson &lt;larsson@mps.mpg.de&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * under the terms of the GNU General Public License as published by the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Free Software Foundation; either version 2, or (at your option) any</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * USA. */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;Faddeeva/Faddeeva.hh&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="linemixing__hitran_8h.html">linemixing_hitran.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lin__alg_8h.html">lin_alg.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="linefunctions_8h.html">linefunctions.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="physics__funcs_8h.html">physics_funcs.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html">   35</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacelm__hitran__2017.html">lm_hitran_2017</a> {</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017_1_1parameters.html">   36</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="arts__api_8cc.html#aecf58615a3442a354517debbf8adeb59">parameters</a> {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nBmx=7<span class="stringliteral">&#39;000;  // Max Number of Bands</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">  static constexpr Index nLmx=700;  // Max Number of Lines per Band</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">  static constexpr Index Nlifmax=10;  // Max number of l values</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="stringliteral">  static constexpr Index Jmax=131;  // Max number of j values</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="stringliteral">  static constexpr Numeric Ct=1.4387686e0;  // Constant</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="stringliteral">  static constexpr Numeric T0=296;  // Constant</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="stringliteral">  static constexpr Numeric CtGamD=1.1325e-08;  // Constant</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="stringliteral">  static constexpr Numeric aMolAtm=7.33889e+21;  // Constant</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="stringliteral">  static constexpr auto aMass = stdarrayify(44.e-3,45.e-3,46.e-3,45.e-3,47.e-3,46.e-3,48.e-3,47.e-3,46.e-3,49.e-3);  // Constant</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral">};</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html">   51</a></span>&#160;<span class="stringliteral">struct CommonBlock {</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html">   52</a></span>&#160;<span class="stringliteral">struct Bands {</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html#a9445da2dea0553be7d447eb810983fa8">   53</a></span>&#160;<span class="stringliteral">  Index nBand;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html#a1b25cf0af503576e6d66deb96c42e3ea">   54</a></span>&#160;<span class="stringliteral">  std::array&lt;Index, parameters::nBmx&gt; Isot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html#aee6285fdbb3d54d905dec508cf865d8c">   55</a></span>&#160;<span class="stringliteral">  std::array&lt;Index, parameters::nBmx&gt; nLines;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html#ac606f713a112be711df5b6b5a96b8045">   56</a></span>&#160;<span class="stringliteral">  std::array&lt;Index, parameters::nBmx&gt; li;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html#a12d5db2ee7d634a53d72ef30386356b7">   57</a></span>&#160;<span class="stringliteral">  std::array&lt;Index, parameters::nBmx&gt; lf;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bands.html#a7b2e3b8062db7db24ff14068d124eb4c">   58</a></span>&#160;<span class="stringliteral">  std::array&lt;String, parameters::nBmx&gt; BandFile;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a458eeea2a3577bbef9e69456ad118f73">   59</a></span>&#160;<span class="stringliteral">} Bands;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1LineSg.html">   61</a></span>&#160;<span class="stringliteral">struct LineSg {</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1LineSg.html#a497136fe2bf8655ce2d36ccc9920e63b">   62</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt;  Sig;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1LineSg.html#a43922addb2b12a62f08053c6e03b12bf">   63</a></span>&#160;<span class="stringliteral">  LineSg() : Sig(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#ad3629c06d87d051ee2a47ede4f40b5b2">   64</a></span>&#160;<span class="stringliteral">} LineSg;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DipoRigid.html">   66</a></span>&#160;<span class="stringliteral">struct DipoRigid {</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DipoRigid.html#a2e758ba3841fc019c4e3f141b72b3d31">   67</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; Dipo0;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DipoRigid.html#adb62e4bb84aa151d35e6be1e17e5f0b1">   68</a></span>&#160;<span class="stringliteral">  DipoRigid() : Dipo0(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a524c7281368cfaec6a1ecb8ff71b19ef">   69</a></span>&#160;<span class="stringliteral">} DipoRigid;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Energy.html">   71</a></span>&#160;<span class="stringliteral">struct Energy {</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Energy.html#a856aa529e28822f1b30e8072a7d56268">   72</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt;  E;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Energy.html#a2e85155d1e75a8f457fbcb2aa4001621">   73</a></span>&#160;<span class="stringliteral">  Energy() : E(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a1b1fb6c8e0c03cb303043580a42dbd81">   74</a></span>&#160;<span class="stringliteral">} Energy;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0AIR.html">   76</a></span>&#160;<span class="stringliteral">struct GamVT0AIR {</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0AIR.html#a374721db11cd8d2e71265dc8f64674db">   77</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; HWVT0AIR;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0AIR.html#a729e22f53f2bc1aba3524fa87f2be0c3">   78</a></span>&#160;<span class="stringliteral">  GamVT0AIR() : HWVT0AIR(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#ad2673efb1e21861bb194e774559e4207">   79</a></span>&#160;<span class="stringliteral">} GamVT0AIR;</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0AIR.html">   81</a></span>&#160;<span class="stringliteral">struct GamSDVT0AIR {</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0AIR.html#a34e2bfef49fa7bfa0866059e92557edf">   82</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; HWSDVT0AIR;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0AIR.html#aad4c0009cad276df96b249f257e70a90">   83</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; rHWT0AIR;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0AIR.html#a9738b31cf5da4c936bea24040fd920a9">   84</a></span>&#160;<span class="stringliteral">  GamSDVT0AIR() : HWSDVT0AIR(parameters::nLmx, parameters::nBmx), rHWT0AIR(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a9bcbea8efbd1c7d642ec39616a9e3a1e">   85</a></span>&#160;<span class="stringliteral">} GamSDVT0AIR;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMAIR.html">   87</a></span>&#160;<span class="stringliteral">struct DTGAMAIR {</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMAIR.html#a83770cb6e41e463b8127d22e0336c57f">   88</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; BHWAIR;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMAIR.html#ae27fbf24033144478f7364a75c00a028">   89</a></span>&#160;<span class="stringliteral">  DTGAMAIR() : BHWAIR(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a0caea53a4551dff215b96fa65441f383">   90</a></span>&#160;<span class="stringliteral">} DTGAMAIR;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0CO2.html">   92</a></span>&#160;<span class="stringliteral">struct GamVT0CO2 {</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0CO2.html#a494d1209dafc6f3d41b3ff1fee48fa87">   93</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; HWVT0SELF;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0CO2.html#acfc39dce5772f7986761cfd727cfa14e">   94</a></span>&#160;<span class="stringliteral">  GamVT0CO2() : HWVT0SELF(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a12d5837b750e61b66a89d127167b8cfa">   95</a></span>&#160;<span class="stringliteral">} GamVT0CO2;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0CO2.html">   97</a></span>&#160;<span class="stringliteral">struct GamSDVT0CO2 {</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0CO2.html#a51503f1bce59b4adb8a614915d838cd8">   98</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; HWSDVT0SELF;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0CO2.html#a1a0bf7b62f7bcf31e8b460f6afa3cf66">   99</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; rHWT0SELF;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0CO2.html#a005912eac9f611a8772f7670a7d37825">  100</a></span>&#160;<span class="stringliteral">  GamSDVT0CO2() : HWSDVT0SELF(parameters::nLmx, parameters::nBmx), rHWT0SELF(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a1bdfd09c2e6eca6f9ed67c37e8eb8126">  101</a></span>&#160;<span class="stringliteral">} GamSDVT0CO2;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMCO2.html">  103</a></span>&#160;<span class="stringliteral">struct DTGAMCO2 {</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMCO2.html#af092efea9991e77f50f694e7d6985701">  104</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; BHWSELF;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMCO2.html#ae5d422da72e48e629e8e2ba0cdeb0bea">  105</a></span>&#160;<span class="stringliteral">  DTGAMCO2() : BHWSELF(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a55c152cb7531c4e4e79b5969adbb0e46">  106</a></span>&#160;<span class="stringliteral">} DTGAMCO2;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0H2O.html">  108</a></span>&#160;<span class="stringliteral">struct GamVT0H2O {</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0H2O.html#a6c9289c8c23af10a683b8ea4632f78bc">  109</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; HWVT0H2O;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamVT0H2O.html#ac9c9b2aa8731b42f5a103812a5cff993">  110</a></span>&#160;<span class="stringliteral">  GamVT0H2O() : HWVT0H2O(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#ac78a3127708938f43234d84f0f916cd7">  111</a></span>&#160;<span class="stringliteral">} GamVT0H2O;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0H2O.html">  113</a></span>&#160;<span class="stringliteral">struct GamSDVT0H2O {</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0H2O.html#ab91cac5b077c3a1ba7b53e51c9177656">  114</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; HWSDVT0H2O;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0H2O.html#af5de50cafb057f8db1d397689ea6379e">  115</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; rHWT0H2O;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamSDVT0H2O.html#ae96eed8d8cf905e27cb5120af2075efd">  116</a></span>&#160;<span class="stringliteral">  GamSDVT0H2O() : HWSDVT0H2O(parameters::nLmx, parameters::nBmx), rHWT0H2O(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#ad4e3f942d6c62b2acd334c9e2ac7baa4">  117</a></span>&#160;<span class="stringliteral">} GamSDVT0H2O;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMH2O.html">  119</a></span>&#160;<span class="stringliteral">struct DTGAMH2O {</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMH2O.html#a9131435fe74a4ed5daf54ca3a9a97b51">  120</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; BHWH2O;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DTGAMH2O.html#a9a8ec127a16865c29b86c67611dd49d1">  121</a></span>&#160;<span class="stringliteral">  DTGAMH2O() : BHWH2O(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#ad2ba5ca54cf204703b2da17c55e69137">  122</a></span>&#160;<span class="stringliteral">} DTGAMH2O;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamT.html">  124</a></span>&#160;<span class="stringliteral">struct GamT {</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamT.html#a0d2057a03c8c7524ac9ff2f693aa6854">  125</a></span>&#160;<span class="stringliteral">  std::array&lt;Numeric, parameters::nLmx&gt; HWT;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1GamT.html#a0dca461e47d782ac68c6f9481bed9742">  126</a></span>&#160;<span class="stringliteral">  std::array&lt;Numeric, parameters::nLmx&gt; HWSDV2T;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a48d58b2ff54febf55dbd10d43e9f3606">  127</a></span>&#160;<span class="stringliteral">} GamT;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1SHIFT.html">  129</a></span>&#160;<span class="stringliteral">struct SHIFT {</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1SHIFT.html#a91f54ae567fd2fd4650ce3809c2d4ecd">  130</a></span>&#160;<span class="stringliteral">  std::array&lt;Numeric, parameters::nLmx&gt; shft;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a571c1cee717608436fefee292889c874">  131</a></span>&#160;<span class="stringliteral">} SHIFT;</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1SHIFT0.html">  133</a></span>&#160;<span class="stringliteral">struct SHIFT0 {</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1SHIFT0.html#ab9ac4c44ccaa6181c294e67419a75b5a">  134</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; shft0;</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1SHIFT0.html#ab5e8b0f623bb984938566bf6de9abbfd">  135</a></span>&#160;<span class="stringliteral">  SHIFT0() : shft0(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a4f2be8c588d12fcd9f4e9503eba5cb25">  136</a></span>&#160;<span class="stringliteral">} SHIFT0;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1PopuT.html">  138</a></span>&#160;<span class="stringliteral">struct PopuT {</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1PopuT.html#a03c8d26dc472637b56572452d72c94d7">  139</a></span>&#160;<span class="stringliteral">  std::array&lt;Numeric, parameters::nLmx&gt; PopuT;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#aee41dffe6e5f296f09de2878e7636efe">  140</a></span>&#160;<span class="stringliteral">} PopuT;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1PopTrf.html">  142</a></span>&#160;<span class="stringliteral">struct PopTrf {</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1PopTrf.html#a7de389cdb78195915b834db22ff301dc">  143</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; PopuT0;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1PopTrf.html#ab6da5ed170bde723be8b93df633889a1">  144</a></span>&#160;<span class="stringliteral">  PopTrf() : PopuT0(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a2c2144353a234ca02be7ecba9887889c">  145</a></span>&#160;<span class="stringliteral">} PopTrf;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DipoTcm.html">  147</a></span>&#160;<span class="stringliteral">struct DipoTcm {</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DipoTcm.html#a849c2149833d653dc0d45e25b1cfc5ae">  148</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; DipoT;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DipoTcm.html#ab602d04d16def08a955420d29b8b5f8c">  149</a></span>&#160;<span class="stringliteral">  DipoTcm() : DipoT(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a7078e3912a6b810d1cdf2fa7b69f11c2">  150</a></span>&#160;<span class="stringliteral">} DipoTcm;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Jiln.html">  152</a></span>&#160;<span class="stringliteral">struct Jiln {</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Jiln.html#a947f3e8aff0b9c43bee979470b236625">  153</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Index, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; Ji;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Jiln.html#a4722a38d4ac14c5aff4373fb9cedf8c8">  154</a></span>&#160;<span class="stringliteral">  Jiln() : Ji(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#afe6580d29e9f9703cd09a3bce0568db0">  155</a></span>&#160;<span class="stringliteral">} Jiln;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Jfln.html">  157</a></span>&#160;<span class="stringliteral">struct Jfln {</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Jfln.html#a765cfd3af0bd1e283d5477cc606d1f24">  158</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Index, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; Jf;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Jfln.html#aed7430f66f17c2e1c04cfa45f65a3ec1">  159</a></span>&#160;<span class="stringliteral">  Jfln() : Jf(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a7c8cf309964299f878fa6e21294ec93a">  160</a></span>&#160;<span class="stringliteral">} Jfln;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Zss.html">  162</a></span>&#160;<span class="stringliteral">struct Zss {</span></div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Zss.html#a272f578fa227d1307b198ce1c419889c">  163</a></span>&#160;<span class="stringliteral">  std::array&lt;Complex, parameters::nLmx&gt; ZS;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#abd256a5a70c19e202de900b1d6f93361">  164</a></span>&#160;<span class="stringliteral">} Zss;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Zaa.html">  166</a></span>&#160;<span class="stringliteral">struct Zaa {</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Zaa.html#a463061ff9a07c975fbc0615d27165eb7">  167</a></span>&#160;<span class="stringliteral">  ComplexVector ZA;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Zaa.html#a1bc9b527b4fbe186eb902a092878ac28">  168</a></span>&#160;<span class="stringliteral">  Zaa() noexcept : ZA(parameters::nLmx) {}</span></div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a06361006e97fd582914d2b3200dd1b5d">  169</a></span>&#160;<span class="stringliteral">} Zaa;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wmatrix.html">  171</a></span>&#160;<span class="stringliteral">struct Wmatrix {</span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wmatrix.html#afebf460e7701c28e8ba20357674bc799">  172</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; W;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wmatrix.html#a5198afdf44b99fd6e5bdcbfc4c4b7340">  173</a></span>&#160;<span class="stringliteral">  Wmatrix() : W(parameters::nLmx, parameters::nLmx) {};</span></div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a5bfed6c224c59c19e65b060071748f2e">  174</a></span>&#160;<span class="stringliteral">} Wmatrix;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedp.html">  176</a></span>&#160;<span class="stringliteral">struct Wfittedp {</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedp.html#acffaf587c084c94e763ff649aa39b3ee">  177</a></span>&#160;<span class="stringliteral">  Tensor4 W0pp;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedp.html#af7396bbd5834e9210ffe193fc7742af7">  178</a></span>&#160;<span class="stringliteral">  Tensor4 W0pq;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedp.html#ab25b3c415376e14683ed2f1c07f102d4">  179</a></span>&#160;<span class="stringliteral">  Tensor4 W0pr;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedp.html#a4bbb14b330346a80a2ff691b4d578d4e">  180</a></span>&#160;<span class="stringliteral">  Wfittedp() :</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="stringliteral">  W0pp(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="stringliteral">  W0pq(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="stringliteral">  W0pr(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax) {}</span></div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a0d8004453fb7f7cf0f1086a85c1b0f68">  184</a></span>&#160;<span class="stringliteral">} Wfittedp;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedq.html">  186</a></span>&#160;<span class="stringliteral">struct Wfittedq {</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedq.html#a3c506c0d5d43fecd8b360c31a9c50ca6">  187</a></span>&#160;<span class="stringliteral">  Tensor4 W0qp;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedq.html#aa22bf18f9b3dfa10083a071c6379c2c0">  188</a></span>&#160;<span class="stringliteral">  Tensor4 W0qq;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedq.html#a1b5cde3e4b4f974ee3b83de938d1ce95">  189</a></span>&#160;<span class="stringliteral">  Tensor4 W0qr;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedq.html#a449bc69ba2f648eb70c134bda4422a2d">  190</a></span>&#160;<span class="stringliteral">  Wfittedq() :</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="stringliteral">  W0qp(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="stringliteral">  W0qq(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="stringliteral">  W0qr(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax) {}</span></div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a3bfdebb706e631be20857ed7828ca2c5">  194</a></span>&#160;<span class="stringliteral">} Wfittedq;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedr.html">  196</a></span>&#160;<span class="stringliteral">struct Wfittedr {</span></div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedr.html#a081791794cda53ea2b3bb20997e39de1">  197</a></span>&#160;<span class="stringliteral">  Tensor4 W0rp;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedr.html#aca64038af20b2988924f527e23eeeba8">  198</a></span>&#160;<span class="stringliteral">  Tensor4 W0rq;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedr.html#ac13fdab02b257ee6a4bf0c55d29bb42d">  199</a></span>&#160;<span class="stringliteral">  Tensor4 W0rr;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Wfittedr.html#abcdb3d7b0309185e61e4dec72616c707">  200</a></span>&#160;<span class="stringliteral">  Wfittedr() :</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="stringliteral">  W0rp(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="stringliteral">  W0rq(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="stringliteral">  W0rr(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax) {}</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a1f77a633e3ea183a63db8a154be921ab">  204</a></span>&#160;<span class="stringliteral">} Wfittedr;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedp.html">  206</a></span>&#160;<span class="stringliteral">struct Bfittedp {</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedp.html#ace13ffe49f3b1d1ff827028becb6d37a">  207</a></span>&#160;<span class="stringliteral">  Tensor4 B0pp;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedp.html#a1156bbc6976106085291c8c19f666f3a">  208</a></span>&#160;<span class="stringliteral">  Tensor4 B0pq;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedp.html#a8d6bf54fc04ed513107a4f42fd99280a">  209</a></span>&#160;<span class="stringliteral">  Tensor4 B0pr;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedp.html#a9b70e9909d8cd6ba1f4f25337b6fa68e">  210</a></span>&#160;<span class="stringliteral">  Bfittedp() :</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral">  B0pp(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral">  B0pq(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="stringliteral">  B0pr(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax) {}</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#aaebce9d9996542308ef444e76ac119cf">  214</a></span>&#160;<span class="stringliteral">} Bfittedp;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedq.html">  216</a></span>&#160;<span class="stringliteral">struct Bfittedq {</span></div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedq.html#ab0c6f74bd370312f1168fd3c0945d1fa">  217</a></span>&#160;<span class="stringliteral">  Tensor4 B0qp;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedq.html#a4347c51fabbf6f9888a6c93ae1d76d92">  218</a></span>&#160;<span class="stringliteral">  Tensor4 B0qq;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedq.html#a6c86d81c3f759642331887d9e10eb494">  219</a></span>&#160;<span class="stringliteral">  Tensor4 B0qr;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedq.html#ab8ede08649a4fa14514074ed93030eb8">  220</a></span>&#160;<span class="stringliteral">  Bfittedq() :</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral">  B0qp(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral">  B0qq(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">  B0qr(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax) {}</span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a28c76148fc336616d75d68583b15bb35">  224</a></span>&#160;<span class="stringliteral">} Bfittedq;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedr.html">  226</a></span>&#160;<span class="stringliteral">struct Bfittedr {</span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedr.html#a3aa6d464a78f76d8538905e23c8ad4c0">  227</a></span>&#160;<span class="stringliteral">  Tensor4 B0rp;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedr.html#a836d0b60cdcc4ff120cd725862615aa0">  228</a></span>&#160;<span class="stringliteral">  Tensor4 B0rq;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedr.html#a01109afb7d8853337482a9f47b92027c">  229</a></span>&#160;<span class="stringliteral">  Tensor4 B0rr;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1Bfittedr.html#a9ca51b6b3a49cf334a18943e1cbb0d4b">  230</a></span>&#160;<span class="stringliteral">  Bfittedr() :</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="stringliteral">  B0rp(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="stringliteral">  B0rq(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax),</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="stringliteral">  B0rr(parameters::Nlifmax, parameters::Nlifmax, parameters::Jmax, parameters::Jmax) {}</span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a2ffb24d36367ec91cef3535edea39818">  234</a></span>&#160;<span class="stringliteral">} Bfittedr;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DiagnR.html">  236</a></span>&#160;<span class="stringliteral">struct DiagnR {</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DiagnR.html#ac1f330d2a7596ff00865c5a1e4607aa4">  237</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; OpR;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DiagnR.html#ae307242e1f3da33f01ae0b5738fac6b2">  238</a></span>&#160;<span class="stringliteral">  DiagnR() : OpR(parameters::nLmx, parameters::nLmx) {};</span></div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#aa0a5c17756b1713a1f270828df024ee0">  239</a></span>&#160;<span class="stringliteral">} DiagnR;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DiagnI.html">  241</a></span>&#160;<span class="stringliteral">struct DiagnI {</span></div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DiagnI.html#afe013d24dd6f95a98bf99af249adc431">  242</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; OpI;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1DiagnI.html#a01501eebdf9d2f424ea0402787894ed4">  243</a></span>&#160;<span class="stringliteral">  DiagnI() : OpI(parameters::nLmx, parameters::nLmx) {};</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a60206ed3a1b9ff078055e0d8e84ff35f">  244</a></span>&#160;<span class="stringliteral">} DiagnI;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1YLT.html">  246</a></span>&#160;<span class="stringliteral">struct YLT {</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1YLT.html#a34e7181680ccdee8042e00ba3e6f5984">  247</a></span>&#160;<span class="stringliteral">  std::array&lt;Numeric, parameters::nLmx&gt; YT;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a3ccc84739d7d3eb9e93095109b6be5c5">  248</a></span>&#160;<span class="stringliteral">} YLT;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html">  250</a></span>&#160;<span class="stringliteral">struct UnusedBandParams {</span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#ab6d9b8d9be958c8fea5029d27be77e33">  251</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; intens;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#acba55cb70c2201544eb99125230fa836">  252</a></span>&#160;<span class="stringliteral">  Eigen::Matrix&lt;Numeric, Eigen::Dynamic, Eigen::Dynamic, Eigen::ColMajor&gt; eina;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#a67aba6786f666d1d26b86d6d470ae536">  253</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; iv1;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#a69c504917eed90b9384ed0e77f920eff">  254</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; iv2;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#ae2ed9796b1822dac39a3199730f08cb7">  255</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; il2;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#aac02ff1b0d7bb02be2cbae16d7655d4d">  256</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; iv3;</span></div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#a76be081973260761a0e02e115e961aea">  257</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; ir;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#a2eb3070265c74048cdf1d502c1319d5a">  258</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; fv1;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#aa27e15c1ae5cd67f1cea41f3a5c01531">  259</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; fv2;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#a2bf8ce15c8c2af4d9632f8642f097425">  260</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; fl2;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#ac43b3b95f816db77cbb2c3f681c86ba7">  261</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; fv3;</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#ac128c09680c5d59055805e1d1308b849">  262</a></span>&#160;<span class="stringliteral">  std::array&lt;Rational, parameters::nBmx&gt; fr;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock_1_1UnusedBandParams.html#aa5bff4d7336a19c0e71f3427f398da5b">  263</a></span>&#160;<span class="stringliteral">  UnusedBandParams() :</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral">  intens(parameters::nLmx, parameters::nBmx),</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="stringliteral">  eina(parameters::nLmx, parameters::nBmx) {};</span></div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1CommonBlock.html#a62f3a18cee961db210af9639e51f0917">  266</a></span>&#160;<span class="stringliteral">} UnusedBandParams;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="stringliteral">};  // CommonBlock</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a724a8c1d3d4e8c9262e112a4854562b7">  269</a></span>&#160;<span class="stringliteral">Rational toRationalSum(char a, char b=&#39;</span> <span class="stringliteral">&#39;)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">  if (b == &#39;</span> <span class="stringliteral">&#39; and a == &#39;</span> <span class="stringliteral">&#39;)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral">    return Rational();</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">  else if (b == &#39;</span> <span class="stringliteral">&#39;)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="stringliteral">    return Rational(a-&#39;</span>0<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="stringliteral">  else if (a == &#39;</span> <span class="stringliteral">&#39;)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="stringliteral">    return Rational(b-&#39;</span>0<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="stringliteral">  else</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="stringliteral">    return Rational(10*(a-&#39;</span>0<span class="stringliteral">&#39;) + b-&#39;</span>0<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a962a9ed8dbc5139ca747400f683508ae">  281</a></span>&#160;<span class="stringliteral">void readlines(CommonBlock&amp; cmn, const String&amp; basedir=&quot;data_new/&quot;)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="stringliteral">  if (cmn.Bands.nBand &gt; parameters::nBmx)</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="stringliteral">    throw std::runtime_error(&quot;Too many bands&quot;);</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="stringliteral">  for (Index iband=0; iband&lt;cmn.Bands.nBand; iband++) {</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="stringliteral">    std::ifstream fortranfile;</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">    const String fname = basedir + String(&quot;/&quot;) + cmn.Bands.BandFile[iband] + String(&quot;.dat&quot;);</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">    fortranfile.open(fname.c_str());</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral">    if (fortranfile.is_open()) {</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="stringliteral">      String line;</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="stringliteral">      getline(fortranfile, line);</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="stringliteral">      Index nliner=0;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="stringliteral">      while (fortranfile.good()) {</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="stringliteral">        if (nliner &gt;= parameters::nLmx)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="stringliteral">          throw std::runtime_error(&quot;Too many lines&quot;);</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="stringliteral">        char tpline, x;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="stringliteral">        char sDipoRigid[21], sPopTrf[21];</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="stringliteral">        char iv11, iv12, iv21, iv22, il21, il22, iv31, iv32, ir1, fv11, fv12, fv21, fv22, fl21, fl22, fv31, fv32, fr1;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="stringliteral">        sscanf(line.c_str(), </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="stringliteral">               &quot;%c%c&quot; &quot;%1ld&quot; &quot;%12lf&quot; &quot;%10lf&quot;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="stringliteral">               &quot;%10lf&quot; &quot;%5lf&quot; &quot;%5lf&quot; &quot;%4lf&quot;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="stringliteral">               &quot;%5lf&quot; &quot;%5lf&quot; &quot;%4lf&quot; &quot;%10lf&quot;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="stringliteral">               &quot;%4lf&quot; &quot;%4lf&quot; &quot;%8lf&quot; </span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="stringliteral">               &quot;%c%c%c%c%c%c&quot;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="stringliteral">               &quot;%c%c&quot; &quot;%c%c&quot; &quot;%c%c&quot; &quot;%c%c&quot; &quot;%c&quot;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="stringliteral">               &quot;%c%c%c%c%c%c&quot;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="stringliteral">               &quot;%c%c&quot; &quot;%c%c&quot; &quot;%c%c&quot; &quot;%c%c&quot; &quot;%c&quot;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="stringliteral">               &quot;%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c&quot;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="stringliteral">               &quot;%c&quot; &quot;%3ld&quot; &quot;%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c&quot;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="stringliteral">               &quot;%5lf&quot; &quot;%5lf&quot; &quot;%4lf&quot; &quot;%5lf&quot;</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="stringliteral">               &quot;%20s&quot; &quot;%20s&quot;,</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral">               &amp;x,&amp;x,</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="stringliteral">               &amp;cmn.Bands.Isot[iband],</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="stringliteral">               &amp;cmn.LineSg.Sig(nliner, iband),</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="stringliteral">               &amp;cmn.UnusedBandParams.intens(nliner, iband),</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="stringliteral">               &amp;cmn.UnusedBandParams.eina(nliner, iband),</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="stringliteral">               &amp;cmn.GamVT0AIR.HWVT0AIR(nliner, iband),</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="stringliteral">               &amp;cmn.GamSDVT0AIR.HWSDVT0AIR(nliner, iband),</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="stringliteral">               &amp;cmn.GamSDVT0AIR.rHWT0AIR(nliner, iband),</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="stringliteral">               &amp;cmn.GamVT0CO2.HWVT0SELF(nliner, iband),</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="stringliteral">               &amp;cmn.GamSDVT0CO2.HWSDVT0SELF(nliner, iband),</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="stringliteral">               &amp;cmn.GamSDVT0CO2.rHWT0SELF(nliner, iband),</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="stringliteral">               &amp;cmn.Energy.E(nliner, iband),</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="stringliteral">               &amp;cmn.DTGAMAIR.BHWAIR(nliner, iband),</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="stringliteral">               &amp;cmn.DTGAMCO2.BHWSELF(nliner, iband),</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="stringliteral">               &amp;cmn.SHIFT0.shft0(nliner, iband),</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="stringliteral">               &amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="stringliteral">               &amp;iv11, &amp;iv12, &amp;iv21, &amp;iv22, &amp;il21, &amp;il22, &amp;iv31, &amp;iv32, &amp;ir1,  &amp;fv32, &amp;fr1,</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="stringliteral">               &amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="stringliteral">               &amp;fv11, &amp;fv12, &amp;fv21, &amp;fv22, &amp;fl21, &amp;fl22, &amp;fv31,</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="stringliteral">               &amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="stringliteral">               &amp;tpline,</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="stringliteral">               &amp;cmn.Jiln.Ji(nliner, iband),</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="stringliteral">               &amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,&amp;x,</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="stringliteral">               &amp;cmn.GamVT0H2O.HWVT0H2O(nliner, iband),</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="stringliteral">               &amp;cmn.GamSDVT0H2O.HWSDVT0H2O(nliner, iband),</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="stringliteral">               &amp;cmn.GamSDVT0H2O.rHWT0H2O(nliner, iband),</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="stringliteral">               &amp;cmn.DTGAMH2O.BHWH2O(nliner, iband),</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="stringliteral">               sDipoRigid,</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral">               sPopTrf);</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="stringliteral">        getline(fortranfile, line);</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral">        if (nliner==0) {</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.iv1[iband]=Rational(toRationalSum(iv11, iv12));</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.iv2[iband]=Rational(toRationalSum(iv21, iv22));</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.il2[iband]=Rational(toRationalSum(il21, il22));</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.iv3[iband]=Rational(toRationalSum(iv31, iv32));</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.ir[iband]=Rational(toRationalSum(ir1));</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fv1[iband]=Rational(toRationalSum(fv11, fv12));</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fv2[iband]=Rational(toRationalSum(fv21, fv22));</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fl2[iband]=Rational(toRationalSum(fl21, fl22));</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fv3[iband]=Rational(toRationalSum(fv31, fv32));</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fr[iband]=Rational(toRationalSum(fr1));</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="stringliteral">        } else if(not (</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.iv1[iband]==Rational(toRationalSum(iv11, iv12)) and</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.iv2[iband]==Rational(toRationalSum(iv21, iv22)) and</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.il2[iband]==Rational(toRationalSum(il21, il22)) and</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.iv3[iband]==Rational(toRationalSum(iv31, iv32)) and</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.ir[iband]==Rational(toRationalSum(ir1)) and</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fv1[iband]==Rational(toRationalSum(fv11, fv12)) and</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fv2[iband]==Rational(toRationalSum(fv21, fv22)) and</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fl2[iband]==Rational(toRationalSum(fl21, fl22)) and</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fv3[iband]==Rational(toRationalSum(fv31, fv32)) and</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">          cmn.UnusedBandParams.fr[iband]==Rational(toRationalSum(fr1)))) {</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="stringliteral">          throw std::runtime_error(&quot;Bad read, bands do not have the same global quantum numbers...&quot;);</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="stringliteral">        // Fix...</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="stringliteral">        String ssDipoRigid = sDipoRigid;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="stringliteral">        String ssPopTrf = sPopTrf;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="stringliteral">        std::replace(ssDipoRigid.begin(), ssDipoRigid.end(), &#39;</span>D<span class="stringliteral">&#39;, &#39;</span>E<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral">        std::replace(ssPopTrf.begin(), ssPopTrf.end(), &#39;</span>D<span class="stringliteral">&#39;, &#39;</span>E<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="stringliteral">        cmn.DipoRigid.Dipo0(nliner, iband) = std::stod(ssDipoRigid);</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="stringliteral">        cmn.PopTrf.PopuT0(nliner, iband) = std::stod(ssPopTrf);</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="stringliteral">        // Dipole at temperature</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="stringliteral">        cmn.DipoTcm.DipoT(nliner, iband) = std::sqrt(cmn.UnusedBandParams.intens(nliner, iband)/(cmn.PopTrf.PopuT0(nliner,iband) * cmn.LineSg.Sig(nliner,iband) * (1-std::exp(-1.4388*cmn.LineSg.Sig(nliner,iband)/296))));</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="stringliteral">        // Fix Js</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="stringliteral">        if (tpline == &#39;</span>P<span class="stringliteral">&#39;)</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="stringliteral">          cmn.Jfln.Jf(nliner, iband) = cmn.Jiln.Ji(nliner, iband) - 1;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">        else if (tpline == &#39;</span>Q<span class="stringliteral">&#39;)</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">          cmn.Jfln.Jf(nliner, iband) = cmn.Jiln.Ji(nliner, iband);</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="stringliteral">        else</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="stringliteral">          cmn.Jfln.Jf(nliner, iband) = cmn.Jiln.Ji(nliner, iband) + 1;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="stringliteral">        // Fix isotologue</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral">        if (cmn.Bands.Isot[iband] == 0)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral">          cmn.Bands.Isot[iband] = 10;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="stringliteral">        nliner++;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="stringliteral">      cmn.Bands.nLines[iband] = nliner;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="stringliteral">    fortranfile.close();</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="stringliteral">template&lt;size_t NT&gt;</span></div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a72a2dff18c71ce2c0c7e2fb5c800adf3">  406</a></span>&#160;<span class="stringliteral">Numeric atob(const Numeric&amp; aa,</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="stringliteral">             const std::array&lt;Numeric, NT&gt;&amp; a,</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="stringliteral">             const std::array&lt;Numeric, NT&gt;&amp; b)</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="stringliteral">{ </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="stringliteral">  for (size_t i=1; i&lt;NT; i++) {</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="stringliteral">    if (a[i] &gt;= aa) {</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="stringliteral">      if (i &lt; 2 or i == NT) {</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="stringliteral">        size_t j=i;</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="stringliteral">        if (i &lt; 2)</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="stringliteral">          j = 2;</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="stringliteral">        if (i == NT-1)</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="stringliteral">          j = NT-1;</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="stringliteral">        Numeric A0D1=a[j-2]-a[j-1]; if (A0D1 == 0) A0D1=0.0001;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="stringliteral">        Numeric A0D2=a[j-2]-a[j];   if (A0D2 == 0) A0D2=0.0001;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="stringliteral">        Numeric A1D1=a[j-1]-a[j-2]; if (A1D1 == 0) A1D1=0.0001;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="stringliteral">        Numeric A1D2=a[j-1]-a[j];   if (A1D2 == 0) A1D2=0.0001;</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="stringliteral">        Numeric A2D1=a[j]-a[j-2];   if (A2D1 == 0) A2D1=0.0001;</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="stringliteral">        Numeric A2D2=a[j]-a[j-1];   if (A2D2 == 0) A2D2=0.0001;</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="stringliteral">        const Numeric A0=(aa-a[j-1])*(aa-a[j])/(A0D1*A0D2);</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="stringliteral">        const Numeric A1=(aa-a[j-2])*(aa-a[j])/(A1D1*A1D2);</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="stringliteral">        const Numeric A2=(aa-a[j-2])*(aa-a[j-1])/(A2D1*A2D2);</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="stringliteral">        return A0*b[j-2] + A1*b[j-1] + A2*b[j];</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="stringliteral">      } else {</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="stringliteral">        size_t j = i;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="stringliteral">        Numeric A0D1=a[j-2]-a[j-1]; if (A0D1 == 0) A0D1=0.0001;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="stringliteral">        Numeric A0D2=a[j-2]-a[j];   if (A0D2 == 0) A0D2=0.0001;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="stringliteral">        Numeric A0D3=a[j-2]-a[j+1]; if (A0D3 == 0) A0D3=0.0001;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="stringliteral">        Numeric A1D1=a[j-1]-a[j-2]; if (A1D1 == 0) A1D1=0.0001;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="stringliteral">        Numeric A1D2=a[j-1]-a[j];   if (A1D2 == 0) A1D2=0.0001;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="stringliteral">        Numeric A1D3=a[j-1]-a[j+1]; if (A1D3 == 0) A1D3=0.0001;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="stringliteral">        Numeric A2D1=a[j]-a[j-2];   if (A2D1 == 0) A2D1=0.0001;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="stringliteral">        Numeric A2D2=a[j]-a[j-1];   if (A2D2 == 0) A2D2=0.0001;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="stringliteral">        Numeric A2D3=a[j]-a[j+1];   if (A2D3 == 0) A2D3=0.0001;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="stringliteral">        Numeric A3D1=a[j+1]-a[j-2]; if (A3D1 == 0) A3D1=0.0001;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="stringliteral">        Numeric A3D2=a[j+1]-a[j-1]; if (A3D2 == 0) A3D2=0.0001;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="stringliteral">        Numeric A3D3=a[j+1]-a[j];   if (A3D3 == 0) A3D3=0.0001;</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="stringliteral">        Numeric A0=(aa-a[j-1])*(aa-a[j])*(aa-a[j+1]);</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="stringliteral">        A0=A0/(A0D1*A0D2*A0D3);</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="stringliteral">        Numeric A1=(aa-a[j-2])*(aa-a[j])*(aa-a[j+1]);</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="stringliteral">        A1=A1/(A1D1*A1D2*A1D3);</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="stringliteral">        Numeric A2=(aa-a[j-2])*(aa-a[j-1])*(aa-a[j+1]);</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="stringliteral">        A2=A2/(A2D1*A2D2*A2D3);</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="stringliteral">        Numeric A3=(aa-a[j-2])*(aa-a[j-1])*(aa-a[j]);</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="stringliteral">        A3=A3/(A3D1*A3D2*A3D3);</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="stringliteral">        return A0*b[j-2] + A1*b[j-1] + A2*b[j] + A3*b[j+1];</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="stringliteral">  return std::numeric_limits&lt;Numeric&gt;::quiet_NaN();</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a44b65b81b21aafe3c39ae05d32ea99c6">  466</a></span>&#160;<span class="stringliteral">void qt_co2(const Numeric&amp; t,</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="stringliteral">            const Index&amp; iso,</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="stringliteral">            Numeric&amp; gsi,</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral">            Numeric&amp; qt)</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral">  constexpr auto xgj = stdarrayify(1.,2.,1.,6.,2.,12.,1.,6.,1.,2.,12.);</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="stringliteral">  constexpr auto tdat = stdarrayify(60.,  85., 110., 135., 160., 185., 210., 235.,</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="stringliteral">                                    260., 285., 310., 335., 360., 385., 410., 435., 460., 485.,</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="stringliteral">                                    510., 535., 560., 585., 610., 635., 660., 685., 710., 735.,</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="stringliteral">                                    760., 785., 810., 835., 860., 885., 910., 935., 960., 985.,</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="stringliteral">                                    1010.,1035.,1060.,1085.,1110.,1135.,1160.,1185.,1210.,1235.,</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral">                                    1260.,1285.,1310.,1335.,1360.,1385.,1410.,1435.,1460.,1485.,</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral">                                    1510.,1535.,1560.,1585.,1610.,1635.,1660.,1685.,1710.,1735.,</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral">                                    1760.,1785.,1810.,1835.,1860.,1885.,1910.,1935.,1960.,1985.,</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="stringliteral">                                    2010.,2035.,2060.,2085.,2110.,2135.,2160.,2185.,2210.,2235.,</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="stringliteral">                                    2260.,2285.,2310.,2335.,2360.,2385.,2410.,2435.,2460.,2485.,</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="stringliteral">                                    2510.,2535.,2560.,2585.,2610.,2635.,2660.,2685.,2710.,2735.,</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="stringliteral">                                    2760.,2785.,2810.,2835.,2860.,2885.,2910.,2935.,2960.,2985.,</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="stringliteral">                                    3010.);</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="stringliteral">  constexpr auto qoft = stdarrayify(</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="stringliteral">// c...        --       626</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="stringliteral">      stdarrayify( 0.53642E+02, 0.75947E+02, 0.98292E+02,</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">     + 0.12078E+03, 0.14364E+03, 0.16714E+03, 0.19160E+03, 0.21731E+03,</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral">     + 0.24454E+03, 0.27355E+03, 0.30456E+03, 0.33778E+03, 0.37343E+03,</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">     + 0.41170E+03, 0.45280E+03, 0.49692E+03, 0.54427E+03, 0.59505E+03,</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">     + 0.64948E+03, 0.70779E+03, 0.77019E+03, 0.83693E+03, 0.90825E+03,</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral">     + 0.98440E+03, 0.10656E+04, 0.11522E+04, 0.12445E+04, 0.13427E+04,</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="stringliteral">     + 0.14471E+04, 0.15580E+04, 0.16759E+04, 0.18009E+04, 0.19334E+04,</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="stringliteral">     + 0.20739E+04, 0.22225E+04, 0.23798E+04, 0.25462E+04, 0.27219E+04,</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="stringliteral">     + 0.29074E+04, 0.31032E+04, 0.33097E+04, 0.35272E+04, 0.37564E+04,</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="stringliteral">     + 0.39976E+04, 0.42514E+04, 0.45181E+04, 0.47985E+04, 0.50929E+04,</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral">     + 0.54019E+04, 0.57260E+04, 0.60659E+04, 0.64221E+04, 0.67952E+04,</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="stringliteral">     + 0.71859E+04, 0.75946E+04, 0.80222E+04, 0.84691E+04, 0.89362E+04,</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral">     + 0.94241E+04, 0.99335E+04, 0.10465E+05, 0.11020E+05, 0.11598E+05,</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral">     + 0.12201E+05, 0.12828E+05, 0.13482E+05, 0.14163E+05, 0.14872E+05,</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="stringliteral">     + 0.15609E+05, 0.16376E+05, 0.17173E+05, 0.18001E+05, 0.18861E+05,</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">     + 0.19754E+05, 0.20682E+05, 0.21644E+05, 0.22643E+05, 0.23678E+05,</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">     + 0.24752E+05, 0.25865E+05, 0.27018E+05, 0.28212E+05, 0.29449E+05,</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral">     + 0.30730E+05, 0.32055E+05, 0.33426E+05, 0.34845E+05, 0.36312E+05,</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">     + 0.37828E+05, 0.39395E+05, 0.41015E+05, 0.42688E+05, 0.44416E+05,</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">     + 0.46199E+05, 0.48041E+05, 0.49942E+05, 0.51902E+05, 0.53925E+05,</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral">     + 0.56011E+05, 0.58162E+05, 0.60379E+05, 0.62664E+05, 0.65019E+05,</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral">     + 0.67444E+05, 0.69942E+05, 0.72515E+05, 0.75163E+05, 0.77890E+05,</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">     + 0.80695E+05, 0.83582E+05, 0.86551E+05, 0.89605E+05, 0.92746E+05,</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral">     + 0.95975E+05, 0.99294E+05, 0.10271E+06, 0.10621E+06, 0.10981E+06,</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">     + 0.11351E+06),</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral">// c...        --       636</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">      stdarrayify( 0.10728E+03, 0.15189E+03, 0.19659E+03,</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">     + 0.24164E+03, 0.28753E+03, 0.33486E+03, 0.38429E+03, 0.43643E+03,</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral">     + 0.49184E+03, 0.55104E+03, 0.61449E+03, 0.68263E+03, 0.75589E+03,</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral">     + 0.83468E+03, 0.91943E+03, 0.10106E+04, 0.11085E+04, 0.12137E+04,</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="stringliteral">     + 0.13266E+04, 0.14477E+04, 0.15774E+04, 0.17163E+04, 0.18649E+04,</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="stringliteral">     + 0.20237E+04, 0.21933E+04, 0.23743E+04, 0.25673E+04, 0.27729E+04,</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="stringliteral">     + 0.29917E+04, 0.32245E+04, 0.34718E+04, 0.37345E+04, 0.40132E+04,</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="stringliteral">     + 0.43087E+04, 0.46218E+04, 0.49533E+04, 0.53041E+04, 0.56749E+04,</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="stringliteral">     + 0.60668E+04, 0.64805E+04, 0.69171E+04, 0.73774E+04, 0.78626E+04,</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="stringliteral">     + 0.83736E+04, 0.89114E+04, 0.94772E+04, 0.10072E+05, 0.10697E+05,</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="stringliteral">     + 0.11353E+05, 0.12042E+05, 0.12765E+05, 0.13523E+05, 0.14317E+05,</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="stringliteral">     + 0.15148E+05, 0.16019E+05, 0.16930E+05, 0.17883E+05, 0.18879E+05,</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="stringliteral">     + 0.19920E+05, 0.21008E+05, 0.22143E+05, 0.23328E+05, 0.24563E+05,</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="stringliteral">     + 0.25852E+05, 0.27195E+05, 0.28594E+05, 0.30051E+05, 0.31568E+05,</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="stringliteral">     + 0.33146E+05, 0.34788E+05, 0.36496E+05, 0.38271E+05, 0.40115E+05,</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="stringliteral">     + 0.42031E+05, 0.44021E+05, 0.46086E+05, 0.48230E+05, 0.50453E+05,</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="stringliteral">     + 0.52759E+05, 0.55150E+05, 0.57628E+05, 0.60195E+05, 0.62854E+05,</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="stringliteral">     + 0.65608E+05, 0.68459E+05, 0.71409E+05, 0.74461E+05, 0.77618E+05,</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="stringliteral">     + 0.80883E+05, 0.84258E+05, 0.87746E+05, 0.91350E+05, 0.95073E+05,</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="stringliteral">     + 0.98918E+05, 0.10289E+06, 0.10698E+06, 0.11121E+06, 0.11558E+06,</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="stringliteral">     + 0.12008E+06, 0.12472E+06, 0.12950E+06, 0.13443E+06, 0.13952E+06,</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="stringliteral">     + 0.14475E+06, 0.15015E+06, 0.15571E+06, 0.16143E+06, 0.16732E+06,</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="stringliteral">     + 0.17338E+06, 0.17962E+06, 0.18604E+06, 0.19264E+06, 0.19943E+06,</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="stringliteral">     + 0.20642E+06, 0.21360E+06, 0.22098E+06, 0.22856E+06, 0.23636E+06,</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="stringliteral">     + 0.24436E+06),</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="stringliteral">// c...        --       628</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="stringliteral">      stdarrayify( 0.11368E+03, 0.16096E+03, 0.20833E+03,</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="stringliteral">     + 0.25603E+03, 0.30452E+03, 0.35442E+03, 0.40640E+03, 0.46110E+03,</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="stringliteral">     + 0.51910E+03, 0.58093E+03, 0.64709E+03, 0.71804E+03, 0.79422E+03,</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="stringliteral">     + 0.87607E+03, 0.96402E+03, 0.10585E+04, 0.11600E+04, 0.12689E+04,</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="stringliteral">     + 0.13857E+04, 0.15108E+04, 0.16449E+04, 0.17883E+04, 0.19416E+04,</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="stringliteral">     + 0.21054E+04, 0.22803E+04, 0.24668E+04, 0.26655E+04, 0.28770E+04,</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="stringliteral">     + 0.31021E+04, 0.33414E+04, 0.35956E+04, 0.38654E+04, 0.41516E+04,</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="stringliteral">     + 0.44549E+04, 0.47761E+04, 0.51160E+04, 0.54755E+04, 0.58555E+04,</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="stringliteral">     + 0.62568E+04, 0.66804E+04, 0.71273E+04, 0.75982E+04, 0.80944E+04,</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="stringliteral">     + 0.86169E+04, 0.91666E+04, 0.97446E+04, 0.10352E+05, 0.10990E+05,</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="stringliteral">     + 0.11660E+05, 0.12363E+05, 0.13101E+05, 0.13874E+05, 0.14683E+05,</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="stringliteral">     + 0.15531E+05, 0.16418E+05, 0.17347E+05, 0.18317E+05, 0.19332E+05,</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="stringliteral">     + 0.20392E+05, 0.21499E+05, 0.22654E+05, 0.23859E+05, 0.25116E+05,</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="stringliteral">     + 0.26426E+05, 0.27792E+05, 0.29214E+05, 0.30695E+05, 0.32236E+05,</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="stringliteral">     + 0.33840E+05, 0.35508E+05, 0.37242E+05, 0.39045E+05, 0.40917E+05,</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="stringliteral">     + 0.42862E+05, 0.44881E+05, 0.46977E+05, 0.49152E+05, 0.51407E+05,</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="stringliteral">     + 0.53746E+05, 0.56171E+05, 0.58683E+05, 0.61286E+05, 0.63981E+05,</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="stringliteral">     + 0.66772E+05, 0.69661E+05, 0.72650E+05, 0.75742E+05, 0.78940E+05,</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="stringliteral">     + 0.82246E+05, 0.85664E+05, 0.89196E+05, 0.92845E+05, 0.96613E+05,</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="stringliteral">     + 0.10050E+06, 0.10452E+06, 0.10867E+06, 0.11295E+06, 0.11736E+06,</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">     + 0.12191E+06, 0.12661E+06, 0.13145E+06, 0.13643E+06, 0.14157E+06,</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral">     + 0.14687E+06, 0.15232E+06, 0.15794E+06, 0.16372E+06, 0.16968E+06,</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">     + 0.17580E+06, 0.18211E+06, 0.18859E+06, 0.19526E+06, 0.20213E+06,</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">     + 0.20918E+06, 0.21643E+06, 0.22388E+06, 0.23154E+06, 0.23941E+06,</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">     + 0.24750E+06),</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">// c...        --       627</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">      stdarrayify( 0.66338E+03, 0.93923E+03, 0.12156E+04,</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">     + 0.14938E+04, 0.17766E+04, 0.20676E+04, 0.23705E+04, 0.26891E+04,</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">     + 0.30267E+04, 0.33866E+04, 0.37714E+04, 0.41839E+04, 0.46267E+04,</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">     + 0.51023E+04, 0.56132E+04, 0.61618E+04, 0.67508E+04, 0.73827E+04,</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">     + 0.80603E+04, 0.87863E+04, 0.95636E+04, 0.10395E+05, 0.11284E+05,</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">     + 0.12233E+05, 0.13246E+05, 0.14326E+05, 0.15477E+05, 0.16702E+05,</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">     + 0.18005E+05, 0.19390E+05, 0.20861E+05, 0.22422E+05, 0.24077E+05,</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">     + 0.25832E+05, 0.27689E+05, 0.29655E+05, 0.31734E+05, 0.33931E+05,</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">     + 0.36250E+05, 0.38698E+05, 0.41280E+05, 0.44002E+05, 0.46869E+05,</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">     + 0.49886E+05, 0.53062E+05, 0.56400E+05, 0.59909E+05, 0.63594E+05,</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">     + 0.67462E+05, 0.71521E+05, 0.75777E+05, 0.80238E+05, 0.84911E+05,</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">     + 0.89804E+05, 0.94925E+05, 0.10028E+06, 0.10588E+06, 0.11173E+06,</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="stringliteral">     + 0.11785E+06, 0.12423E+06, 0.13090E+06, 0.13785E+06, 0.14510E+06,</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="stringliteral">     + 0.15265E+06, 0.16053E+06, 0.16873E+06, 0.17727E+06, 0.18615E+06,</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="stringliteral">     + 0.19540E+06, 0.20501E+06, 0.21501E+06, 0.22540E+06, 0.23619E+06,</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral">     + 0.24740E+06, 0.25904E+06, 0.27112E+06, 0.28365E+06, 0.29664E+06,</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="stringliteral">     + 0.31012E+06, 0.32409E+06, 0.33856E+06, 0.35356E+06, 0.36908E+06,</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="stringliteral">     + 0.38516E+06, 0.40180E+06, 0.41902E+06, 0.43683E+06, 0.45525E+06,</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral">     + 0.47429E+06, 0.49397E+06, 0.51431E+06, 0.53532E+06, 0.55702E+06,</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="stringliteral">     + 0.57943E+06, 0.60256E+06, 0.62644E+06, 0.65107E+06, 0.67648E+06,</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="stringliteral">     + 0.70269E+06, 0.72972E+06, 0.75758E+06, 0.78629E+06, 0.81588E+06,</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="stringliteral">     + 0.84636E+06, 0.87775E+06, 0.91008E+06, 0.94337E+06, 0.97763E+06,</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="stringliteral">     + 0.10129E+07, 0.10492E+07, 0.10865E+07, 0.11249E+07, 0.11644E+07,</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="stringliteral">     + 0.12050E+07, 0.12467E+07, 0.12896E+07, 0.13337E+07, 0.13789E+07,</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="stringliteral">     + 0.14255E+07),</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="stringliteral">// c...        --       638</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="stringliteral">      stdarrayify( 0.22737E+03, 0.32194E+03, 0.41671E+03,</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="stringliteral">     + 0.51226E+03, 0.60963E+03, 0.71017E+03, 0.81528E+03, 0.92628E+03,</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="stringliteral">     + 0.10444E+04, 0.11707E+04, 0.13061E+04, 0.14518E+04, 0.16085E+04,</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="stringliteral">     + 0.17772E+04, 0.19588E+04, 0.21542E+04, 0.23644E+04, 0.25903E+04,</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral">     + 0.28330E+04, 0.30934E+04, 0.33726E+04, 0.36717E+04, 0.39918E+04,</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="stringliteral">     + 0.43342E+04, 0.47001E+04, 0.50907E+04, 0.55074E+04, 0.59515E+04,</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="stringliteral">     + 0.64244E+04, 0.69276E+04, 0.74626E+04, 0.80310E+04, 0.86344E+04,</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="stringliteral">     + 0.92744E+04, 0.99528E+04, 0.10671E+05, 0.11432E+05, 0.12236E+05,</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="stringliteral">     + 0.13086E+05, 0.13984E+05, 0.14932E+05, 0.15932E+05, 0.16985E+05,</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="stringliteral">     + 0.18096E+05, 0.19265E+05, 0.20495E+05, 0.21788E+05, 0.23148E+05,</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="stringliteral">     + 0.24576E+05, 0.26075E+05, 0.27648E+05, 0.29298E+05, 0.31027E+05,</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="stringliteral">     + 0.32839E+05, 0.34736E+05, 0.36721E+05, 0.38798E+05, 0.40970E+05,</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="stringliteral">     + 0.43240E+05, 0.45611E+05, 0.48087E+05, 0.50671E+05, 0.53368E+05,</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="stringliteral">     + 0.56180E+05, 0.59111E+05, 0.62165E+05, 0.65347E+05, 0.68659E+05,</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="stringliteral">     + 0.72107E+05, 0.75694E+05, 0.79425E+05, 0.83303E+05, 0.87334E+05,</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="stringliteral">     + 0.91522E+05, 0.95872E+05, 0.10039E+06, 0.10507E+06, 0.10994E+06,</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="stringliteral">     + 0.11498E+06, 0.12021E+06, 0.12563E+06, 0.13125E+06, 0.13707E+06,</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="stringliteral">     + 0.14309E+06, 0.14933E+06, 0.15579E+06, 0.16247E+06, 0.16938E+06,</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="stringliteral">     + 0.17653E+06, 0.18392E+06, 0.19156E+06, 0.19946E+06, 0.20761E+06,</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="stringliteral">     + 0.21604E+06, 0.22473E+06, 0.23371E+06, 0.24298E+06, 0.25254E+06,</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="stringliteral">     + 0.26240E+06, 0.27258E+06, 0.28307E+06, 0.29388E+06, 0.30502E+06,</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="stringliteral">     + 0.31651E+06, 0.32834E+06, 0.34052E+06, 0.35307E+06, 0.36599E+06,</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="stringliteral">     + 0.37929E+06, 0.39298E+06, 0.40706E+06, 0.42155E+06, 0.43645E+06,</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="stringliteral">     + 0.45178E+06, 0.46753E+06, 0.48373E+06, 0.50038E+06, 0.51748E+06,</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="stringliteral">     + 0.53506E+06),</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="stringliteral">// c...        --       637</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="stringliteral">      stdarrayify( 0.13267E+04, 0.18785E+04, 0.24314E+04,</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="stringliteral">     + 0.29888E+04, 0.35566E+04, 0.41426E+04, 0.47550E+04, 0.54013E+04,</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="stringliteral">     + 0.60886E+04, 0.68232E+04, 0.76109E+04, 0.84574E+04, 0.93678E+04,</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="stringliteral">     + 0.10348E+05, 0.11402E+05, 0.12536E+05, 0.13755E+05, 0.15065E+05,</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="stringliteral">     + 0.16471E+05, 0.17980E+05, 0.19598E+05, 0.21330E+05, 0.23184E+05,</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="stringliteral">     + 0.25166E+05, 0.27283E+05, 0.29543E+05, 0.31953E+05, 0.34521E+05,</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">     + 0.37256E+05, 0.40164E+05, 0.43256E+05, 0.46541E+05, 0.50026E+05,</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">     + 0.53723E+05, 0.57641E+05, 0.61790E+05, 0.66180E+05, 0.70823E+05,</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral">     + 0.75729E+05, 0.80910E+05, 0.86378E+05, 0.92145E+05, 0.98224E+05,</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral">     + 0.10463E+06, 0.11137E+06, 0.11846E+06, 0.12592E+06, 0.13375E+06,</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">     + 0.14198E+06, 0.15062E+06, 0.15969E+06, 0.16920E+06, 0.17916E+06,</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral">     + 0.18959E+06, 0.20052E+06, 0.21196E+06, 0.22392E+06, 0.23642E+06,</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="stringliteral">     + 0.24949E+06, 0.26314E+06, 0.27740E+06, 0.29227E+06, 0.30779E+06,</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">     + 0.32398E+06, 0.34085E+06, 0.35842E+06, 0.37673E+06, 0.39579E+06,</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral">     + 0.41563E+06, 0.43626E+06, 0.45772E+06, 0.48003E+06, 0.50322E+06,</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="stringliteral">     + 0.52730E+06, 0.55232E+06, 0.57829E+06, 0.60524E+06, 0.63320E+06,</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral">     + 0.66219E+06, 0.69226E+06, 0.72342E+06, 0.75571E+06, 0.78916E+06,</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral">     + 0.82380E+06, 0.85966E+06, 0.89678E+06, 0.93518E+06, 0.97490E+06,</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">     + 0.10160E+07, 0.10585E+07, 0.11023E+07, 0.11477E+07, 0.11946E+07,</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">     + 0.12430E+07, 0.12929E+07, 0.13445E+07, 0.13977E+07, 0.14526E+07,</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral">     + 0.15093E+07, 0.15677E+07, 0.16280E+07, 0.16901E+07, 0.17541E+07,</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">     + 0.18200E+07, 0.18880E+07, 0.19579E+07, 0.20300E+07, 0.21042E+07,</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="stringliteral">     + 0.21805E+07, 0.22591E+07, 0.23400E+07, 0.24232E+07, 0.25087E+07,</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="stringliteral">     + 0.25967E+07, 0.26871E+07, 0.27801E+07, 0.28757E+07, 0.29739E+07,</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="stringliteral">     + 0.30747E+07),</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral">// c...        --       828</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="stringliteral">      stdarrayify( 0.60334E+02, 0.85430E+02, 0.11058E+03,</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral">     + 0.13590E+03, 0.16167E+03, 0.18821E+03, 0.21588E+03, 0.24502E+03,</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral">     + 0.27595E+03, 0.30896E+03, 0.34431E+03, 0.38225E+03, 0.42301E+03,</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="stringliteral">     + 0.46684E+03, 0.51397E+03, 0.56464E+03, 0.61907E+03, 0.67753E+03,</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral">     + 0.74027E+03, 0.80753E+03, 0.87961E+03, 0.95676E+03, 0.10393E+04,</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral">     + 0.11275E+04, 0.12217E+04, 0.13222E+04, 0.14293E+04, 0.15434E+04,</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">     + 0.16648E+04, 0.17940E+04, 0.19312E+04, 0.20769E+04, 0.22315E+04,</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">     + 0.23954E+04, 0.25691E+04, 0.27529E+04, 0.29474E+04, 0.31530E+04,</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">     + 0.33702E+04, 0.35995E+04, 0.38414E+04, 0.40965E+04, 0.43654E+04,</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="stringliteral">     + 0.46484E+04, 0.49464E+04, 0.52598E+04, 0.55892E+04, 0.59353E+04,</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="stringliteral">     + 0.62988E+04, 0.66803E+04, 0.70804E+04, 0.74998E+04, 0.79394E+04,</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral">     + 0.83998E+04, 0.88817E+04, 0.93859E+04, 0.99132E+04, 0.10464E+05,</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral">     + 0.11040E+05, 0.11642E+05, 0.12270E+05, 0.12925E+05, 0.13609E+05,</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral">     + 0.14321E+05, 0.15064E+05, 0.15838E+05, 0.16643E+05, 0.17482E+05,</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">     + 0.18355E+05, 0.19263E+05, 0.20207E+05, 0.21188E+05, 0.22208E+05,</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">     + 0.23267E+05, 0.24366E+05, 0.25508E+05, 0.26692E+05, 0.27921E+05,</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">     + 0.29195E+05, 0.30516E+05, 0.31886E+05, 0.33304E+05, 0.34773E+05,</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral">     + 0.36294E+05, 0.37869E+05, 0.39499E+05, 0.41185E+05, 0.42929E+05,</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral">     + 0.44732E+05, 0.46596E+05, 0.48522E+05, 0.50513E+05, 0.52569E+05,</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">     + 0.54692E+05, 0.56884E+05, 0.59146E+05, 0.61481E+05, 0.63890E+05,</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral">     + 0.66375E+05, 0.68937E+05, 0.71578E+05, 0.74301E+05, 0.77107E+05,</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">     + 0.79998E+05, 0.82976E+05, 0.86043E+05, 0.89201E+05, 0.92452E+05,</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral">     + 0.95799E+05, 0.99242E+05, 0.10278E+06, 0.10643E+06, 0.11018E+06,</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral">     + 0.11403E+06, 0.11799E+06, 0.12206E+06, 0.12625E+06, 0.13055E+06,</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral">     + 0.13497E+06),</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">// c...        --       728</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">      stdarrayify( 0.70354E+03, 0.99615E+03, 0.12893E+04,</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">     + 0.15846E+04, 0.18848E+04, 0.21940E+04, 0.25162E+04, 0.28554E+04,</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">     + 0.32152E+04, 0.35991E+04, 0.40099E+04, 0.44507E+04, 0.49242E+04,</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral">     + 0.54332E+04, 0.59802E+04, 0.65681E+04, 0.71996E+04, 0.78776E+04,</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">     + 0.86050E+04, 0.93847E+04, 0.10220E+05, 0.11114E+05, 0.12070E+05,</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">     + 0.13091E+05, 0.14182E+05, 0.15345E+05, 0.16585E+05, 0.17906E+05,</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">     + 0.19311E+05, 0.20805E+05, 0.22393E+05, 0.24078E+05, 0.25865E+05,</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral">     + 0.27760E+05, 0.29768E+05, 0.31893E+05, 0.34140E+05, 0.36516E+05,</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">     + 0.39025E+05, 0.41674E+05, 0.44469E+05, 0.47416E+05, 0.50520E+05,</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">     + 0.53789E+05, 0.57229E+05, 0.60847E+05, 0.64650E+05, 0.68645E+05,</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">     + 0.72840E+05, 0.77242E+05, 0.81859E+05, 0.86699E+05, 0.91770E+05,</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral">     + 0.97081E+05, 0.10264E+06, 0.10846E+06, 0.11454E+06, 0.12090E+06,</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral">     + 0.12754E+06, 0.13447E+06, 0.14171E+06, 0.14927E+06, 0.15715E+06,</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">     + 0.16536E+06, 0.17392E+06, 0.18284E+06, 0.19213E+06, 0.20179E+06,</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">     + 0.21185E+06, 0.22231E+06, 0.23319E+06, 0.24450E+06, 0.25625E+06,</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral">     + 0.26845E+06, 0.28112E+06, 0.29427E+06, 0.30791E+06, 0.32206E+06,</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral">     + 0.33674E+06, 0.35196E+06, 0.36772E+06, 0.38406E+06, 0.40098E+06,</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral">     + 0.41850E+06, 0.43663E+06, 0.45539E+06, 0.47480E+06, 0.49488E+06,</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral">     + 0.51564E+06, 0.53710E+06, 0.55928E+06, 0.58219E+06, 0.60586E+06,</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="stringliteral">     + 0.63029E+06, 0.65553E+06, 0.68157E+06, 0.70844E+06, 0.73616E+06,</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="stringliteral">     + 0.76476E+06, 0.79424E+06, 0.82464E+06, 0.85597E+06, 0.88826E+06,</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="stringliteral">     + 0.92153E+06, 0.95580E+06, 0.99108E+06, 0.10274E+07, 0.10648E+07,</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="stringliteral">     + 0.11033E+07, 0.11429E+07, 0.11837E+07, 0.12256E+07, 0.12687E+07,</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="stringliteral">     + 0.13131E+07, 0.13586E+07, 0.14055E+07, 0.14536E+07, 0.15031E+07,</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="stringliteral">     + 0.15539E+07),</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="stringliteral">// c...        --       727</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral">      stdarrayify( 0.20518E+04, 0.29051E+04, 0.37601E+04,</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral">     + 0.46209E+04, 0.54961E+04, 0.63969E+04, 0.73353E+04, 0.83227E+04,</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">     + 0.93698E+04, 0.10486E+05, 0.11681E+05, 0.12962E+05, 0.14337E+05,</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">     + 0.15815E+05, 0.17403E+05, 0.19110E+05, 0.20942E+05, 0.22909E+05,</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral">     + 0.25018E+05, 0.27278E+05, 0.29699E+05, 0.32290E+05, 0.35060E+05,</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">     + 0.38019E+05, 0.41177E+05, 0.44545E+05, 0.48135E+05, 0.51957E+05,</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">     + 0.56023E+05, 0.60346E+05, 0.64938E+05, 0.69812E+05, 0.74981E+05,</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">     + 0.80461E+05, 0.86264E+05, 0.92406E+05, 0.98902E+05, 0.10577E+06,</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">     + 0.11302E+06, 0.12067E+06, 0.12875E+06, 0.13726E+06, 0.14622E+06,</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">     + 0.15566E+06, 0.16559E+06, 0.17604E+06, 0.18702E+06, 0.19855E+06,</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">     + 0.21066E+06, 0.22336E+06, 0.23669E+06, 0.25065E+06, 0.26528E+06,</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">     + 0.28061E+06, 0.29664E+06, 0.31342E+06, 0.33096E+06, 0.34930E+06,</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">     + 0.36845E+06, 0.38845E+06, 0.40933E+06, 0.43111E+06, 0.45383E+06,</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">     + 0.47751E+06, 0.50219E+06, 0.52790E+06, 0.55466E+06, 0.58252E+06,</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral">     + 0.61151E+06, 0.64166E+06, 0.67300E+06, 0.70558E+06, 0.73943E+06,</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">     + 0.77458E+06, 0.81108E+06, 0.84896E+06, 0.88827E+06, 0.92904E+06,</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral">     + 0.97131E+06, 0.10151E+07, 0.10605E+07, 0.11076E+07, 0.11563E+07,</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">     + 0.12068E+07, 0.12590E+07, 0.13130E+07, 0.13689E+07, 0.14267E+07,</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">     + 0.14865E+07, 0.15483E+07, 0.16121E+07, 0.16781E+07, 0.17462E+07,</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral">     + 0.18165E+07, 0.18892E+07, 0.19641E+07, 0.20415E+07, 0.21213E+07,</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">     + 0.22036E+07, 0.22884E+07, 0.23759E+07, 0.24661E+07, 0.25590E+07,</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">     + 0.26547E+07, 0.27533E+07, 0.28549E+07, 0.29594E+07, 0.30670E+07,</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral">     + 0.31778E+07, 0.32918E+07, 0.34090E+07, 0.35296E+07, 0.36536E+07,</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral">     + 0.37812E+07, 0.39123E+07, 0.40470E+07, 0.41855E+07, 0.43278E+07,</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">     + 0.44739E+07),</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">// c...        --       838</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral">      stdarrayify( 0.12066E+03, 0.17085E+03, 0.22116E+03,</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral">     + 0.27190E+03, 0.32364E+03, 0.37711E+03, 0.43305E+03, 0.49219E+03,</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral">     + 0.55516E+03, 0.62256E+03, 0.69492E+03, 0.77276E+03, 0.85657E+03,</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="stringliteral">     + 0.94685E+03, 0.10441E+04, 0.11488E+04, 0.12614E+04, 0.13826E+04,</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="stringliteral">     + 0.15127E+04, 0.16525E+04, 0.18024E+04, 0.19630E+04, 0.21351E+04,</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="stringliteral">     + 0.23191E+04, 0.25158E+04, 0.27260E+04, 0.29502E+04, 0.31892E+04,</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="stringliteral">     + 0.34438E+04, 0.37148E+04, 0.40031E+04, 0.43094E+04, 0.46346E+04,</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="stringliteral">     + 0.49797E+04, 0.53455E+04, 0.57331E+04, 0.61434E+04, 0.65775E+04,</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="stringliteral">     + 0.70364E+04, 0.75212E+04, 0.80330E+04, 0.85730E+04, 0.91424E+04,</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="stringliteral">     + 0.97423E+04, 0.10374E+05, 0.11039E+05, 0.11738E+05, 0.12474E+05,</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="stringliteral">     + 0.13246E+05, 0.14057E+05, 0.14908E+05, 0.15801E+05, 0.16737E+05,</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="stringliteral">     + 0.17717E+05, 0.18744E+05, 0.19819E+05, 0.20944E+05, 0.22120E+05,</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="stringliteral">     + 0.23349E+05, 0.24634E+05, 0.25975E+05, 0.27376E+05, 0.28837E+05,</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="stringliteral">     + 0.30361E+05, 0.31950E+05, 0.33605E+05, 0.35330E+05, 0.37126E+05,</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="stringliteral">     + 0.38996E+05, 0.40942E+05, 0.42965E+05, 0.45069E+05, 0.47256E+05,</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="stringliteral">     + 0.49528E+05, 0.51888E+05, 0.54338E+05, 0.56882E+05, 0.59521E+05,</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="stringliteral">     + 0.62259E+05, 0.65097E+05, 0.68040E+05, 0.71090E+05, 0.74249E+05,</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral">     + 0.77522E+05, 0.80910E+05, 0.84417E+05, 0.88046E+05, 0.91801E+05,</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral">     + 0.95684E+05, 0.99699E+05, 0.10385E+06, 0.10814E+06, 0.11257E+06,</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="stringliteral">     + 0.11715E+06, 0.12187E+06, 0.12675E+06, 0.13179E+06, 0.13699E+06,</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="stringliteral">     + 0.14235E+06, 0.14788E+06, 0.15358E+06, 0.15946E+06, 0.16552E+06,</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="stringliteral">     + 0.17176E+06, 0.17819E+06, 0.18482E+06, 0.19164E+06, 0.19867E+06,</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="stringliteral">     + 0.20590E+06, 0.21335E+06, 0.22101E+06, 0.22889E+06, 0.23699E+06,</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="stringliteral">     + 0.24533E+06, 0.25390E+06, 0.26271E+06, 0.27177E+06, 0.28108E+06,</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="stringliteral">     + 0.29064E+06),</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="stringliteral">// c...        --       837</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="stringliteral">      stdarrayify( 0.14071E+04, 0.19923E+04, 0.25789E+04,</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="stringliteral">     + 0.31704E+04, 0.37733E+04, 0.43962E+04, 0.50477E+04, 0.57360E+04,</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="stringliteral">     + 0.64687E+04, 0.72525E+04, 0.80938E+04, 0.89984E+04, 0.99723E+04,</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="stringliteral">     + 0.11021E+05, 0.12150E+05, 0.13366E+05, 0.14673E+05, 0.16079E+05,</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="stringliteral">     + 0.17589E+05, 0.19211E+05, 0.20949E+05, 0.22812E+05, 0.24807E+05,</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="stringliteral">     + 0.26940E+05, 0.29221E+05, 0.31656E+05, 0.34254E+05, 0.37023E+05,</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="stringliteral">     + 0.39972E+05, 0.43111E+05, 0.46449E+05, 0.49996E+05, 0.53762E+05,</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="stringliteral">     + 0.57756E+05, 0.61991E+05, 0.66477E+05, 0.71226E+05, 0.76249E+05,</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="stringliteral">     + 0.81558E+05, 0.87167E+05, 0.93088E+05, 0.99334E+05, 0.10592E+06,</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="stringliteral">     + 0.11286E+06, 0.12016E+06, 0.12785E+06, 0.13594E+06, 0.14444E+06,</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="stringliteral">     + 0.15337E+06, 0.16274E+06, 0.17258E+06, 0.18290E+06, 0.19371E+06,</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="stringliteral">     + 0.20504E+06, 0.21691E+06, 0.22933E+06, 0.24233E+06, 0.25592E+06,</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="stringliteral">     + 0.27012E+06, 0.28496E+06, 0.30046E+06, 0.31663E+06, 0.33351E+06,</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="stringliteral">     + 0.35111E+06, 0.36946E+06, 0.38858E+06, 0.40850E+06, 0.42924E+06,</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="stringliteral">     + 0.45083E+06, 0.47329E+06, 0.49666E+06, 0.52095E+06, 0.54620E+06,</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="stringliteral">     + 0.57243E+06, 0.59967E+06, 0.62796E+06, 0.65732E+06, 0.68778E+06,</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="stringliteral">     + 0.71938E+06, 0.75214E+06, 0.78611E+06, 0.82131E+06, 0.85777E+06,</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="stringliteral">     + 0.89553E+06, 0.93463E+06, 0.97511E+06, 0.10170E+07, 0.10603E+07,</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="stringliteral">     + 0.11051E+07, 0.11514E+07, 0.11993E+07, 0.12488E+07, 0.12999E+07,</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="stringliteral">     + 0.13527E+07, 0.14073E+07, 0.14636E+07, 0.15217E+07, 0.15816E+07,</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="stringliteral">     + 0.16435E+07, 0.17072E+07, 0.17730E+07, 0.18408E+07, 0.19107E+07,</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="stringliteral">     + 0.19827E+07, 0.20569E+07, 0.21334E+07, 0.22121E+07, 0.22931E+07,</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="stringliteral">     + 0.23765E+07, 0.24624E+07, 0.25507E+07, 0.26416E+07, 0.27351E+07,</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">     + 0.28312E+07, 0.29301E+07, 0.30317E+07, 0.31361E+07, 0.32434E+07,</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="stringliteral">     + 0.33537E+07));</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="stringliteral">  gsi = xgj[iso-1];</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="stringliteral">  const auto&amp; q = qoft[iso-1];</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="stringliteral">  if (t &lt; 70 or t &gt; 3000)</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="stringliteral">    qt = -1.0;</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="stringliteral">  else</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="stringliteral">    qt = atob(t, tdat, q);</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a31ab9ddf8719e98e006ffeaa097c1ce4">  782</a></span>&#160;<span class="stringliteral">void calcw(CommonBlock&amp; cmn,</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="stringliteral">           const Index&amp; n,</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="stringliteral">           const Index&amp; iband,</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="stringliteral">           const Numeric&amp; temp)</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="stringliteral">    cmn.YLT.YT[i] = 0;</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="stringliteral">      cmn.Wmatrix.W(i, j) = 0;</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">  if (cmn.Bands.li[iband] &gt; 8 or std::abs(cmn.Bands.li[iband] - cmn.Bands.lf[iband]) &gt; 1) {</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral">      cmn.Wmatrix.W(i, i) = cmn.GamT.HWT[i];</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">    return;</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">  Vector s(n);</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">    s[i] = cmn.LineSg.Sig(i, iband) * cmn.PopuT.PopuT[i] * Constant::pow2(cmn.DipoTcm.DipoT(i, iband));</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral">    for (Index j=i+1; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral">      if (s[j] &gt; s[i]) {</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral">        // Switch switches 2 elements in a vector :: std::swap(A(i), A(j));</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">        // SwitchTwo switches two elements in a Matrix :: std::swap(A(i, k), A(j, k));</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral">        // SwitchInt is as SwitchTwo but for Integers :: std::swap(A(i, k), A(j, k));</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">        std::swap(cmn.DipoRigid.Dipo0(i, iband), cmn.DipoRigid.Dipo0(j, iband));</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral">        std::swap(cmn.DipoTcm.DipoT(i, iband), cmn.DipoTcm.DipoT(j, iband));</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">        std::swap(cmn.LineSg.Sig(i, iband), cmn.LineSg.Sig(j, iband));</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">        std::swap(cmn.Jiln.Ji(i, iband), cmn.Jiln.Ji(j, iband));</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">        std::swap(cmn.Jfln.Jf(i, iband), cmn.Jfln.Jf(j, iband));</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="stringliteral">        std::swap(cmn.GamT.HWSDV2T[i], cmn.GamT.HWSDV2T[j]);</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="stringliteral">        std::swap(cmn.PopuT.PopuT[i], cmn.PopuT.PopuT[j]);</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="stringliteral">        std::swap(cmn.SHIFT.shft[i], cmn.SHIFT.shft[j]);</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="stringliteral">        std::swap(cmn.GamT.HWT[i], cmn.GamT.HWT[j]);</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="stringliteral">        std::swap(s[i], s[j]);</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="stringliteral">  const Numeric dlgt0t = std::log(parameters::T0 / temp);</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="stringliteral">  const Index lli = std::min(cmn.Bands.li[iband], cmn.Bands.lf[iband]);</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="stringliteral">  const Index llf = std::max(cmn.Bands.li[iband], cmn.Bands.lf[iband]);</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="stringliteral">  // Set off-diagonal elements</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="stringliteral">    Index jji, jjf;</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="stringliteral">    if (cmn.Bands.li[iband] &lt;= cmn.Bands.lf[iband]) {</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="stringliteral">      jji=cmn.Jiln.Ji(i, iband);</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="stringliteral">      jjf=cmn.Jfln.Jf(i, iband);</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="stringliteral">    } else {</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="stringliteral">      jji=cmn.Jfln.Jf(i, iband);</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="stringliteral">      jjf=cmn.Jiln.Ji(i, iband);</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">      Index jjip, jjfp;</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">      if (cmn.Bands.li[iband] &lt;= cmn.Bands.lf[iband]) {</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral">        jjip=cmn.Jiln.Ji(j, iband);</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral">        jjfp=cmn.Jfln.Jf(j, iband);</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="stringliteral">      } else {</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="stringliteral">        jjip=cmn.Jfln.Jf(j, iband);</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="stringliteral">        jjfp=cmn.Jiln.Ji(j, iband);</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral">      if (jjip &gt; jji) continue;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">      if (cmn.Bands.Isot[iband] &gt; 2 and cmn.Bands.Isot[iband] not_eq 7 and cmn.Bands.Isot[iband] not_eq 10 and (std::abs(cmn.Jiln.Ji(i, iband)-cmn.Jiln.Ji(j, iband)) % 2) not_eq 0) continue;</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">      Numeric w0=0, b0=0;</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral">      if (jji &gt; jjf and jjip &gt; jjfp) {</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedp.W0pp(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedp.B0pp(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral">      } else if (jji &gt; jjf and jjip == jjfp) {</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedp.W0pq(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedp.B0pq(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral">      } else if (jji &gt; jjf and jjip &lt; jjfp) {</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedp.W0pr(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedp.B0pr(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">      } else if (jji &lt; jjf and jjip &gt; jjfp) {</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedr.W0rp(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedr.B0rp(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">      } else if (jji &lt; jjf and jjip == jjfp) {</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedr.W0rq(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedr.B0rq(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">      } else if (jji &lt; jjf and jjip &lt; jjfp) {</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedr.W0rr(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedr.B0rr(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="stringliteral">      } else if (jji == jjf and jjip &gt; jjfp) {</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedq.W0qp(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedq.B0qp(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">      } else if (jji == jjf and jjip == jjfp) {</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedq.W0qq(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedq.B0qq(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="stringliteral">      } else if (jji == jjf and jjip &lt; jjfp) {</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="stringliteral">        w0 = cmn.Wfittedq.W0qr(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="stringliteral">        b0 = cmn.Bfittedq.B0qr(lli, llf, jji, jjip);</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral">      const Numeric ycal = std::exp(w0 - b0*dlgt0t);</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral">      cmn.Wmatrix.W(j, i) = ycal;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="stringliteral">      cmn.Wmatrix.W(i, j) = ycal * cmn.PopuT.PopuT[i] / cmn.PopuT.PopuT[j];</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral">  // Weird undocumented minus sign</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="stringliteral">      if (j not_eq i) {</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="stringliteral">        cmn.Wmatrix.W(i, j) = - std::abs(cmn.Wmatrix.W(i, j));</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="stringliteral">  // Set diagonal to measured broadening</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="stringliteral">    cmn.Wmatrix.W(i, i) = cmn.GamT.HWT[i];</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="stringliteral">  // Sum rule correction</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="stringliteral">    Numeric sumlw = 0.0;</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="stringliteral">    Numeric sumup = 0.0;</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="stringliteral">      if (cmn.Bands.Isot[iband] &gt; 2 and cmn.Bands.Isot[iband] not_eq 7 and cmn.Bands.Isot[iband] not_eq 10 and (std::abs(cmn.Jiln.Ji(i, iband)-cmn.Jiln.Ji(j, iband)) % 2) not_eq 0) continue;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="stringliteral">      if (j &gt; i) {</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="stringliteral">        sumlw += std::abs(cmn.DipoRigid.Dipo0(j, iband)) * cmn.Wmatrix.W(j, i);</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="stringliteral">      } else {</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="stringliteral">        sumup += std::abs(cmn.DipoRigid.Dipo0(j, iband)) * cmn.Wmatrix.W(j, i);</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="stringliteral">    for (Index j=i+1; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="stringliteral">      if (sumlw == 0) {</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="stringliteral">        cmn.Wmatrix.W(j, i) = 0.0;</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral">        cmn.Wmatrix.W(i, j) = 0.0;</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="stringliteral">      } else {</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="stringliteral">        cmn.Wmatrix.W(j, i) = cmn.Wmatrix.W(j, i) * (- sumup / sumlw);</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="stringliteral">        cmn.Wmatrix.W(i, j) = cmn.Wmatrix.W(j, i) * cmn.PopuT.PopuT[i] / cmn.PopuT.PopuT[j];</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="stringliteral">  // Rosenkranz coefficients</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="stringliteral">    Numeric sum0 = 0;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="stringliteral">      if (i == j) continue;</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="stringliteral">      if (cmn.Bands.Isot[iband] &gt; 2 and cmn.Bands.Isot[iband] not_eq 7 and cmn.Bands.Isot[iband] not_eq 10 and (std::abs(cmn.Jiln.Ji(i, iband)-cmn.Jiln.Ji(j, iband)) % 2) not_eq 0) continue;</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="stringliteral">      Numeric deltasig = cmn.LineSg.Sig(i, iband) - cmn.LineSg.Sig(j, iband);</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="stringliteral">      if (std::abs(deltasig) &lt; 1e-4 /*cm-1*/ ) deltasig = 1e-4 /*cm-1*/;</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="stringliteral">      sum0 += 2 * std::abs(cmn.DipoTcm.DipoT(j, iband)) / std::abs(std::abs(cmn.DipoTcm.DipoT(i, iband))) * cmn.Wmatrix.W(j, i) / deltasig;</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="stringliteral">    cmn.YLT.YT[i] = sum0;</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">// Class not allowed to copy</span></div>
<div class="line"><a name="l00951"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html">  951</a></span>&#160;<span class="stringliteral">struct EqvLinesOut {</span></div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html#a5adfd91b65379104f200b0c0585429f7">  952</a></span>&#160;<span class="stringliteral">  ComplexVector zval, zstr;</span></div>
<div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html#a3a94ed24d27150362327b7cbc8bf3299">  953</a></span>&#160;<span class="stringliteral">  explicit EqvLinesOut(Index n=0) noexcept : zval(n, 0), zstr(n, 0) {}</span></div>
<div class="line"><a name="l00954"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html#ad8d5bb15f08465afcdcea94d0793a346">  954</a></span>&#160;<span class="stringliteral">  EqvLinesOut(const EqvLinesOut&amp;) = delete;</span></div>
<div class="line"><a name="l00955"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html#afce7c0752bff09b06b889c597323122b">  955</a></span>&#160;<span class="stringliteral">  EqvLinesOut(EqvLinesOut&amp;&amp;) = default;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html#a6aadb1c6bb102559d511c842c5b3dc15">  956</a></span>&#160;<span class="stringliteral">  EqvLinesOut&amp; operator=(const EqvLinesOut&amp;) = delete;</span></div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1EqvLinesOut.html#abf689cd8211d04b3d5f035e6bad7dbc8">  957</a></span>&#160;<span class="stringliteral">  EqvLinesOut&amp; operator=(EqvLinesOut&amp;&amp;) = default;</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="stringliteral">};</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="stringliteral">// Class not allowed to copy</span></div>
<div class="line"><a name="l00962"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html">  962</a></span>&#160;<span class="stringliteral">struct ConvTPOut {</span></div>
<div class="line"><a name="l00963"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#aa6175cb904a58fc82432c9c26a1fbbd5">  963</a></span>&#160;<span class="stringliteral">  Vector Y, hwt, hwt2, shft, f0, pop, dip;</span></div>
<div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#aebd81a35f14e759d0e96ecb0f72a687a">  964</a></span>&#160;<span class="stringliteral">  ComplexMatrix W;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#aa081b7a693a43fc6a7de193ed7bc5cba">  965</a></span>&#160;<span class="stringliteral">  EqvLinesOut eqv;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#a8877f094d710b0c8a3db59a875c68ce4">  966</a></span>&#160;<span class="stringliteral">  explicit ConvTPOut(Index n=0) noexcept : Y(n, 0), hwt(n), hwt2(n), shft(n), f0(n), pop(n), dip(n), W(n, n, 0), eqv(n) {}</span></div>
<div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#afa191c0086ecaa3e764acc3ac26069cf">  967</a></span>&#160;<span class="stringliteral">  ConvTPOut(const ConvTPOut&amp;) = delete;</span></div>
<div class="line"><a name="l00968"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#a14574908c6f6d00f322eaead433fe2bf">  968</a></span>&#160;<span class="stringliteral">  ConvTPOut(ConvTPOut&amp;&amp;) = default;</span></div>
<div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#a009b22440414b9ac3afeb4dbd226246f">  969</a></span>&#160;<span class="stringliteral">  ConvTPOut&amp; operator=(const ConvTPOut&amp;) = delete;</span></div>
<div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="structlm__hitran__2017_1_1ConvTPOut.html#af861b20476b66cb6f77d2671987961bd">  970</a></span>&#160;<span class="stringliteral">  ConvTPOut&amp; operator=(ConvTPOut&amp;&amp;) = default;</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="stringliteral">};</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00974"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a89b3dbcac85ae3ea62b25b964396b72e">  974</a></span>&#160;<span class="stringliteral">void calcw(ConvTPOut&amp; out,</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral">           const HitranRelaxationMatrixData&amp; hitran,</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral">           const AbsorptionLines&amp; band,</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral">           const Numeric T)</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="stringliteral">  Vector&amp; Y = out.Y;</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="stringliteral">  Vector&amp; g0 = out.hwt;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="stringliteral">  Vector&amp; g2 = out.hwt2;</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="stringliteral">  Vector&amp; d0 = out.shft;</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="stringliteral">  Vector&amp; f0 = out.f0;</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="stringliteral">  Vector&amp; pop = out.pop;</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="stringliteral">  Vector&amp; dip = out.dip;</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="stringliteral">  MatrixView W = transpose(out.W.imag());  // Transpose to fit Fortran-code</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="stringliteral">  // Size of problem</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="stringliteral">  const Index n=Y.nelem();</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="stringliteral">  // Copies for local variables</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="stringliteral">  const Rational li = band.UpperQuantumNumber(0, QuantumNumberType::l1);</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="stringliteral">  const Rational lf = band.LowerQuantumNumber(0, QuantumNumberType::l1);</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="stringliteral">  Vector dip0(n);</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="stringliteral">  std::vector&lt;Rational&gt; Ji(n), Jf(n);</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="stringliteral">    Ji[i] = band.UpperQuantumNumber(i, QuantumNumberType::J);</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="stringliteral">    Jf[i] = band.LowerQuantumNumber(i, QuantumNumberType::J);</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral">    dip0[i] = Absorption::reduced_rovibrational_dipole(Jf[i], Ji[i], lf, li, 1_rat);</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="stringliteral">  Vector s(n);</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="stringliteral">  if (li &gt; 8 or  abs(li - lf) &gt; 1) {</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="stringliteral">      W(i, i) = g0[i];  // nb... units Hz/Pa</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="stringliteral">  } else {</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral">      s[i] = f0[i] * pop[i] * Constant::pow2(dip[i]);</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="stringliteral">      for (Index j=i+1; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="stringliteral">        if (s[j] &gt; s[i]) {</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="stringliteral">          // Switch switches 2 elements in a vector :: std::swap(A(i), A(j));</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="stringliteral">          // SwitchTwo switches two elements in a Matrix :: std::swap(A(i, k), A(j, k));</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="stringliteral">          // SwitchInt is as SwitchTwo but for Integers :: std::swap(A(i, k), A(j, k));</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="stringliteral">          std::swap(Ji[i], Ji[j]);</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="stringliteral">          std::swap(Jf[i], Jf[j]);</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral">          std::swap(g0[i], g0[j]);</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">          std::swap(d0[i], d0[j]);</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral">          std::swap(g2[i], g2[j]);</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral">          std::swap(f0[i], f0[j]);</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="stringliteral">          std::swap(dip[i], dip[j]);</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="stringliteral">          std::swap(pop[i], pop[j]);</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="stringliteral">          std::swap(dip0[i], dip0[j]);</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral">          std::swap(s[i], s[j]);</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="stringliteral">    const Numeric dlgt0t = std::log(band.T0() / T);</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="stringliteral">    const Rational lli = std::min(li, lf);</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="stringliteral">    const Rational llf = std::max(li, lf);</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="stringliteral">    // Set off-diagonal elements</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="stringliteral">      Rational jji, jjf;</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="stringliteral">      if (li &lt;= lf) {</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral">        jji = Ji[i];</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="stringliteral">        jjf = Jf[i];</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="stringliteral">      } else {</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="stringliteral">        jji = Jf[i];</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral">        jjf = Ji[i];</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral">      for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral">        Rational jjip, jjfp;</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">        if (li &lt;= lf) {</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">          jjip = Ji[j];</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="stringliteral">          jjfp = Jf[j];</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral">          jjip = Jf[j];</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="stringliteral">          jjfp = Ji[j];</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral">        if (jjip &gt; jji) continue;</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="stringliteral">        // nb. FIX THIS FOR ARTS SPECIFIC Isotopologue</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="stringliteral">        const bool skip = band.Isotopologue() &gt; 2 and</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="stringliteral">                          band.Isotopologue() not_eq 7 and </span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="stringliteral">                          band.Isotopologue() not_eq 10 and </span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">                          (abs(Ji[i] - Ji[j]) % 2) not_eq 0;</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral">        if(skip) continue;</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral">        Numeric w0=0, b0=0;</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="stringliteral">        if (jji &gt; jjf and jjip &gt; jjfp) {</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="stringliteral">          w0 = hitran.W0pp(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral">          b0 = hitran.B0pp(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="stringliteral">        } else if (jji &gt; jjf and jjip == jjfp) {</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="stringliteral">          w0 = hitran.W0pq(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="stringliteral">          b0 = hitran.B0pq(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="stringliteral">        } else if (jji &gt; jjf and jjip &lt; jjfp) {</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="stringliteral">          w0 = hitran.W0pr(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral">          b0 = hitran.B0pr(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral">        } else if (jji &lt; jjf and jjip &gt; jjfp) {</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="stringliteral">          w0 = hitran.W0rp(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="stringliteral">          b0 = hitran.B0rp(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="stringliteral">        } else if (jji &lt; jjf and jjip == jjfp) {</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="stringliteral">          w0 = hitran.W0rq(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="stringliteral">          b0 = hitran.B0rq(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="stringliteral">        } else if (jji &lt; jjf and jjip &lt; jjfp) {</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="stringliteral">          w0 = hitran.W0rr(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="stringliteral">          b0 = hitran.B0rr(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="stringliteral">        } else if (jji == jjf and jjip &gt; jjfp) {</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="stringliteral">          w0 = hitran.W0qp(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="stringliteral">          b0 = hitran.B0qp(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="stringliteral">        } else if (jji == jjf and jjip == jjfp) {</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="stringliteral">          w0 = hitran.W0qq(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="stringliteral">          b0 = hitran.B0qq(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="stringliteral">        } else if (jji == jjf and jjip &lt; jjfp) {</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="stringliteral">          w0 = hitran.W0qr(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="stringliteral">          b0 = hitran.B0qr(lli.toIndex(), llf.toIndex(), jji.toIndex(), jjip.toIndex());</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="stringliteral">        // nb... should order be different???</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="stringliteral">        const Numeric ycal = std::exp(w0 - b0*dlgt0t);</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="stringliteral">        W(j, i) = ycal;</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="stringliteral">        W(i, j) = ycal * pop[i] / pop[j];</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="stringliteral">    // Weird undocumented minus sign</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="stringliteral">      for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="stringliteral">        if (j not_eq i) {</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="stringliteral">          W(i, j) = - std::abs(W(i, j));</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="stringliteral">    // Set diagonal to measured broadening</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="stringliteral">      W(i, i) = g0[i];  // nb... units Hz/Pa</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="stringliteral">    // Sum rule correction</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="stringliteral">      Numeric sumlw = 0.0;</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="stringliteral">      Numeric sumup = 0.0;</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="stringliteral">      for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="stringliteral">        // nb. FIX THIS FOR ARTS SPECIFIC Isotopologue</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="stringliteral">        const bool skip = band.Isotopologue() &gt; 2 and</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="stringliteral">                          band.Isotopologue() not_eq 7 and </span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="stringliteral">                          band.Isotopologue() not_eq 10 and </span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="stringliteral">                          (abs(Ji[i] - Ji[j]) % 2) not_eq 0;</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="stringliteral">                </span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="stringliteral">        if (skip) continue;</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="stringliteral">        if (j &gt; i) {</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="stringliteral">          sumlw += std::abs(dip0[j]) * W(j, i);</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="stringliteral">          sumup += std::abs(dip0[j]) * W(j, i);</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="stringliteral">      for (Index j=i+1; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="stringliteral">        if (sumlw == 0) {</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="stringliteral">          W(j, i) = 0.0;</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="stringliteral">          W(i, j) = 0.0;</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="stringliteral">          W(j, i) *= - sumup / sumlw;</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="stringliteral">          W(i, j) = W(j, i) * pop[i] / pop[j];</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="stringliteral">    // Rosenkranz coefficients</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="stringliteral">    for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="stringliteral">      Numeric sum0 = 0;</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="stringliteral">      for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="stringliteral">        if (i == j) continue;</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="stringliteral">        // nb. FIX THIS FOR ARTS SPECIFIC Isotopologue</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="stringliteral">        const bool skip = band.Isotopologue() &gt; 2 and</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="stringliteral">                          band.Isotopologue() not_eq 7 and </span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="stringliteral">                          band.Isotopologue() not_eq 10 and </span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="stringliteral">                          (abs(Ji[i] - Ji[j]) % 2) not_eq 0;</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="stringliteral">                </span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="stringliteral">        if (skip) continue;</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="stringliteral">        Numeric deltasig = f0[i] - f0[j];</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="stringliteral">        if (std::abs(deltasig) &lt; Conversion::kaycm2freq(1e-4 /*cm-1*/))</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="stringliteral">          deltasig = Conversion::kaycm2freq(1e-4) /*Hz*/;</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="stringliteral">        sum0 += 2 * std::abs(dip[j]) / std::abs(dip[i]) * W(j, i) / deltasig;</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="stringliteral">      Y[i] = sum0;</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01178"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a0072c66353685d71b5b7fb867b8f1cb7"> 1178</a></span>&#160;<span class="stringliteral">void eqvlines(CommonBlock&amp; cmn,</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="stringliteral">              const Index&amp; iband,</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="stringliteral">              const Index&amp; n,</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="stringliteral">              const Numeric&amp; sigmoy)</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="stringliteral">  ComplexMatrix zop(n, n), zvec(n, n);</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="stringliteral">  ComplexMatrixView inv_zvec = zop;  // Rename to not confuse later operations</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="stringliteral">  ComplexVectorView zval = cmn.Zaa.ZA[Range(0, n)];  // Rename and rescale to right size</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="stringliteral">      zop(j, i) = Complex(cmn.DiagnR.OpR(i, j), cmn.DiagnI.OpI(i, j));  // nb. reverse from Fortran algorithm due to row-col issues</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="stringliteral">  // Main computations</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="stringliteral">  diagonalize(zvec, zval, zop);</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="stringliteral">  inv(inv_zvec, zvec);</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="stringliteral">  // Add average sigma</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="stringliteral">  zval += sigmoy;</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="stringliteral">  // Do the matrix multiplication</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="stringliteral">    cmn.Zss.ZS[i] = 0;</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="stringliteral">    Complex z(0, 0);</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="stringliteral">      cmn.Zss.ZS[i] += cmn.DipoTcm.DipoT(j, iband) * zvec(j, i);</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="stringliteral">      z += cmn.PopuT.PopuT[j] * cmn.DipoTcm.DipoT(j, iband) * inv_zvec(i, j);</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="stringliteral">    cmn.Zss.ZS[i] *= z;</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01211"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#ac63ec64e9bab6f74403f43def7d225fd"> 1211</a></span>&#160;<span class="stringliteral">EqvLinesOut eqvlines(const ConstComplexMatrixView W,</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="stringliteral">                     const ConstVectorView pop,</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="stringliteral">                     const ConstVectorView dip,</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="stringliteral">                     const Numeric&amp; fmean)</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="stringliteral">  // Size of problem</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="stringliteral">  const Index n = pop.nelem();</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="stringliteral">  // Compute values</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="stringliteral">  ComplexMatrix zvec(n, n);</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="stringliteral">  EqvLinesOut out(n);</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="stringliteral">  // Main computations</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="stringliteral">  diagonalize(zvec, out.zval, W);</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="stringliteral">  // Do the matrix forward multiplication</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="stringliteral">      out.zstr[i] += dip[j] * zvec(j, i);</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="stringliteral">  // Do the matrix backward multiplication</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="stringliteral">  auto&amp; inv_zvec=zvec.inv();</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="stringliteral">    Complex z(0, 0);</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="stringliteral">    for (Index j=0; j&lt;n; j++) {</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="stringliteral">      z += pop[j] * dip[j] * inv_zvec(i, j);</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="stringliteral">    out.zstr[i] *= z;</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="stringliteral">  // Add the weighted frequency</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="stringliteral">  out.zval += fmean;</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="stringliteral">  return out;</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="stringliteral">           </span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01250"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a902575f02f0b6cda6340f93805af8e1c"> 1250</a></span>&#160;<span class="stringliteral">void convtp(CommonBlock&amp; cmn,</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="stringliteral">            const Index&amp; iband,</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="stringliteral">            const Index&amp; isotc,</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="stringliteral">            const Index&amp; nlinec,</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="stringliteral">            const Numeric&amp; xh2o,</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="stringliteral">            const Numeric&amp; xco2,</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="stringliteral">            const Numeric&amp; temp,</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="stringliteral">            const Numeric&amp; ptot,</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="stringliteral">            Numeric&amp; sigmoy,</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="stringliteral">            Numeric&amp; gamd_gam0_mx,</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="stringliteral">            const bool mixfull,</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="stringliteral">            const bool mixsdv)</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="stringliteral">  const Numeric ratiot = parameters::T0 / temp;</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="stringliteral">  Numeric qt0_co2, qtt_co2, gsi0, gsit;</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="stringliteral">  qt_co2(parameters::T0, isotc, gsi0, qt0_co2);</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="stringliteral">  qt_co2(temp, isotc, gsit, qtt_co2);</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="stringliteral">  const Numeric ratiopart = qt0_co2 / qtt_co2;</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="stringliteral">  const Numeric sqrtm = std::sqrt(temp / parameters::aMass[isotc-1]);</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="stringliteral">  Numeric sumwgt=0;</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="stringliteral">  sigmoy=0;</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="stringliteral">  for (Index iline=0; iline&lt;nlinec; iline++) {</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="stringliteral">    cmn.PopuT.PopuT[iline]=cmn.PopTrf.PopuT0(iline, iband)*ratiopart*std::exp(-parameters::Ct*cmn.Energy.E(iline, iband)*(1/temp-1/parameters::T0));</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="stringliteral">    if (mixsdv) {</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="stringliteral">      cmn.GamT.HWT[iline] = ((1-xh2o-xco2) * (cmn.GamSDVT0AIR.HWSDVT0AIR(iline, iband) * std::pow(ratiot, cmn.DTGAMAIR.BHWAIR(iline, iband))))</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="stringliteral">      + (xh2o * (cmn.GamSDVT0H2O.HWSDVT0H2O(iline, iband) * std::pow(ratiot, cmn.DTGAMH2O.BHWH2O(iline, iband))))</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="stringliteral">      + (xco2 * (cmn.GamSDVT0CO2.HWSDVT0SELF(iline, iband) * std::pow(ratiot, cmn.DTGAMCO2.BHWSELF(iline, iband))));</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="stringliteral">      cmn.GamT.HWSDV2T[iline] =</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="stringliteral">      ((1-xh2o-xco2) * (cmn.GamSDVT0AIR.HWSDVT0AIR(iline, iband) * cmn.GamSDVT0AIR.rHWT0AIR(iline, iband) * std::pow(ratiot, cmn.DTGAMAIR.BHWAIR(iline, iband))))</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="stringliteral">      + (xh2o * (cmn.GamSDVT0H2O.HWSDVT0H2O(iline, iband)*cmn.GamSDVT0H2O.rHWT0H2O(iline, iband) * std::pow(ratiot, cmn.DTGAMH2O.BHWH2O(iline, iband))))</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="stringliteral">      + (xco2 * (cmn.GamSDVT0CO2.HWSDVT0SELF(iline, iband) * cmn.GamSDVT0CO2.rHWT0SELF(iline, iband) * std::pow(ratiot, cmn.DTGAMCO2.BHWSELF(iline, iband))));</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="stringliteral">    } else {</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="stringliteral">      cmn.GamT.HWT[iline] = ((1-xh2o-xco2) * (cmn.GamVT0AIR.HWVT0AIR(iline,iband) * std::pow(ratiot, cmn.DTGAMAIR.BHWAIR(iline, iband))))</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="stringliteral">      + (xh2o * (cmn.GamVT0H2O.HWVT0H2O(iline, iband) * std::pow(ratiot, cmn.DTGAMH2O.BHWH2O(iline, iband))))</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="stringliteral">      + (xco2 * (cmn.GamVT0CO2.HWVT0SELF(iline, iband) * std::pow(ratiot, cmn.DTGAMCO2.BHWSELF(iline, iband))));</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="stringliteral">    cmn.SHIFT.shft[iline]=cmn.SHIFT0.shft0(iline, iband);</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="stringliteral">    const Numeric wgt = cmn.PopuT.PopuT[iline] * Constant::pow2(cmn.DipoTcm.DipoT(iline, iband));</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="stringliteral">    sumwgt += wgt;</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="stringliteral">    sigmoy += cmn.LineSg.Sig(iline,iband) * wgt;</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="stringliteral">  sigmoy /= sumwgt;</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="stringliteral">  calcw(cmn, nlinec, iband, temp);</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="stringliteral">  // Adjust for pressure</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="stringliteral">  for (Index iline=0; iline&lt;nlinec; iline++) {</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="stringliteral">    cmn.GamT.HWT[iline] *= ptot;</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="stringliteral">    cmn.GamT.HWSDV2T[iline] *= ptot;</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="stringliteral">    cmn.YLT.YT[iline] *= ptot;</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="stringliteral">    const Numeric gamd = parameters::CtGamD * cmn.LineSg.Sig(iline, iband) * sqrtm;</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="stringliteral">    gamd_gam0_mx = std::max(gamd_gam0_mx, gamd/cmn.GamT.HWT[iline]);</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="stringliteral">  if (mixfull) {</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="stringliteral">    for (Index iline=0; iline&lt;nlinec; iline++) {</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="stringliteral">      for (Index ilinep=0; ilinep&lt;nlinec; ilinep++) {</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="stringliteral">        cmn.DiagnI.OpI(iline, ilinep) = ptot * cmn.Wmatrix.W(iline, ilinep);</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="stringliteral">        if (iline == ilinep) {</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="stringliteral">          cmn.DiagnR.OpR(iline, iline) = cmn.LineSg.Sig(iline, iband) - sigmoy + cmn.SHIFT.shft[iline] * ptot;</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="stringliteral">          cmn.DiagnR.OpR(iline, ilinep) = 0;</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="stringliteral">    eqvlines(cmn, iband, nlinec, sigmoy);</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01323"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a3bf9f2794b1ae38576d833cd028f9692"> 1323</a></span>&#160;<span class="stringliteral">ConvTPOut convtp(const ConstVectorView vmrs,</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="stringliteral">                 const HitranRelaxationMatrixData&amp; hitran,</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="stringliteral">                 const AbsorptionLines&amp; band,</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="stringliteral">                 const Numeric T,</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="stringliteral">                 const Numeric P,</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="stringliteral">                 const SpeciesAuxData::AuxType&amp; partition_type,</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="stringliteral">                 const ArrayOfGriddedField1&amp; partition_data)</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="stringliteral">  const Index n = band.NumLines();</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="stringliteral">  const Numeric QT = single_partition_function(T, partition_type, partition_data);</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="stringliteral">  const Numeric QT0 = single_partition_function(band.T0(), partition_type, partition_data);</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="stringliteral">  const Numeric ratiopart = QT0 / QT;</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="stringliteral">  ConvTPOut out(n);</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="stringliteral">  Vector wgt(n);</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="stringliteral">  for (Index i=0; i&lt;n; i++) {</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="stringliteral">    const Numeric pop0 = (band.g_upp(i) / QT0) * boltzman_factor(band.T0(), band.E0(i));</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="stringliteral">    out.f0[i] = band.F0(i);</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="stringliteral">    out.pop[i] = pop0 * ratiopart * boltzman_ratio(T, band.T0(), band.E0(i));</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="stringliteral">    out.hwt[i] = band.Line(i).LineShape().G0(T, band.T0(), 1, vmrs);</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="stringliteral">    out.shft[i] = band.Line(i).LineShape().D0(T, band.T0(), 1, vmrs);</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="stringliteral">    out.dip[i] = std::sqrt(band.I0(i)/(pop0 * band.F0(i) * (1-stimulated_emission(band.T0(), band.F0(i)))));</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="stringliteral">    out.hwt2[i] = band.Line(i).LineShape().G2(T, band.T0(), 1, vmrs);</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="stringliteral">    wgt[i] = out.pop[i] * Constant::pow2(out.dip[i]);</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="stringliteral">  // Calculate the relaxation matrix</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="stringliteral">  calcw(out, hitran, band, T);</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="stringliteral">  // Adjust for pressure</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="stringliteral">  out.hwt *= P;</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="stringliteral">  out.hwt2 *= P;</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="stringliteral">  out.shft *= P;</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="stringliteral">  out.Y *= P;</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="stringliteral">  if (band.Population() == Absorption::PopulationType::ByHITRANFullRelmat) {</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="stringliteral">    const Numeric fmean = band.F_mean(wgt);</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="stringliteral">    out.W.diagonal().real() = out.f0;</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="stringliteral">    out.W.diagonal().real() += out.shft;</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="stringliteral">    out.W.diagonal().real() -= fmean;</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="stringliteral">    out.W.imag() *= P;</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="stringliteral">    out.eqv = eqvlines(out.W, out.pop, out.dip, fmean);</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="stringliteral">  return out;</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01374"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#af397ddb677b56b827ac2fa6c47aa39c2"> 1374</a></span>&#160;<span class="stringliteral">void qsdv(const Numeric&amp; sg0,</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="stringliteral">          const Numeric&amp; gamd,</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="stringliteral">          const Numeric&amp; gam0,</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="stringliteral">          const Numeric&amp; gam2,</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="stringliteral">          const Numeric&amp; shift0,</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="stringliteral">          const Numeric&amp; shift2,</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="stringliteral">          const Numeric&amp; sg,</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="stringliteral">          Numeric&amp; ls_qsdv_r,</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="stringliteral">          Numeric&amp; ls_qsdv_i)</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="stringliteral">  using Constant::pow2;</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="stringliteral">  Complex x , y, csqrty, z1, z2, w1, w2, aterm;</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="stringliteral">  Numeric xz1, yz1, xz2, yz2;</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="stringliteral">  const Numeric cte = Constant::sqrt_ln_2 / gamd;</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="stringliteral">  const Numeric pi = Constant::pi;</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="stringliteral">  const Numeric rpi = Constant::sqrt_pi;</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="stringliteral">  const Complex iz = Complex(0, 1);</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="stringliteral">  const Complex c0 = Complex(gam0, shift0);</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="stringliteral">  const Complex c2 = Complex(gam2, shift2);</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="stringliteral">  const Complex c0t = (c0 - 1.5 * c2);</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="stringliteral">  const Complex c2t = c2;</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="stringliteral">  if (std::abs(c2t) == 0) goto label110;</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="stringliteral">  x = (iz * (sg0 - sg) + c0t) / c2t;</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="stringliteral">  y = 1 / pow2(2 * cte * c2t);</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="stringliteral">  csqrty = (gam2 - iz * shift2) / (2 * cte * (pow2(gam2) + pow2(shift2)));</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="stringliteral">  if (std::abs(x) &lt;= 3.e-8*std::abs(y)) goto label120;  // IN cgs units</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="stringliteral">  if (std::abs(y) &lt;= 1.e-15*std::abs(x)) goto label140;  // IN cgs units</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="stringliteral">  z1 = std::sqrt(x + y) - csqrty;</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="stringliteral">  z2 = z1 + 2 * csqrty;</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="stringliteral">  xz1 = - z1.imag();</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="stringliteral">  yz1 = z1.real();</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="stringliteral">  xz2 = - z2.imag();</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="stringliteral">  yz2 = z2.real();</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="stringliteral">  w1 = Faddeeva::w(Complex(xz1 ,yz1));</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="stringliteral">  w2 = Faddeeva::w(Complex(xz2 ,yz2));</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="stringliteral">  aterm = rpi * cte * (w1 - w2);</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="stringliteral">  goto label10;</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="stringliteral">  label110:</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="stringliteral">  z1 = (iz*(sg0-sg)+c0t)*cte;</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="stringliteral">  xz1 = - z1.imag();</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="stringliteral">  yz1 = z1.real();</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="stringliteral">  w1 = Faddeeva::w(Complex(xz1 ,yz1));</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="stringliteral">  aterm = rpi*cte* w1;</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="stringliteral">  goto label10;</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="stringliteral">  label120:</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="stringliteral">  z1 = (iz*(sg0-sg)+c0t)*cte;</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="stringliteral">  z2 = std::sqrt(x+y)+csqrty;</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="stringliteral">  xz1 = - z1.imag();</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="stringliteral">  yz1 = z1.real();</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="stringliteral">  xz2 = - z2.imag();</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="stringliteral">  yz2 = z2.real();</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="stringliteral">  w1 = Faddeeva::w(Complex(xz1 ,yz1));</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="stringliteral">  w2 = Faddeeva::w(Complex(xz2 ,yz2));</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="stringliteral">  aterm = rpi * cte * (w1-w2);</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="stringliteral">  goto label10;</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="stringliteral">  label140:</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="stringliteral">  if (std::abs(std::sqrt(x)) &lt;= 4.e3) {  // IN cgs</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="stringliteral">    const Numeric xxb = - std::sqrt(x).imag();</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="stringliteral">    const Numeric yxb = std::sqrt(x).real();</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="stringliteral">    const Complex wb = Faddeeva::w(Complex(xxb, yxb));</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="stringliteral">    aterm = (2 * rpi / c2t) * (1 / rpi - std::sqrt(x) * wb);</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="stringliteral">  } else {</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="stringliteral">      aterm = (1 / c2t) * (1 / x - 1.5 / pow2(x));</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="stringliteral">  label10:</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="stringliteral">  const Complex ls_qsdv = (1 / pi) * aterm;</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="stringliteral">  ls_qsdv_r = ls_qsdv.real();</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="stringliteral">  ls_qsdv_i = ls_qsdv.imag();</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="stringliteral">// nb.qsdv times sg0 is qsdv_si times F0</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a2477286d2151f3c80f653f14d8b7a9da"> 1461</a></span>&#160;<span class="stringliteral">Complex qsdv_si(const Numeric F0,</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="stringliteral">                const Numeric gamd,</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="stringliteral">                const Numeric gam0,</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="stringliteral">                const Numeric gam2,</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="stringliteral">                const Numeric shift0,</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="stringliteral">                const Numeric shift2,</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="stringliteral">                const Numeric f)</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="stringliteral">  using Constant::pow2;</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="stringliteral">  Complex x , y, csqrty, z1, z2, w1, w2, aterm;</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="stringliteral">  Numeric xz1, yz1, xz2, yz2;</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="stringliteral">  const Numeric cte = Constant::sqrt_ln_2 / gamd;</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="stringliteral">  const Numeric pi = Constant::pi;</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="stringliteral">  const Numeric rpi = Constant::sqrt_pi;</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="stringliteral">  const Complex iz = Complex(0, 1);</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="stringliteral">  const Complex c0 = Complex(gam0, shift0);</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="stringliteral">  const Complex c2 = Complex(gam2, shift2);</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="stringliteral">  const Complex c0t = (c0 - 1.5 * c2);</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="stringliteral">  const Complex c2t = c2;</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="stringliteral">  if (std::abs(c2t) == 0) goto label110;</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="stringliteral">  x = (iz * (F0 - f) + c0t) / c2t;</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="stringliteral">  y = 1 / pow2(2 * cte * c2t);</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="stringliteral">  csqrty = (gam2 - iz * shift2) / (2 * cte * (pow2(gam2) + pow2(shift2)));</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="stringliteral">  if (std::abs(x) &lt;= 3.e-8*std::abs(y)) goto label120;</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="stringliteral">  if (std::abs(y) &lt;= 1.e-15*std::abs(x)) goto label140;</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="stringliteral">  z1 = std::sqrt(x + y) - csqrty;</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="stringliteral">  z2 = z1 + 2 * csqrty;</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="stringliteral">  xz1 = - z1.imag();</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="stringliteral">  yz1 = z1.real();</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="stringliteral">  xz2 = - z2.imag();</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="stringliteral">  yz2 = z2.real();</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="stringliteral">  w1 = Faddeeva::w(Complex(xz1 ,yz1));</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="stringliteral">  w2 = Faddeeva::w(Complex(xz2 ,yz2));</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="stringliteral">  aterm = rpi * cte * (w1 - w2);</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="stringliteral">  goto label10;</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="stringliteral">  label110:</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="stringliteral">  z1 = (iz*(F0 - f) + c0t)*cte;</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="stringliteral">  xz1 = - z1.imag();</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="stringliteral">  yz1 = z1.real();</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="stringliteral">  w1 = Faddeeva::w(Complex(xz1 ,yz1));</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="stringliteral">  aterm = rpi*cte* w1;</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="stringliteral">  goto label10;</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="stringliteral">  label120:</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="stringliteral">  z1 = (iz*(F0 - f) + c0t)*cte;</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="stringliteral">  z2 = std::sqrt(x+y)+csqrty;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="stringliteral">  xz1 = - z1.imag();</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="stringliteral">  yz1 = z1.real();</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="stringliteral">  xz2 = - z2.imag();</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="stringliteral">  yz2 = z2.real();</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="stringliteral">  w1 = Faddeeva::w(Complex(xz1 ,yz1));</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="stringliteral">  w2 = Faddeeva::w(Complex(xz2 ,yz2));</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="stringliteral">  aterm = rpi * cte * (w1-w2);</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="stringliteral">  goto label10;</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="stringliteral">  label140:</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="stringliteral">  if (std::abs(std::sqrt(x)) &lt;= 4.e3) {  // IN cgs</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="stringliteral">    const Numeric xxb = - std::sqrt(x).imag();</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="stringliteral">    const Numeric yxb = std::sqrt(x).real();</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="stringliteral">    const Complex wb = Faddeeva::w(Complex(xxb, yxb));</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="stringliteral">    aterm = (2 * rpi / c2t) * (1 / rpi - std::sqrt(x) * wb);</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="stringliteral">  } else {</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="stringliteral">    aterm = (1 / c2t) * (1 / x - 1.5 / pow2(x));</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="stringliteral">  label10:</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="stringliteral">  return (1 / pi) * aterm;</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#aaa9512b0d03500ea982fbe9d5b869d4e"> 1541</a></span>&#160;<span class="stringliteral">void compabs(</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="stringliteral">  CommonBlock&amp; cmn,</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="stringliteral">  const Numeric&amp; temp,</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="stringliteral">  const Numeric&amp; ptot,</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="stringliteral">  const Numeric&amp; xco2,</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="stringliteral">  const Numeric&amp; xh2o,</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="stringliteral">  const ConstVectorView invcm_grid,</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="stringliteral">  const bool mixsdv,</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="stringliteral">  const bool mixfull,</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="stringliteral">  VectorView absv,</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="stringliteral">  VectorView absy,</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="stringliteral">  VectorView absw)</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="stringliteral">  using Constant::pow2;</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="stringliteral">  using Constant::pow3;</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="stringliteral">  constexpr Numeric rdmult = 30;</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="stringliteral">  // Number of points to compute</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="stringliteral">  const Index nsig = invcm_grid.nelem();</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="stringliteral">  // Set to zero</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="stringliteral">  absv = 0;</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="stringliteral">  absy = 0;</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="stringliteral">  absw = 0;</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="stringliteral">  constexpr Numeric sq_ln2 = Constant::sqrt_ln_2;</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="stringliteral">  constexpr Numeric sq_ln2pi = sq_ln2 / Constant::sqrt_pi;</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="stringliteral">  const Numeric dens = xco2 * ptot * parameters::aMolAtm / temp;</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="stringliteral">  constexpr Numeric u_pi = Constant::inv_pi;</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="stringliteral">  constexpr Numeric u_sqln2pi = 1 / sq_ln2pi;</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="stringliteral">  for (Index iband=0; iband&lt;cmn.Bands.nBand; iband++) {</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="stringliteral">    Numeric sigmoy=0;</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="stringliteral">    Numeric gamdmx=0;</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="stringliteral">    convtp(cmn, iband, cmn.Bands.Isot[iband], cmn.Bands.nLines[iband],</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="stringliteral">           xh2o, xco2, temp, ptot, sigmoy, gamdmx, mixfull, mixsdv);</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="stringliteral">    const Numeric sqrtm = std::sqrt(temp / parameters::aMass[cmn.Bands.Isot[iband]-1]);</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="stringliteral">    const Numeric ds0=(70.67e0+104.1e0*0.21e0*std::pow(gamdmx, 6.4))/(1.0+0.21*std::pow(gamdmx, 5.4));</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="stringliteral">    const Numeric ds2=(34.97e0+105.e0*9.e0*std::pow(gamdmx, 3.1))/(1.0+9.0*std::pow(gamdmx, 2.1));</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="stringliteral">    for (Index isig=0; isig&lt;nsig; isig++) {</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="stringliteral">      const Numeric sigc = invcm_grid[isig];</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="stringliteral">      for (Index iline=0; iline&lt;cmn.Bands.nLines[iband]; iline++) {</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="stringliteral">        const Numeric gamd=parameters::CtGamD*cmn.LineSg.Sig(iline,iband)*sqrtm;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="stringliteral">        const Numeric cte = sq_ln2 / gamd;</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="stringliteral">        const Numeric popudipo = cmn.PopuT.PopuT[iline] * pow2(cmn.DipoTcm.DipoT(iline, iband));</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="stringliteral">        const Numeric dsigc = sigc - cmn.LineSg.Sig(iline, iband) - cmn.SHIFT.shft[iline] * ptot;</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="stringliteral">        if (mixsdv) {</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="stringliteral">          if (std::abs(dsigc) / cmn.GamT.HWT[iline] &gt; ds0) {</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="stringliteral">            absv[isig] += popudipo * u_sqln2pi * u_pi * cmn.GamT.HWT[iline] / (pow2(cmn.GamT.HWT[iline]) + pow2(dsigc));</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="stringliteral">            absy[isig] += popudipo * u_sqln2pi * u_pi * (cmn.GamT.HWT[iline] + cmn.YLT.YT[iline]*dsigc) / (pow2(cmn.GamT.HWT[iline]) + pow2(dsigc));</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="stringliteral">          } else if (std::abs(dsigc) / cmn.GamT.HWT[iline] &gt; ds2 and </span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="stringliteral">                     std::abs(dsigc) / cmn.GamT.HWT[iline] &lt; ds0) {</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="stringliteral">            const Numeric order2r = cmn.GamT.HWT[iline] / (pow2(cmn.GamT.HWT[iline]) + pow2(dsigc))</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="stringliteral">            + 3 * pow2(cmn.GamT.HWSDV2T[iline]) * (pow3(cmn.GamT.HWT[iline]) - 3 * cmn.GamT.HWT[iline]*pow2(dsigc)) / </span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="stringliteral">            (2*Constant::pi*pow3(pow2(cmn.GamT.HWT[iline]) + pow2(dsigc)));</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="stringliteral">            const Numeric order2i = dsigc / (pow2(cmn.GamT.HWT[iline]) + pow2(dsigc)) +</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="stringliteral">            3 * pow2(cmn.GamT.HWSDV2T[iline]) *(3*pow2(cmn.GamT.HWT[iline])*dsigc-pow3(dsigc)) / </span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="stringliteral">            (2*Constant::pi*pow3(pow2(cmn.GamT.HWT[iline]) + pow2(dsigc)));</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="stringliteral">            absv[isig] += popudipo * u_sqln2pi * u_pi * order2r;</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="stringliteral">            absy[isig] += popudipo * u_sqln2pi * u_pi * (order2r + cmn.YLT.YT[iline]*order2i);</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="stringliteral">          } else {</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="stringliteral">            const Numeric shft0 = cmn.SHIFT.shft[iline] * ptot;</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="stringliteral">            Numeric wr=0, wi=0;</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="stringliteral">            qsdv(cmn.LineSg.Sig(iline, iband), gamd, cmn.GamT.HWT[iline], cmn.GamT.HWSDV2T[iline], shft0, 0, sigc, wr, wi);</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="stringliteral">            absv[isig] += popudipo * wr * u_sqln2pi;</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="stringliteral">            absy[isig] += popudipo * u_sqln2pi * (wr - cmn.YLT.YT[iline] * wi);</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="stringliteral">          if (std::abs(cmn.LineSg.Sig(iline, iband)-sigc) &gt; (rdmult*gamd)) {  // NOTE: Removed in updated version of the code...</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="stringliteral">            absv[isig] += popudipo * u_sqln2pi * u_pi * cmn.GamT.HWT[iline] / (pow2(cmn.GamT.HWT[iline]) + pow2(dsigc));</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="stringliteral">            absy[isig] += popudipo * u_sqln2pi * u_pi * (cmn.GamT.HWT[iline] + cmn.YLT.YT[iline] * dsigc) / (pow2(cmn.GamT.HWT[iline]) + pow2(dsigc));</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="stringliteral">          } else {</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="stringliteral">            const Numeric yy = cmn.GamT.HWT[iline] * cte;</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="stringliteral">            const Numeric xx= (cmn.LineSg.Sig(iline, iband)+cmn.SHIFT.shft[iline] * ptot - sigc) * cte;</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="stringliteral">            const Complex w = Faddeeva::w(Complex(xx, yy));</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="stringliteral">            absv[isig] += popudipo * w.real() / gamd;</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="stringliteral">            </span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="stringliteral">            absy[isig] += popudipo * (w.real() - cmn.YLT.YT[iline] * w.imag()) / gamd;</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="stringliteral">          }</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="stringliteral">        if (mixfull) {</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="stringliteral">          /*const Numeric gamd_int=parameters::CtGamD*(cmn.FicLPR.AlphR[iline] + sigmoy)*sqrtm;</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="stringliteral">          const Numeric cte_int = sq_ln2 / gamd_int;</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="stringliteral">          if (std::abs(cmn.FicLPI.AlphI[iline] + sigmoy - sigc) &lt;= (rdmult*gamd_int)) {</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="stringliteral">            const Complex z = Complex(cmn.FicLPR.AlphR[iline] + sigmoy - sigc, cmn.FicLPI.AlphI[iline]) * cte_int;</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="stringliteral">            const Complex w = Faddeeva::w(z);</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="stringliteral">            absw[isig] += (cmn.FicLSR.SSR[iline] * w.real() - cmn.FicLSI.SSI[iline] * w.imag()) / cte_int;</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="stringliteral">        }*/</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="stringliteral">          absw[isig] += u_sqln2pi * u_pi * (cmn.Zss.ZS[iline] / (sigc - cmn.Zaa.ZA[iline])).imag();</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="stringliteral">  for (Index isig=0; isig&lt;nsig; isig++) {</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="stringliteral">    const Numeric sigc = invcm_grid[isig];</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="stringliteral">    const Numeric fact = sigc * (1-std::exp(-parameters::Ct * sigc / temp));</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="stringliteral">    absv[isig] *= fact * dens * sq_ln2pi;</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="stringliteral">    absy[isig] *= fact * dens * sq_ln2pi;</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="stringliteral">    absw[isig] *= fact * dens * sq_ln2pi;</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01658"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a105a100bd8f6e47a841a0b6807946490"> 1658</a></span>&#160;<span class="stringliteral">Vector compabs(</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="stringliteral">  const Numeric T,</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="stringliteral">  const Numeric P,</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="stringliteral">  const HitranRelaxationMatrixData&amp; hitran,</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="stringliteral">  const ArrayOfAbsorptionLines&amp; bands,</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="stringliteral">  const ConstVectorView vmrs,</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="stringliteral">  const ConstVectorView f_grid,</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="stringliteral">  const SpeciesAuxData&amp; partition_functions)</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="stringliteral">  using Constant::pow2;</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="stringliteral">  using Constant::pow3;</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="stringliteral">  // Number of points to compute</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="stringliteral">  const Index nf = f_grid.nelem();</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="stringliteral">  // Set to zero</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="stringliteral">  Vector absorption(nf, 0);</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="stringliteral">  constexpr Numeric sq_ln2 = Constant::sqrt_ln_2;</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="stringliteral">  constexpr Numeric sq_ln2pi = sq_ln2 / Constant::sqrt_pi;</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="stringliteral">  const Numeric dens = vmrs[2] * number_density(P, T);</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="stringliteral">  constexpr Numeric u_pi = Constant::inv_pi;</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="stringliteral">  constexpr Numeric u_sqln2pi = 1 / sq_ln2pi;</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="stringliteral">  for (Index iband=0; iband&lt;bands.nelem(); iband++) {</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="stringliteral">    auto tp = convtp(vmrs, hitran, bands[iband], T, P, partition_functions.getParamType(bands[iband].QuantumIdentity()), partition_functions.getParam(bands[iband].QuantumIdentity()));</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="stringliteral">    const Numeric GD_div_F0 = Linefunctions::DopplerConstant(T, bands[iband].SpeciesMass());</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="stringliteral">    const bool nolm = not bands[iband].DoLineMixing(P);</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="stringliteral">    const bool sdvp = bands[iband].LineShapeType() == LineShape::Type::SDVP;</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="stringliteral">    const bool vp = bands[iband].LineShapeType() == LineShape::Type::VP;</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="stringliteral">    const bool rosenkranz = bands[iband].Population() == Absorption::PopulationType::ByHITRANRosenkranzRelmat;</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="stringliteral">    const bool full = bands[iband].Population() == Absorption::PopulationType::ByHITRANFullRelmat;</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="stringliteral">    for (Index iv=0; iv&lt;nf; iv++) {</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="stringliteral">      const Numeric f = f_grid[iv];</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="stringliteral">      Numeric a=0;</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="stringliteral">      for (Index iline=0; iline&lt;bands[iband].NumLines(); iline++) {</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="stringliteral">        const Numeric gamd=GD_div_F0 * tp.f0[iline];</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="stringliteral">        const Numeric gamd_mod=GD_div_F0 * tp.eqv.zval[iline].real();</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="stringliteral">        const Numeric cte = sq_ln2 / gamd;</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="stringliteral">        const Numeric cte_mod = sq_ln2 / gamd_mod;</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="stringliteral">        const Numeric popudipo = tp.pop[iline] * pow2(tp.dip[iline]);</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="stringliteral">        if (rosenkranz and sdvp and nolm) {</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="stringliteral">          const Complex w = qsdv_si(tp.f0[iline], gamd, tp.hwt[iline], tp.hwt2[iline], tp.shft[iline], 0, f);</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="stringliteral">          a += popudipo * w.real() * u_sqln2pi;</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="stringliteral">        } else if (rosenkranz and sdvp) {</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="stringliteral">          const Complex w = qsdv_si(tp.f0[iline], gamd, tp.hwt[iline], tp.hwt2[iline], tp.shft[iline], 0, f);</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="stringliteral">          a += popudipo * u_sqln2pi * (Complex(1, tp.Y[iline]) * w).real();  // NB. Changing sign on Y gave positive absorption but is not agreeing with measurements according to HITRAN data</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="stringliteral">        } else if ((rosenkranz and vp and nolm) or (full and nolm)) {</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="stringliteral">          const Numeric yy = tp.hwt[iline] * cte;</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="stringliteral">          const Numeric xx = (tp.f0[iline]+tp.shft[iline] - f) * cte;</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="stringliteral">          const Complex w = Faddeeva::w(Complex(xx, yy));</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="stringliteral">          a += popudipo * w.real() / gamd;</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="stringliteral">        } else if (rosenkranz and vp) {</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="stringliteral">          const Numeric yy = tp.hwt[iline] * cte;</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="stringliteral">          const Numeric xx = (tp.f0[iline]+tp.shft[iline] - f) * cte;</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="stringliteral">          const Complex w = Faddeeva::w(Complex(xx, yy));</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="stringliteral">          a += popudipo * (Complex(1, tp.Y[iline]) * w).real() / gamd;  // NB. Changing sign on Y gave positive absorption but is not agreeing with measurements according to HITRAN data</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="stringliteral">        } else if (full and vp) {</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="stringliteral">          const Complex z = (tp.eqv.zval[iline]-f) * cte_mod;</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="stringliteral">          const Complex w = Faddeeva::w(z);</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="stringliteral">          a += (tp.eqv.zstr[iline] * w).real() / gamd_mod;</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="stringliteral">        } else if (full) {</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="stringliteral">          a += u_sqln2pi * u_pi * (tp.eqv.zstr[iline] / (f - tp.eqv.zval[iline])).imag();</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="stringliteral">          throw std::runtime_error(&quot;Cannot understand the combination of calculations requested...&quot;);</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="stringliteral">      // Guard to not allow negative absorption inside a band</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="stringliteral">      if (a &gt; 0)</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="stringliteral">        absorption[iv] += a;</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="stringliteral">  for (Index iv=0; iv&lt;nf; iv++) {</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="stringliteral">    const Numeric f = f_grid[iv];</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="stringliteral">    const Numeric fact = f * (1 - stimulated_emission(T, f));</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="stringliteral">    absorption[iv] *= fact * dens * sq_ln2pi;</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="stringliteral">  return absorption;</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01745"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a5465a9c80e8c879717ddc735ca928ebb"> 1745</a></span>&#160;<span class="stringliteral">void detband(CommonBlock&amp; cmn,</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="stringliteral">             const Numeric&amp; sgminr,</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="stringliteral">             const Numeric&amp; sgmaxr,</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="stringliteral">             const Numeric&amp; stotmax,</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="stringliteral">             const String&amp; basedir=&quot;data_new/&quot;)</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="stringliteral">  cmn.Bands.nBand=0;</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="stringliteral">  std::ifstream fortranfile;</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="stringliteral">  fortranfile.open(basedir + &quot;/BandInfo.dat&quot;);</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="stringliteral">  if (not fortranfile.is_open())</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="stringliteral">    throw std::runtime_error(&quot;Cannot read the file.  Please make sure you point at BandInfo.dat basedir and have the right to read.&quot;);</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="stringliteral">  String line;</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="stringliteral">  getline(fortranfile, line);</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="stringliteral">  while (fortranfile.good()) {</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="stringliteral">    Numeric stot, sgmin, sgmax;</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="stringliteral">    Index isotr, lfr, lir, jmxp, jmxq, jmxr;</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="stringliteral">    char c11, c12, c21, c22, c31, c32, c41, c42, c51, c52, x;</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="stringliteral">    sscanf(line.c_str(), </span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="stringliteral">           &quot;%1ld&quot;</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="stringliteral">           &quot;%c%c&quot; &quot;%1ld&quot; &quot;%c%c&quot;</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="stringliteral">           &quot;%c%c&quot; &quot;%1ld&quot; &quot;%c%c&quot;</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="stringliteral">           &quot;%c%c&quot;</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="stringliteral">           &quot;%12lf&quot;</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="stringliteral">           &quot;%c&quot; &quot;%12lf&quot;</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="stringliteral">           &quot;%c&quot; &quot;%12lf&quot;</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="stringliteral">           &quot;%c%c%c%c%c%c%c%c&quot;</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="stringliteral">           &quot;%4ld&quot; &quot;%4ld&quot; &quot;%4ld&quot;,</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="stringliteral">           &amp;isotr,</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="stringliteral">           &amp;c11, &amp;c12, &amp;lfr, &amp;c21, &amp;c22,</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="stringliteral">           &amp;c31, &amp;c32, &amp;lir, &amp;c41, &amp;c42,</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="stringliteral">           &amp;c51, &amp;c52,</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="stringliteral">           &amp;stot,</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="stringliteral">           &amp;x, &amp;sgmin,</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="stringliteral">           &amp;x, &amp;sgmax,</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="stringliteral">           &amp;x, &amp;x, &amp;x, &amp;x, &amp;x, &amp;x, &amp;x, &amp;x,</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="stringliteral">           &amp;jmxp, &amp;jmxq, &amp;jmxr);</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="stringliteral">    getline(fortranfile, line);</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="stringliteral">    if (stot &lt; stotmax)</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="stringliteral">      continue;</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="stringliteral">    if ((sgminr &lt; sgmax) and (sgmaxr &gt; sgmin)) {</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="stringliteral">      cmn.Bands.Isot[cmn.Bands.nBand] = isotr;</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="stringliteral">      if (isotr == 0)</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="stringliteral">        cmn.Bands.Isot[cmn.Bands.nBand] = 10;</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="stringliteral">      cmn.Bands.li[cmn.Bands.nBand] = lir;</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="stringliteral">      cmn.Bands.lf[cmn.Bands.nBand] = lfr;</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="stringliteral">      if (jmxp &lt; 40 or jmxr &lt; 40) cmn.Bands.li[cmn.Bands.nBand] = 55;</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="stringliteral">      if (jmxq &gt;= 0 and jmxq &lt; 40) cmn.Bands.li[cmn.Bands.nBand] = 55;</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="stringliteral">      char name[15];</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="stringliteral">      sprintf(name, &quot;S%ld%c%c%ld%c%c%c%c%ld%c%c%c%c&quot;, isotr, c11, c12, lfr, c21, c22, c31, c32, lir, c41, c42, c51, c52);</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="stringliteral">      cmn.Bands.BandFile[cmn.Bands.nBand] = name;</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="stringliteral">      cmn.Bands.nBand++;</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="stringliteral">      if (cmn.Bands.nBand &gt; parameters::nBmx) {</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="stringliteral">        throw std::runtime_error(&quot;Too many bands&quot;);</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="stringliteral">  fortranfile.close();</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01810"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a4aaf677977c3b581cf4d05f4399aab1c"> 1810</a></span>&#160;<span class="stringliteral">void readw(CommonBlock&amp; cmn, const String&amp; basedir=&quot;data_new/&quot;)</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="stringliteral">  for (Index l=0; l&lt;=8; l++) {</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="stringliteral">    for (Index ideltal=0; ideltal&lt;=1; ideltal++) {</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="stringliteral">      const Index lli = l;</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="stringliteral">      const Index llf = l + ideltal;</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="stringliteral">      const String cr = std::to_string(lli) + std::to_string(llf);</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="stringliteral">      std::ifstream fortranfile;</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="stringliteral">      const String fname = basedir + String(&quot;/WTfit&quot;) + cr + String(&quot;.dat&quot;);</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="stringliteral">      fortranfile.open(fname.c_str());</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="stringliteral">      String line;</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="stringliteral">      getline(fortranfile, line);</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="stringliteral">      while (fortranfile.good()) {</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="stringliteral">        char sw0r[21], sb0r[21];</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="stringliteral">        Numeric dmaxdt, wtmax;</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="stringliteral">        Index jic, jfc, jipc, jfpc;</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="stringliteral">        sscanf(line.c_str(), </span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="stringliteral">               &quot;%20s&quot; &quot;%20s&quot;</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="stringliteral">               &quot;%14lf&quot; &quot;%14lf&quot;</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="stringliteral">               &quot;%4ld&quot; &quot;%4ld&quot; &quot;%4ld&quot; &quot;%4ld&quot;,</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="stringliteral">               sw0r, sb0r, &amp;dmaxdt, &amp;wtmax, &amp;jic, &amp;jfc, &amp;jipc, &amp;jfpc);</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="stringliteral">        String ssw0r = sw0r;</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="stringliteral">        std::replace(ssw0r.begin(), ssw0r.end(), &#39;</span>D<span class="stringliteral">&#39;, &#39;</span>E<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="stringliteral">        const Numeric w0r = std::stod(ssw0r);</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="stringliteral">        String ssb0r = sb0r;</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="stringliteral">        std::replace(ssb0r.begin(), ssb0r.end(), &#39;</span>D<span class="stringliteral">&#39;, &#39;</span>E<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="stringliteral">        const Numeric b0r = std::stod(ssb0r);</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="stringliteral">        getline(fortranfile, line);</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="stringliteral">        if (lli &gt; cmn.Wfittedp.W0pp.nbooks() or</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="stringliteral">            llf &gt; cmn.Wfittedp.W0pp.npages() or</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="stringliteral">            jic &gt; cmn.Wfittedp.W0pp.nrows() or</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="stringliteral">            jipc &gt; cmn.Wfittedp.W0pp.ncols())</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="stringliteral">          throw std::runtime_error(&quot;Out of bounds in reading...&quot;);</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="stringliteral">          </span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="stringliteral">        if (jic &gt; jfc and jipc &gt; jfpc) {</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="stringliteral">          cmn.Wfittedp.W0pp(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="stringliteral">          cmn.Bfittedp.B0pp(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="stringliteral">        } else if(jic &gt; jfc and jipc == jfpc) {</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="stringliteral">          cmn.Wfittedp.W0pq(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="stringliteral">          cmn.Bfittedp.B0pq(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="stringliteral">        } else if(jic &gt; jfc and jipc &lt; jfpc) {</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="stringliteral">          cmn.Wfittedp.W0pr(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="stringliteral">          cmn.Bfittedp.B0pr(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="stringliteral">        } else if(jic &lt; jfc and jipc &gt; jfpc) {</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="stringliteral">          cmn.Wfittedr.W0rp(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="stringliteral">          cmn.Bfittedr.B0rp(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="stringliteral">        } else if(jic &lt; jfc and jipc == jfpc) {</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="stringliteral">          cmn.Wfittedr.W0rq(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="stringliteral">          cmn.Bfittedr.B0rq(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="stringliteral">        } else if(jic &lt; jfc and jipc &lt; jfpc) {</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="stringliteral">          cmn.Wfittedr.W0rr(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="stringliteral">          cmn.Bfittedr.B0rr(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="stringliteral">        } else if(jic == jfc and jipc &gt; jfpc) {</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="stringliteral">          cmn.Wfittedq.W0qp(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="stringliteral">          cmn.Bfittedq.B0qp(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="stringliteral">        } else if(jic == jfc and jipc == jfpc) {</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="stringliteral">          cmn.Wfittedq.W0qq(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="stringliteral">          cmn.Bfittedq.B0qq(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="stringliteral">        } else if(jic == jfc and jipc &lt; jfpc) {</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="stringliteral">          cmn.Wfittedq.W0qr(lli,llf,jic,jipc) = w0r;</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="stringliteral">          cmn.Bfittedq.B0qr(lli,llf,jic,jipc) = b0r;</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01882"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a03c6bea0611b61f93a79f1a0f27174d5"> 1882</a></span>&#160;<span class="stringliteral">Vector compute(const Numeric p, const Numeric t, const Numeric xco2, const Numeric xh2o, const ConstVectorView invcm_grid, const Numeric stotmax, const calctype type)</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="stringliteral">  const Index n = invcm_grid.nelem();</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="stringliteral">  Vector absorption(n);</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="stringliteral">  if (not n)</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="stringliteral">    return absorption;</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="stringliteral">  // Common setup and main IO</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="stringliteral">  CommonBlock cmn;</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="stringliteral">  detband(cmn, invcm_grid[0], invcm_grid[n-1], stotmax);</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="stringliteral">  readw(cmn);</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="stringliteral">  readlines(cmn);</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="stringliteral">  Vector absv(n);</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="stringliteral">  Vector absy(n);</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="stringliteral">  Vector absw(n);</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="stringliteral">  if (type == calctype::FullVP or type == calctype::FullRosenkranz or type == calctype::FullW)</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="stringliteral">    compabs(cmn, t,p, xco2, xh2o, invcm_grid, false, true, absv, absy, absw);</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="stringliteral">  else if (type == calctype::SDVP or type == calctype::SDRosenkranz or type == calctype::SDW)</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="stringliteral">    compabs(cmn, t,p, xco2, xh2o, invcm_grid, true, false, absv, absy, absw);</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="stringliteral">  else if (type == calctype::NoneVP or type == calctype::NoneRosenkranz or type == calctype::NoneW)</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="stringliteral">    compabs(cmn, t,p, xco2, xh2o, invcm_grid, false, false, absv, absy, absw);  </span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="stringliteral">  switch(type) {</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="stringliteral">    case calctype::FullVP:</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="stringliteral">    case calctype::SDVP:</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="stringliteral">    case calctype::NoneVP:</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="stringliteral">      for (Index i=0; i&lt;n; i++)</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="stringliteral">        absorption[i] = absv[i];</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="stringliteral">      break;</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="stringliteral">    case calctype::FullRosenkranz:</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="stringliteral">    case calctype::SDRosenkranz:</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="stringliteral">    case calctype::NoneRosenkranz:</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="stringliteral">      for (Index i=0; i&lt;n; i++)</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="stringliteral">        absorption[i] = absy[i];</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="stringliteral">      break;</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="stringliteral">    case calctype::FullW:</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="stringliteral">    case calctype::SDW:</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="stringliteral">    case calctype::NoneW:</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="stringliteral">      for (Index i=0; i&lt;n; i++)</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="stringliteral">        absorption[i] = absw[i];</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="stringliteral">      break;</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="stringliteral">  return absorption;</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01929"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a6d383fddda971485b0f5f149557d0267"> 1929</a></span>&#160;<span class="stringliteral">Vector compute(const HitranRelaxationMatrixData&amp; hitran,</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="stringliteral">               const ArrayOfAbsorptionLines&amp; bands,</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="stringliteral">               const Numeric P,</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="stringliteral">               const Numeric T,</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="stringliteral">               const ConstVectorView vmrs,</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="stringliteral">               const ConstVectorView f_grid,</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="stringliteral">               const SpeciesAuxData&amp; partition_functions)</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="stringliteral">  return f_grid.nelem() ? compabs(T, P, hitran, bands, vmrs, f_grid, partition_functions) : Vector(0);</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01940"></a><span class="lineno"><a class="line" href="namespacelm__hitran__2017.html#a18aa940e88d19d1b5a232c935504e583"> 1940</a></span>&#160;<span class="stringliteral">void read(HitranRelaxationMatrixData&amp; hitran, ArrayOfAbsorptionLines&amp; bands, const String&amp; basedir, const Numeric linemixinglimit, const Numeric fmin, const Numeric fmax, const Numeric stot, const ModeOfLineMixing mode)</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="stringliteral">{</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="stringliteral">  String newbase = basedir;</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="stringliteral">  if (newbase.nelem() == 0)</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="stringliteral">    newbase = &quot;.&quot;;</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="stringliteral">  CommonBlock cmn;</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="stringliteral">  detband(cmn, Conversion::freq2kaycm(fmin), Conversion::freq2kaycm(fmax), Conversion::arts2hitran_linestrength(stot), newbase);</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="stringliteral">  readw(cmn, newbase);</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="stringliteral">  readlines(cmn, newbase);</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="stringliteral">  Numeric linemixinglimit_internal=0;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="stringliteral">  switch(mode) {</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="stringliteral">    case ModeOfLineMixing::VP:</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="stringliteral">    case ModeOfLineMixing::SDVP: break;</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="stringliteral">    case ModeOfLineMixing::FullW:</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="stringliteral">    case ModeOfLineMixing::VP_W:</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="stringliteral">    case ModeOfLineMixing::VP_Y:</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="stringliteral">    case ModeOfLineMixing::SDVP_Y: linemixinglimit_internal=linemixinglimit; break;</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="stringliteral">    default: throw std::runtime_error(&quot;Bad mode input.  Must update function.&quot;);</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="stringliteral">  const auto lstype = typeLP(mode) ? </span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="stringliteral">  LineShape::Type::LP :</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="stringliteral">  (typeVP(mode) ? </span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="stringliteral">  LineShape::Type::VP : </span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="stringliteral">  LineShape::Type::SDVP) ;</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="stringliteral">  const auto poptype = typeFull(mode) ?</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="stringliteral">  Absorption::PopulationType::ByHITRANFullRelmat :</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="stringliteral">  Absorption::PopulationType::ByHITRANRosenkranzRelmat ;</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="stringliteral">  auto specs=stdarrayify(</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-626&quot;),</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-636&quot;),</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-628&quot;),</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-627&quot;),</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-638&quot;),</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-637&quot;),</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-828&quot;),</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-728&quot;),</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-727&quot;),</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-838&quot;),</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="stringliteral">    SpeciesTag(&quot;CO2-837&quot;));</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="stringliteral">  // Move data from Fortran-style common block to ARTS</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="stringliteral">  hitran.B0pp = std::move(cmn.Bfittedp.B0pp);</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="stringliteral">  hitran.B0pq = std::move(cmn.Bfittedp.B0pq);</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="stringliteral">  hitran.B0pr = std::move(cmn.Bfittedp.B0pr);</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="stringliteral">  hitran.W0pp = std::move(cmn.Wfittedp.W0pp);</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="stringliteral">  hitran.W0pq = std::move(cmn.Wfittedp.W0pq);</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="stringliteral">  hitran.W0pr = std::move(cmn.Wfittedp.W0pr);</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="stringliteral">  hitran.B0qp = std::move(cmn.Bfittedq.B0qp);</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="stringliteral">  hitran.B0qq = std::move(cmn.Bfittedq.B0qq);</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="stringliteral">  hitran.B0qr = std::move(cmn.Bfittedq.B0qr);</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="stringliteral">  hitran.W0qp = std::move(cmn.Wfittedq.W0qp);</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="stringliteral">  hitran.W0qq = std::move(cmn.Wfittedq.W0qq);</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="stringliteral">  hitran.W0qr = std::move(cmn.Wfittedq.W0qr);</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="stringliteral">  hitran.B0rp = std::move(cmn.Bfittedr.B0rp);</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="stringliteral">  hitran.B0rq = std::move(cmn.Bfittedr.B0rq);</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="stringliteral">  hitran.B0rr = std::move(cmn.Bfittedr.B0rr);</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="stringliteral">  hitran.W0rp = std::move(cmn.Wfittedr.W0rp);</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="stringliteral">  hitran.W0rq = std::move(cmn.Wfittedr.W0rq);</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="stringliteral">  hitran.W0rr = std::move(cmn.Wfittedr.W0rr);</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="stringliteral">  // Reshape to band count size</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="stringliteral">  bands.resize(cmn.Bands.nBand);</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="stringliteral">  for (Index i{0}; i&lt;cmn.Bands.nBand; i++) {</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="stringliteral">    QuantumNumbers outer_upper;</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="stringliteral">    outer_upper[QuantumNumberType::l1] = Rational(cmn.Bands.li[i]);</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="stringliteral">    outer_upper[QuantumNumberType::v1] = cmn.UnusedBandParams.iv1[i];</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="stringliteral">    outer_upper[QuantumNumberType::v2] = cmn.UnusedBandParams.iv2[i];</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="stringliteral">    outer_upper[QuantumNumberType::l2] = cmn.UnusedBandParams.il2[i];</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="stringliteral">    outer_upper[QuantumNumberType::v3] = cmn.UnusedBandParams.iv3[i];</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="stringliteral">    outer_upper[QuantumNumberType::r] = cmn.UnusedBandParams.ir[i];</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="stringliteral">    QuantumNumbers outer_lower;</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="stringliteral">    outer_lower[QuantumNumberType::l1] = Rational(cmn.Bands.lf[i]);</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="stringliteral">    outer_lower[QuantumNumberType::v1] = cmn.UnusedBandParams.fv1[i];</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="stringliteral">    outer_lower[QuantumNumberType::v2] = cmn.UnusedBandParams.fv2[i];</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="stringliteral">    outer_lower[QuantumNumberType::l2] = cmn.UnusedBandParams.fl2[i];</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="stringliteral">    outer_lower[QuantumNumberType::v3] = cmn.UnusedBandParams.fv3[i];</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="stringliteral">    outer_lower[QuantumNumberType::r] = cmn.UnusedBandParams.fr[i];</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="stringliteral">    </span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="stringliteral">    bands[i] = {true,</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="stringliteral">                true,</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="stringliteral">                Absorption::CutoffType::None,</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="stringliteral">                Absorption::MirroringType::None,</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="stringliteral">                poptype,</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="stringliteral">                Absorption::NormalizationType::None,</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="stringliteral">                lstype,</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="stringliteral">                296,</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="stringliteral">                -1,</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="stringliteral">                linemixinglimit_internal,</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="stringliteral">                {specs[cmn.Bands.Isot[i]-1].Species(),</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="stringliteral">                specs[cmn.Bands.Isot[i]-1].Isotopologue(),</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="stringliteral">                outer_upper, outer_lower},</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="stringliteral">                {QuantumNumberType::J},</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="stringliteral">                {SpeciesTag(&quot;N2&quot;), SpeciesTag(&quot;H2O&quot;), specs[cmn.Bands.Isot[i]-1]}};</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="stringliteral">                       </span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="stringliteral">    bands[i].AllLines().resize(cmn.Bands.nLines[i]);</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="stringliteral">    for (Index j{0}; j&lt;cmn.Bands.nLines[i]; j++) {</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="stringliteral">      const std::vector&lt;Rational&gt; inner_upper{Rational(cmn.Jiln.Ji(j, i))};</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="stringliteral">      const std::vector&lt;Rational&gt; inner_lower{Rational(cmn.Jfln.Jf(j, i))};</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters G0_sdvp_air{LineShape::TemperatureModel::T1,</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="stringliteral">        Conversion::hitran2arts_broadening(cmn.GamSDVT0AIR.HWSDVT0AIR(j, i)), </span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="stringliteral">        cmn.DTGAMAIR.BHWAIR(j, i)};</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters G0_sdvp_h2o{LineShape::TemperatureModel::T1,</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="stringliteral">        Conversion::hitran2arts_broadening(cmn.GamSDVT0H2O.HWSDVT0H2O(j, i)), </span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="stringliteral">        cmn.DTGAMH2O.BHWH2O(j, i)};</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters G0_sdvp_co2{LineShape::TemperatureModel::T1,</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="stringliteral">        Conversion::hitran2arts_broadening(cmn.GamSDVT0CO2.HWSDVT0SELF(j, i)), </span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="stringliteral">        cmn.DTGAMCO2.BHWSELF(j, i)};</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="stringliteral">      LineShape::ModelParameters G2_sdvp_air{G0_sdvp_air}; G2_sdvp_air.X0 *= cmn.GamSDVT0AIR.rHWT0AIR(j, i);</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="stringliteral">      LineShape::ModelParameters G2_sdvp_h2o{G0_sdvp_h2o}; G2_sdvp_h2o.X0 *= cmn.GamSDVT0H2O.rHWT0H2O(j, i);</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="stringliteral">      LineShape::ModelParameters G2_sdvp_co2{G0_sdvp_co2}; G2_sdvp_co2.X0 *= cmn.GamSDVT0CO2.rHWT0SELF(j, i);</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters D0{LineShape::TemperatureModel::T0, Conversion::hitran2arts_broadening(cmn.SHIFT0.shft0(j, i))};</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters G0_vp_air{LineShape::TemperatureModel::T1,</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="stringliteral">        Conversion::hitran2arts_broadening(cmn.GamVT0AIR.HWVT0AIR(j, i)), </span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="stringliteral">        cmn.DTGAMAIR.BHWAIR(j, i)};</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters G0_vp_h2o{LineShape::TemperatureModel::T1,</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="stringliteral">        Conversion::hitran2arts_broadening(cmn.GamVT0H2O.HWVT0H2O(j, i)), </span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="stringliteral">        cmn.DTGAMH2O.BHWH2O(j, i)};</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="stringliteral">      const LineShape::ModelParameters G0_vp_co2{LineShape::TemperatureModel::T1,</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="stringliteral">        Conversion::hitran2arts_broadening(cmn.GamVT0CO2.HWVT0SELF(j, i)), </span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="stringliteral">        cmn.DTGAMCO2.BHWSELF(j, i)};</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="stringliteral">      const LineShape::SingleSpeciesModel sdvp_air{G0_sdvp_air, D0, G2_sdvp_air};</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="stringliteral">      const LineShape::SingleSpeciesModel sdvp_h2o{G0_sdvp_h2o, D0, G2_sdvp_h2o};</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="stringliteral">      const LineShape::SingleSpeciesModel sdvp_co2{G0_sdvp_co2, D0, G2_sdvp_co2};</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="stringliteral">      const LineShape::SingleSpeciesModel vp_air{G0_vp_air, D0};</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="stringliteral">      const LineShape::SingleSpeciesModel vp_h2o{G0_vp_h2o, D0};</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="stringliteral">      const LineShape::SingleSpeciesModel vp_co2{G0_vp_co2, D0};</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="stringliteral">      const auto lsmodel = typeVP(mode) ?</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="stringliteral">        LineShape::Model{{vp_air, vp_h2o, vp_co2}} :</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="stringliteral">        LineShape::Model{{sdvp_air, sdvp_h2o, sdvp_co2}};</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="stringliteral">      Numeric qt0_co2, gsi0;</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="stringliteral">      qt_co2(parameters::T0, cmn.Bands.Isot[i], gsi0, qt0_co2);</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="stringliteral">      </span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="stringliteral">      // Should probably use the isotopologue ratio</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="stringliteral">      bands[i].Line(j) = {Conversion::kaycm2freq(cmn.LineSg.Sig(j, i)),</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="stringliteral">                          Conversion::hitran2arts_linestrength(cmn.UnusedBandParams.intens(j, i)),</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="stringliteral">                          Conversion::hitran2arts_energy(cmn.Energy.E(j, i)),</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="stringliteral">                          gsi0*Numeric(cmn.Jfln.Jf(j, i) * 2 + 1),</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="stringliteral">                          gsi0*Numeric(cmn.Jiln.Ji(j, i) * 2 + 1),</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="stringliteral">                          cmn.UnusedBandParams.eina(j, i),</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="stringliteral">                          ZeemanModel{},</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="stringliteral">                          lsmodel,</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="stringliteral">                          inner_lower,</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="stringliteral">                          inner_upper};</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="stringliteral">}</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="stringliteral">};</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="stringliteral"></span> </div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="alinefunctions_8h_html"><div class="ttname"><a href="linefunctions_8h.html">linefunctions.h</a></div><div class="ttdoc">Stuff related to lineshape functions.</div></div>
<div class="ttc" id="aarts__api_8cc_html_aecf58615a3442a354517debbf8adeb59"><div class="ttname"><a href="arts__api_8cc.html#aecf58615a3442a354517debbf8adeb59">parameters</a></div><div class="ttdeci">Parameters parameters</div><div class="ttdoc">Holds the command line parameters.</div><div class="ttdef"><b>Definition:</b> <a href="parameters_8cc_source.html#l00041">parameters.cc:41</a></div></div>
<div class="ttc" id="aphysics__funcs_8h_html"><div class="ttname"><a href="physics__funcs_8h.html">physics_funcs.h</a></div><div class="ttdoc">This file contains declerations of functions of physical character.</div></div>
<div class="ttc" id="alin__alg_8h_html"><div class="ttname"><a href="lin__alg_8h.html">lin_alg.h</a></div><div class="ttdoc">Linear algebra functions.</div></div>
<div class="ttc" id="anamespacelm__hitran__2017_html"><div class="ttname"><a href="namespacelm__hitran__2017.html">lm_hitran_2017</a></div><div class="ttdef"><b>Definition:</b> <a href="linemixing__hitran_8cc_source.html#l00035">linemixing_hitran.cc:35</a></div></div>
<div class="ttc" id="amatpack_8h_html_aedca4b4670b166565b5b40c700d65a7c"><div class="ttname"><a href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a></div><div class="ttdeci">INDEX Index</div><div class="ttdoc">The type to use for all integer numbers and indices.</div><div class="ttdef"><b>Definition:</b> <a href="matpack_8h_source.html#l00039">matpack.h:39</a></div></div>
<div class="ttc" id="alinemixing__hitran_8h_html"><div class="ttname"><a href="linemixing__hitran_8h.html">linemixing_hitran.h</a></div><div class="ttdoc">Namespace and functions to deal with HITRAN linemixing.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="linemixing__hitran_8cc.html">linemixing_hitran.cc</a></li>
    <li class="footer">Generated on Thu Oct 15 2020 08:53:03 for ARTS by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
