<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: m_microphysics.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.4.0(git:4fb77825)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('m__microphysics_8cc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">m_microphysics.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classWorkspace.html" title="Workspace class.">Workspace</a> functions related to particle micophysics (e.g. size distributions).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &quot;<a class="el" href="array_8h_source.html">array.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="arts_8h_source.html">arts.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="auto__md_8h_source.html">auto_md.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="check__input_8h_source.html">check_input.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cloudbox_8h_source.html">cloudbox.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="file_8h_source.html">file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interpolation_8h_source.html">interpolation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="lin__alg_8h_source.html">lin_alg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logic_8h_source.html">logic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="math__funcs_8h_source.html">math_funcs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="messages_8h_source.html">messages.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="microphysics_8h_source.html">microphysics.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="optproperties_8h_source.html">optproperties.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="parameters_8h_source.html">parameters.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="physics__funcs_8h_source.html">physics_funcs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="psd_8h_source.html">psd.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rte_8h_source.html">rte.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sorting_8h_source.html">sorting.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="special__interp_8h_source.html">special_interp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="xml__io_8h_source.html">xml_io.h</a>&quot;</code><br />
</div>
<p><a href="m__microphysics_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6244e9cdcaa1a4d9c5021d1da5091ab5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#a6244e9cdcaa1a4d9c5021d1da5091ab5">particle_massesFromMetaDataSingleCategory</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;particle_masses, const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;scat_meta, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;)</td></tr>
<tr class="memdesc:a6244e9cdcaa1a4d9c5021d1da5091ab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">WORKSPACE METHOD: particle_massesFromMetaDataSingleCategory.  <a href="m__microphysics_8cc.html#a6244e9cdcaa1a4d9c5021d1da5091ab5">More...</a><br /></td></tr>
<tr class="separator:a6244e9cdcaa1a4d9c5021d1da5091ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f5d7db9e778afbc0d7c63439957a33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#af5f5d7db9e778afbc0d7c63439957a33">particle_massesFromMetaData</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;particle_masses, const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;scat_meta, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;)</td></tr>
<tr class="memdesc:af5f5d7db9e778afbc0d7c63439957a33"><td class="mdescLeft">&#160;</td><td class="mdescRight">WORKSPACE METHOD: particle_massesFromMetaData.  <a href="m__microphysics_8cc.html#af5f5d7db9e778afbc0d7c63439957a33">More...</a><br /></td></tr>
<tr class="separator:af5f5d7db9e778afbc0d7c63439957a33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15b080c5a8ff41cd5f9dd8af03b0c4ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#a15b080c5a8ff41cd5f9dd8af03b0c4ec">pndFromPsdBasic</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;pnd_data, <a class="el" href="classTensor3.html">Tensor3</a> &amp;dpnd_data_dx, const <a class="el" href="classVector.html">Vector</a> &amp;pnd_size_grid, const <a class="el" href="classMatrix.html">Matrix</a> &amp;psd_data, const <a class="el" href="classVector.html">Vector</a> &amp;psd_size_grid, const <a class="el" href="classTensor3.html">Tensor3</a> &amp;dpsd_data_dx, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;quad_order, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;)</td></tr>
<tr class="memdesc:a15b080c5a8ff41cd5f9dd8af03b0c4ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">WORKSPACE METHOD: pndFromPsdBasic.  <a href="m__microphysics_8cc.html#a15b080c5a8ff41cd5f9dd8af03b0c4ec">More...</a><br /></td></tr>
<tr class="separator:a15b080c5a8ff41cd5f9dd8af03b0c4ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace2478ef02e4fe728a6512b04599fdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#aace2478ef02e4fe728a6512b04599fdc">pndFromPsd</a> (<a class="el" href="classMatrix.html">Matrix</a> &amp;pnd_data, <a class="el" href="classTensor3.html">Tensor3</a> &amp;dpnd_data_dx, const <a class="el" href="classVector.html">Vector</a> &amp;pnd_size_grid, const <a class="el" href="classMatrix.html">Matrix</a> &amp;psd_data, const <a class="el" href="classVector.html">Vector</a> &amp;psd_size_grid, const <a class="el" href="classTensor3.html">Tensor3</a> &amp;dpsd_data_dx, const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;scat_data, const <a class="el" href="classVector.html">Vector</a> &amp;f_grid, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_data_checked, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;quad_order, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;scat_index, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;threshold_rsec, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;threshold_bext, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;threshold_rpnd, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;)</td></tr>
<tr class="memdesc:aace2478ef02e4fe728a6512b04599fdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">WORKSPACE METHOD: pndFromPsd.  <a href="m__microphysics_8cc.html#aace2478ef02e4fe728a6512b04599fdc">More...</a><br /></td></tr>
<tr class="separator:aace2478ef02e4fe728a6512b04599fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae811102a332b3c10741d209099250aad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#ae811102a332b3c10741d209099250aad">pnd_fieldCalcFromParticleBulkProps</a> (<a class="el" href="classWorkspace.html">Workspace</a> &amp;ws, <a class="el" href="classTensor4.html">Tensor4</a> &amp;pnd_field, <a class="el" href="array_8h.html#ac48f73312253e57be4cef9d0f6213b20">ArrayOfTensor4</a> &amp;dpnd_field_dx, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;atmosphere_dim, const <a class="el" href="classVector.html">Vector</a> &amp;p_grid, const <a class="el" href="classVector.html">Vector</a> &amp;lat_grid, const <a class="el" href="classVector.html">Vector</a> &amp;lon_grid, const <a class="el" href="classTensor3.html">Tensor3</a> &amp;t_field, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;cloudbox_on, const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;cloudbox_limits, const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;scat_species, const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;scat_data, const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;scat_meta, const <a class="el" href="classTensor4.html">Tensor4</a> &amp;particle_bulkprop_field, const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;particle_bulkprop_names, const <a class="el" href="agenda__class_8h.html#ac082ceab602c9d8e2343717eca8c8660">ArrayOfAgenda</a> &amp;pnd_agenda_array, const <a class="el" href="mystring_8h.html#ad3170ae1c43ee2818750143179a8e5c0">ArrayOfArrayOfString</a> &amp;pnd_agenda_array_input_names, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;jacobian_do, const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;jacobian_quantities, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;)</td></tr>
<tr class="memdesc:ae811102a332b3c10741d209099250aad"><td class="mdescLeft">&#160;</td><td class="mdescRight">WORKSPACE METHOD: pnd_fieldCalcFromParticleBulkProps.  <a href="m__microphysics_8cc.html#ae811102a332b3c10741d209099250aad">More...</a><br /></td></tr>
<tr class="separator:ae811102a332b3c10741d209099250aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3bb45bf05479f7876f8df4ad1753c3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#ac3bb45bf05479f7876f8df4ad1753c3c">ScatSpeciesSizeMassInfo</a> (<a class="el" href="classVector.html">Vector</a> &amp;scat_species_x, <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;scat_species_a, <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;scat_species_b, const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;scat_meta, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;species_index, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;x_unit, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;x_fit_start, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;x_fit_end, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;do_only_x, const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;)</td></tr>
<tr class="memdesc:ac3bb45bf05479f7876f8df4ad1753c3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">WORKSPACE METHOD: ScatSpeciesSizeMassInfo.  <a href="m__microphysics_8cc.html#ac3bb45bf05479f7876f8df4ad1753c3c">More...</a><br /></td></tr>
<tr class="separator:ac3bb45bf05479f7876f8df4ad1753c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a572f7b83f46ed616a2958437b5e6d4f4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m__microphysics_8cc.html#a572f7b83f46ed616a2958437b5e6d4f4">SCATSPECIES_MAINTAG</a></td></tr>
<tr class="separator:a572f7b83f46ed616a2958437b5e6d4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classWorkspace.html" title="Workspace class.">Workspace</a> functions related to particle micophysics (e.g. size distributions). </p>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok, Daniel Kreyling, Manfred Brath, Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2017-07-10</dd></dl>
<p>These functions are listed in the doxygen documentation as entries of the file <a class="el" href="auto__md_8h.html">auto_md.h</a>. </p>

<p class="definition">Definition in file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af5f5d7db9e778afbc0d7c63439957a33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5f5d7db9e778afbc0d7c63439957a33">&#9670;&nbsp;</a></span>particle_massesFromMetaData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void particle_massesFromMetaData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>particle_masses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WORKSPACE METHOD: particle_massesFromMetaData. </p>
<p>Derives <em>particle_masses</em> from <em>scat_meta</em>.</p>
<p>This method is supposed to be used to derive <em>particle_masses</em> when <em>pnd_field</em> is internally calculated using pnd_fieldCalcFromParticleBulkProps* (in contrast to reading it from external sources using <em>ScatElementsPndAndScatAdd</em> and pnd_fieldCalcFrompnd_field_raw*). It extracts the mass information of the scattering elements from scat_meta*. Each scattering species is taken as a separate category of particle_masses, i.e., the resulting particle_masses* matrix will contain as many columns as scattering species are present in <em>scat_meta</em>.</p>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">particle_masses</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_meta</td><td>WS Input </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="m__microphysics_8cc_source.html#l00109">109</a> of file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l04850">ARTS::Var::particle_masses()</a>, <a class="el" href="autoarts_8h_source.html#l05983">ARTS::Var::scat_meta()</a>, and <a class="el" href="array_8h_source.html#l00343">TotalNumberOfElements()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auto__md_8cc_source.html#l11140">particle_massesFromMetaData_g()</a>.</p>

</div>
</div>
<a id="a6244e9cdcaa1a4d9c5021d1da5091ab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6244e9cdcaa1a4d9c5021d1da5091ab5">&#9670;&nbsp;</a></span>particle_massesFromMetaDataSingleCategory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void particle_massesFromMetaDataSingleCategory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>particle_masses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WORKSPACE METHOD: particle_massesFromMetaDataSingleCategory. </p>
<p>Sets <em>particle_masses</em> based on <em>scat_meta</em> assuming all particles are of the same mass category.</p>
<p>This method derives the particle masses from the mass entry of each scattering element. It is assumed that all scattering elements represent particles of the same (bulk) matter (e.g. water or ice). With other words, a single mass category is assumed (see <em>particle_masses</em> for a definition of "mass
category").</p>
<p>To be clear, the above are assumptions of the method, the user is free to work with any scattering element. For Earth and just having cloud and particles, the resulting mass category can be seen as the total cloud water content, with possible contribution from both ice and liquid phase.</p>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok </dd>
<dd>
Patrick Eriksson</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">particle_masses</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_meta</td><td>WS Input </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="m__microphysics_8cc_source.html#l00072">72</a> of file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l04850">ARTS::Var::particle_masses()</a>, <a class="el" href="autoarts_8h_source.html#l05983">ARTS::Var::scat_meta()</a>, and <a class="el" href="array_8h_source.html#l00343">TotalNumberOfElements()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auto__md_8cc_source.html#l11131">particle_massesFromMetaDataSingleCategory_g()</a>.</p>

</div>
</div>
<a id="ae811102a332b3c10741d209099250aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae811102a332b3c10741d209099250aad">&#9670;&nbsp;</a></span>pnd_fieldCalcFromParticleBulkProps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pnd_fieldCalcFromParticleBulkProps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWorkspace.html">Workspace</a> &amp;&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor4.html">Tensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="array_8h.html#ac48f73312253e57be4cef9d0f6213b20">ArrayOfTensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>dpnd_field_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>atmosphere_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>t_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>cloudbox_limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_species</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor4.html">Tensor4</a> &amp;&#160;</td>
          <td class="paramname"><em>particle_bulkprop_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a> &amp;&#160;</td>
          <td class="paramname"><em>particle_bulkprop_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="agenda__class_8h.html#ac082ceab602c9d8e2343717eca8c8660">ArrayOfAgenda</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_agenda_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ad3170ae1c43ee2818750143179a8e5c0">ArrayOfArrayOfString</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_agenda_array_input_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_do</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="jacobian_8h.html#a7c270becd581ff9126ffbf1ef487c5db">ArrayOfRetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WORKSPACE METHOD: pnd_fieldCalcFromParticleBulkProps. </p>
<p>Converts particle bulk property data to <em>pnd_field</em>.</p>
<p>In short, the method combines <em>scat_species</em>, <em>pnd_agenda_array</em>, particle_bulkprop_field* and their associated variables to derive pnd_field*.</p>
<p>The method does nothing if cloudbox is inactive.</p>
<p>Otherwise, cloudbox limits must be set before calling the method, and <em>particle_bulkprop_field</em> is checked to have non-zero elements just inside the cloudbox.</p>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson, Jana Mendrok</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ws</td><td><a class="el" href="classWorkspace.html" title="Workspace class.">Workspace</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pnd_field</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dpnd_field_dx</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atmosphere_dim</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lat_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t_field</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cloudbox_on</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cloudbox_limits</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_species</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_data</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_meta</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle_bulkprop_field</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle_bulkprop_names</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pnd_agenda_array</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pnd_agenda_array_input_names</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_do</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jacobian_quantities</td><td>WS Input </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="m__microphysics_8cc_source.html#l00499">499</a> of file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>

<p class="reference">References <a class="el" href="autoarts_8h_source.html#l02510">ARTS::Var::atmosphere_dim()</a>, <a class="el" href="check__input_8cc_source.html#l01268">chk_atm_field()</a>, <a class="el" href="check__input_8cc_source.html#l01201">chk_atm_grids()</a>, <a class="el" href="check__input_8cc_source.html#l00089">chk_if_in_range()</a>, <a class="el" href="autoarts_8h_source.html#l02762">ARTS::Var::cloudbox_limits()</a>, <a class="el" href="autoarts_8h_source.html#l02782">ARTS::Var::cloudbox_on()</a>, <a class="el" href="autoarts_8h_source.html#l03223">ARTS::Var::dpnd_data_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03235">ARTS::Var::dpnd_data_dx_names()</a>, <a class="el" href="autoarts_8h_source.html#l03251">ARTS::Var::dpnd_field_dx()</a>, <a class="el" href="array_8h_source.html#l00292">find_first()</a>, <a class="el" href="autoarts_8h_source.html#l03912">ARTS::Var::jacobian_do()</a>, <a class="el" href="autoarts_8h_source.html#l03924">ARTS::Var::jacobian_quantities()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="autoarts_8h_source.html#l03962">ARTS::Var::lat_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04090">ARTS::Var::lon_grid()</a>, <a class="el" href="legacy__continua_8cc_source.html#l20629">max</a>, <a class="el" href="legacy__continua_8cc_source.html#l20628">min</a>, <a class="el" href="array_8h_source.html#l00195">Array&lt; base &gt;::nelem()</a>, <a class="el" href="absorptionlines_8h_source.html#l01820">Absorption::nelem()</a>, <a class="el" href="autoarts_8h_source.html#l04763">ARTS::Var::p_grid()</a>, <a class="el" href="autoarts_8h_source.html#l04810">ARTS::Var::particle_bulkprop_field()</a>, <a class="el" href="autoarts_8h_source.html#l04823">ARTS::Var::particle_bulkprop_names()</a>, <a class="el" href="autoarts_8h_source.html#l04979">ARTS::Var::pnd_agenda_array()</a>, <a class="el" href="autoarts_8h_source.html#l04991">ARTS::Var::pnd_agenda_array_input_names()</a>, <a class="el" href="auto__md_8cc_source.html#l24714">pnd_agenda_arrayExecute()</a>, <a class="el" href="autoarts_8h_source.html#l05011">ARTS::Var::pnd_agenda_input()</a>, <a class="el" href="autoarts_8h_source.html#l05038">ARTS::Var::pnd_agenda_input_t()</a>, <a class="el" href="autoarts_8h_source.html#l05051">ARTS::Var::pnd_data()</a>, <a class="el" href="autoarts_8h_source.html#l05081">ARTS::Var::pnd_field()</a>, <a class="el" href="autoarts_8h_source.html#l05840">ARTS::Var::scat_data()</a>, <a class="el" href="autoarts_8h_source.html#l05983">ARTS::Var::scat_meta()</a>, <a class="el" href="autoarts_8h_source.html#l06086">ARTS::Var::scat_species()</a>, <a class="el" href="m__microphysics_8cc.html#a572f7b83f46ed616a2958437b5e6d4f4">SCATSPECIES_MAINTAG</a>, and <a class="el" href="autoarts_8h_source.html#l06947">ARTS::Var::t_field()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auto__md_8cc_source.html#l11279">pnd_fieldCalcFromParticleBulkProps_g()</a>.</p>

</div>
</div>
<a id="aace2478ef02e4fe728a6512b04599fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aace2478ef02e4fe728a6512b04599fdc">&#9670;&nbsp;</a></span>pndFromPsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pndFromPsd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>dpnd_data_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_size_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>psd_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>psd_size_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>dpsd_data_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#a6e37832809e67ccd019aa94dec37d0ae">ArrayOfArrayOfSingleScatteringData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>f_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_data_checked</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>quad_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>threshold_se_ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>threshold_ss_ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>threshold_se_pnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WORKSPACE METHOD: pndFromPsd. </p>
<p>Calculates <em>pnd_data</em> from given <em>psd_data</em> for one scattering species.</p>
<p>Performs integration of the size distribution over the size grid bin deriving pnd (units #/m3) from psd (units #/m3/m). Some checks on the sufficiency of the size grid range and coverage are applied.</p>
<p>quad_order* can be 0 for rectangular or 1 for trapezoidal integration. The only difference is the treatment of the start and end nodes. For trapezoidal their corresponding bins end exactly at the nodes, while for rectangular they extend further out by the half distance to the neighbor node (but not beyond 0).</p>
<p>Attempts to check that the size grids and <em>scat_data</em> represent the bulk extinction sufficiently. Specifically, it is tested that &lt;br&gt; (a) psd*ext is decreasing at the small and large particle size &lt;br&gt; ends of the size grid - but only if scattering species bulk &lt;br&gt; extinction exceeds 1% of <em>threshold_ss_ext</em>. &lt;br&gt; (b) removing the smallest and largest particles changes the &lt;br&gt; resulting bulk extinction by less then a fraction of &lt;br&gt; <em>threshold_se_ext</em> - but only if scattering species bulk &lt;br&gt; extinction exceeds <em>threshold_ss_ext</em> and number density (pnd) &lt;br&gt; of the edge size point at this atmospheric level is larger &lt;br&gt; than <em>threshold_se_pnd</em> times the maximum pnd of this &lt;br&gt; scattering element over all atmospheric levels. Skipping tests in case of low extinction is done in order to minimize issues arising from very low mass densities, particularly at single atmospheric levels, and very low bulk extinctions, i.e. in cases where the effects on the radiance fields are estimated to be low. NOTE: The tests are only approximate and do not guarantee the validity of the resulting bulk properties (and increasing the thresholds will decrease the reliability of the bulk properties).</p>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok, Patrick Eriksson</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pnd_data</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dpnd_data_dx</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pnd_size_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psd_data</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psd_size_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dpsd_data_dx</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_data</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_data_checked</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quad_order</td><td>Generic Input (Default: "1") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_index</td><td>Generic Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold_se_ext</td><td>Generic Input (Default: "0.02") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold_ss_ext</td><td>Generic Input (Default: "1e-8") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold_se_pnd</td><td>Generic Input (Default: "0.02") </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="m__microphysics_8cc_source.html#l00209">209</a> of file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>

<p class="reference">References <a class="el" href="legacy__continua_8cc_source.html#l20626">abs</a>, <a class="el" href="cloudbox_8cc_source.html#l00611">bin_quadweights()</a>, <a class="el" href="autoarts_8h_source.html#l03223">ARTS::Var::dpnd_data_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03281">ARTS::Var::dpsd_data_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03449">ARTS::Var::f_grid()</a>, <a class="el" href="sorting_8h_source.html#l00073">get_sorted_indexes()</a>, <a class="el" href="logic_8cc_source.html#l00215">is_increasing()</a>, <a class="el" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, <a class="el" href="legacy__continua_8cc_source.html#l20629">max</a>, <a class="el" href="absorptionlines_8h_source.html#l01820">Absorption::nelem()</a>, <a class="el" href="autoarts_8h_source.html#l05051">ARTS::Var::pnd_data()</a>, <a class="el" href="autoarts_8h_source.html#l05119">ARTS::Var::pnd_size_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05446">ARTS::Var::psd_data()</a>, <a class="el" href="autoarts_8h_source.html#l05460">ARTS::Var::psd_size_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05840">ARTS::Var::scat_data()</a>, and <a class="el" href="autoarts_8h_source.html#l05850">ARTS::Var::scat_data_checked()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auto__md_8cc_source.html#l11240">pndFromPsd_g()</a>.</p>

</div>
</div>
<a id="a15b080c5a8ff41cd5f9dd8af03b0c4ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15b080c5a8ff41cd5f9dd8af03b0c4ec">&#9670;&nbsp;</a></span>pndFromPsdBasic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pndFromPsdBasic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>dpnd_data_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>pnd_size_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>psd_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>psd_size_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor3.html">Tensor3</a> &amp;&#160;</td>
          <td class="paramname"><em>dpsd_data_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>quad_order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WORKSPACE METHOD: pndFromPsdBasic. </p>
<p>Calculates <em>pnd_data</em> from given <em>psd_data</em>.</p>
<p>As <em>pndFromPsdBasic</em>, but without bulk extinction representation checks.</p>
<dl class="section author"><dt>Author</dt><dd>Jana Mendrok, Patrick Eriksson</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pnd_data</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dpnd_data_dx</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pnd_size_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psd_data</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psd_size_grid</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dpsd_data_dx</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">quad_order</td><td>Generic Input (Default: "1") </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="m__microphysics_8cc_source.html#l00130">130</a> of file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>

<p class="reference">References <a class="el" href="cloudbox_8cc_source.html#l00611">bin_quadweights()</a>, <a class="el" href="autoarts_8h_source.html#l03223">ARTS::Var::dpnd_data_dx()</a>, <a class="el" href="autoarts_8h_source.html#l03281">ARTS::Var::dpsd_data_dx()</a>, <a class="el" href="sorting_8h_source.html#l00073">get_sorted_indexes()</a>, <a class="el" href="logic_8cc_source.html#l00215">is_increasing()</a>, <a class="el" href="autoarts_8h_source.html#l05051">ARTS::Var::pnd_data()</a>, <a class="el" href="autoarts_8h_source.html#l05119">ARTS::Var::pnd_size_grid()</a>, <a class="el" href="autoarts_8h_source.html#l05446">ARTS::Var::psd_data()</a>, and <a class="el" href="autoarts_8h_source.html#l05460">ARTS::Var::psd_size_grid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auto__md_8cc_source.html#l11263">pndFromPsdBasic_g()</a>.</p>

</div>
</div>
<a id="ac3bb45bf05479f7876f8df4ad1753c3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3bb45bf05479f7876f8df4ad1753c3c">&#9670;&nbsp;</a></span>ScatSpeciesSizeMassInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ScatSpeciesSizeMassInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_species_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_species_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_species_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="optproperties_8h.html#aae996052629e693cb9c58207ab1e1e93">ArrayOfArrayOfScatteringMetaData</a> &amp;&#160;</td>
          <td class="paramname"><em>scat_meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>species_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>x_unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>x_fit_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>x_fit_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>do_only_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVerbosity.html">Verbosity</a> &amp;&#160;</td>
          <td class="paramname"><em>verbosity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WORKSPACE METHOD: ScatSpeciesSizeMassInfo. </p>
<p>Derives size and mass information for a scattering species. This method assumes that the mass-size relationship can described by <em>scat_species_a</em> and <em>scat_species_b</em>. See documentation of scat_species_a* for details.</p>
<p>The quantity to be used as size descriptor is here denoted as x, and is selected by setting <em>x_unit</em>. The options are: &lt;br&gt; "dveq" : The size grid is set to scat_meta.diameter_volume_equ &lt;br&gt; "dmax" : The size grid is set to scat_meta.diameter_max &lt;br&gt; "area" : The size grid is set to scat_meta.diameter_area_equ_aerodynamical &lt;br&gt; "mass" : The size grid is set to scat_meta.mass This selection determines <em>scat_species_x</em>.</p>
<p>The parameters <em>scat_species_a</em> and <em>scat_species_b</em> are determined by a numeric fit between <em>scat_species_x</em> and corresponding masses in scat_meta*. This fit is performed over sizes inside the range [x_fit_start,x_fit_end]. This range is allowed to be broader than the coverage of <em>scat_species_x</em>. There must be at least two sizes inside [x_fit_start,x_fit_end].</p>
<dl class="section author"><dt>Author</dt><dd>Manfred Brath </dd>
<dd>
Jana Mendrok </dd>
<dd>
Patrick Eriksson</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">scat_species_x</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scat_species_a</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scat_species_b</td><td>WS Output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scat_meta</td><td>WS Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">species_index</td><td>Generic Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_unit</td><td>Generic Input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_fit_start</td><td>Generic Input (Default: "0") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_fit_end</td><td>Generic Input (Default: "1e9") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">do_only_x</td><td>Generic Input (Default: "0") </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="m__microphysics_8cc_source.html#l00779">779</a> of file <a class="el" href="m__microphysics_8cc_source.html">m_microphysics.cc</a>.</p>

<p class="reference">References <a class="el" href="microphysics_8cc_source.html#l00077">derive_scat_species_a_and_b()</a>, <a class="el" href="autoarts_8h_source.html#l05983">ARTS::Var::scat_meta()</a>, <a class="el" href="autoarts_8h_source.html#l06103">ARTS::Var::scat_species_a()</a>, <a class="el" href="autoarts_8h_source.html#l06112">ARTS::Var::scat_species_b()</a>, and <a class="el" href="autoarts_8h_source.html#l06130">ARTS::Var::scat_species_x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auto__md_8cc_source.html#l16052">ScatSpeciesSizeMassInfo_g()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a572f7b83f46ed616a2958437b5e6d4f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a572f7b83f46ed616a2958437b5e6d4f4">&#9670;&nbsp;</a></span>SCATSPECIES_MAINTAG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> SCATSPECIES_MAINTAG</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="m__microphysics_8cc_source.html#l00499">pnd_fieldCalcFromParticleBulkProps()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="m__microphysics_8cc.html">m_microphysics.cc</a></li>
    <li class="footer">Generated on Thu Oct 15 2020 08:53:05 for ARTS by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
