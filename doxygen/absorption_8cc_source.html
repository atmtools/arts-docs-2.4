<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: absorption.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.4.0(git:4fb77825)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('absorption_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">absorption.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="absorption_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (C) 2000-2012</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   Stefan Buehler  &lt;sbuehler@ltu.se&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   Axel von Engeln &lt;engeln@uni-bremen.de&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   This program is free software; you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">   under the terms of the GNU General Public License as published by the</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   Free Software Foundation; either version 2, or (at your option) any</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307,</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">   USA. */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="absorption_8h.html">absorption.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="arts_8h.html">arts.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="auto__md_8h.html">auto_md.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="file_8h.html">file.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="interpolation__poly_8h.html">interpolation_poly.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="linescaling_8h.html">linescaling.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="logic_8h.html">logic.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="math__funcs_8h.html">math_funcs.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="messages_8h.html">messages.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="global__data_8h.html">global_data.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="linefunctions_8h.html">linefunctions.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* SpeciesAuxTypeNames[] = {<span class="stringliteral">&quot;NONE&quot;</span>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                            <span class="stringliteral">&quot;ISORATIO&quot;</span>,  <span class="comment">//Built-in type</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                            <span class="stringliteral">&quot;ISOQUANTUM&quot;</span>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                            <span class="stringliteral">&quot;PART_TFIELD&quot;</span>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                            <span class="stringliteral">&quot;PART_COEFF&quot;</span>,  <span class="comment">//Built-in type</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                            <span class="stringliteral">&quot;PART_COEFF_VIBROT&quot;</span>};</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#a9241e409c2b7a56789faf65196103ace">   59</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpeciesAuxData.html#a9241e409c2b7a56789faf65196103ace">SpeciesAuxData::InitFromSpeciesData</a>() {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">mparams</a>.resize(<a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem());</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">mparam_type</a>.resize(<a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem());</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isp = 0; isp &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem(); isp++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> niso = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[isp].Isotopologue().nelem();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">mparams</a>[isp].resize(niso);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">mparam_type</a>[isp].resize(niso);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a> = 0; <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a> &lt; niso; <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>++) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">mparams</a>[isp][<a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>].resize(0);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">mparam_type</a>[isp][<a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>] = <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa88394e7381e5bfd835e3a4fc3db24d54">SpeciesAuxData::AT_NONE</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">   76</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">SpeciesAuxData::setParam</a>(<span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> species,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                              <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isotopologue,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810ef">AuxType</a> auxtype,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfGriddedField1</a>&amp; auxdata) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">mparam_type</a>[species][isotopologue] = auxtype;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">mparams</a>[species][isotopologue] = auxdata;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#aff0f383c2534c14af0bacb2187d64c5d">   84</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">SpeciesAuxData::setParam</a>(<span class="keyword">const</span> <a class="code" href="classmy__basic__string.html">String</a>&amp; artstag,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classmy__basic__string.html">String</a>&amp; auxtype,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfGriddedField1</a>&amp; auxdata) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// Global species lookup data:</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// We need a species index sorted by Arts identifier. Keep this in a</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// static variable, so that we have to do this only once.  The ARTS</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// species index is ArtsMap[&lt;Arts String&gt;].</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">static</span> map&lt;String, SpecIsoMap&gt; ArtsMap;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// Remember if this stuff has already been initialized:</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> hinit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (!hinit) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> i = 0; i &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem(); ++i) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; sr = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[i];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> j = 0; j &lt; sr.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>(); ++j) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="classSpecIsoMap.html">SpecIsoMap</a> indicies(i, j);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="classmy__basic__string.html">String</a> buf = sr.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>() + <span class="stringliteral">&quot;-&quot;</span> + sr.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>()[j].Name();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        ArtsMap[buf] = indicies;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    hinit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> species;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isotopologue;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// ok, now for the cool index map:</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// is this arts identifier valid?</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">const</span> map&lt;String, SpecIsoMap&gt;::const_iterator i = ArtsMap.find(artstag);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> (i == ArtsMap.end()) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    ostringstream os;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;ARTS Tag: &quot;</span> &lt;&lt; artstag &lt;&lt; <span class="stringliteral">&quot; is unknown.&quot;</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="classSpecIsoMap.html">SpecIsoMap</a> <span class="keywordtype">id</span> = i-&gt;second;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// Set mspecies:</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  species = <span class="keywordtype">id</span>.<a class="code" href="classSpecIsoMap.html#a544c92f35207f9c75d562209f5653cf9">Speciesindex</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// Set misotopologue:</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  isotopologue = <span class="keywordtype">id</span>.Isotopologueindex();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> this_auxtype = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">while</span> (this_auxtype &lt; <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa5f1a54b54d34a94c173a4b2504a2bb76">AT_FINAL_ENTRY</a> &amp;&amp;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         auxtype != SpeciesAuxTypeNames[this_auxtype])</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    this_auxtype++;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> (this_auxtype != <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa5f1a54b54d34a94c173a4b2504a2bb76">AT_FINAL_ENTRY</a>) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">setParam</a>(species, isotopologue, (<a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810ef">AuxType</a>)this_auxtype, auxdata);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    ostringstream os;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Unknown SpeciesAuxData type: &quot;</span> &lt;&lt; auxtype;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    std::runtime_error(os.str());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">  145</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfGriddedField1</a>&amp; <a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">SpeciesAuxData::getParam</a>(</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> species, <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isotopologue)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">mparams</a>[species][isotopologue];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#af768c736d4ad29753bcb30cddf1ae09c">  150</a></span>&#160;<a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="classSpeciesAuxData.html#af768c736d4ad29753bcb30cddf1ae09c">SpeciesAuxData::getIsotopologueRatio</a>(<span class="keyword">const</span> <a class="code" href="classSpeciesTag.html">SpeciesTag</a>&amp; st)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> val = 1.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">if</span> (st.<a class="code" href="classSpeciesTag.html#aefba8571b13a2b77b4e046a77939ca83">Isotopologue</a>() &gt; -1)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    val = <a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(st.<a class="code" href="classSpeciesTag.html#a5830fa3d4aa5b07e2da5dbbdca682db9">Species</a>(), st.<a class="code" href="classSpeciesTag.html#aefba8571b13a2b77b4e046a77939ca83">Isotopologue</a>())[0].data[0];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#a133518b697b38dadae22c891cf40175f">  157</a></span>&#160;<a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="classSpeciesAuxData.html#af768c736d4ad29753bcb30cddf1ae09c">SpeciesAuxData::getIsotopologueRatio</a>(<span class="keyword">const</span> <a class="code" href="classQuantumIdentifier.html">QuantumIdentifier</a>&amp; qid)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(qid.<a class="code" href="classQuantumIdentifier.html#ad875cde8f4af6b5e84ed5d0c2ceefa47">Species</a>(), qid.<a class="code" href="classQuantumIdentifier.html#ab35ca56206cf1a9688d15fcce7732a7a">Isotopologue</a>())[0].data[0];</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#ad4a71a5b6d023ce15f1dd743416c57f7">  161</a></span>&#160;<a class="code" href="classmy__basic__string.html">String</a> <a class="code" href="classSpeciesAuxData.html#ad4a71a5b6d023ce15f1dd743416c57f7">SpeciesAuxData::getTypeString</a>(<span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> species,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isotopologue)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  assert(<a class="code" href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">mparam_type</a>[species][isotopologue] &lt; <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa5f1a54b54d34a94c173a4b2504a2bb76">AT_FINAL_ENTRY</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">return</span> SpeciesAuxTypeNames[<a class="code" href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">mparam_type</a>[species][isotopologue]];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classSpeciesAuxData.html#a0e1c07089fb5ec4af31b796b8cfbd8a4">  167</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpeciesAuxData.html#a0e1c07089fb5ec4af31b796b8cfbd8a4">SpeciesAuxData::ReadFromStream</a>(<a class="code" href="classmy__basic__string.html">String</a>&amp; artsid,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                    istream&amp; is,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                    <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nparams,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classVerbosity.html">Verbosity</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a7ed018d4c1e770e0480c72d2ae91cfff">verbosity</a>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="messages_8h.html#a1ad21a2081b7fa459cace45d863de67d">CREATE_OUT3</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Global species lookup data:</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// We need a species index sorted by Arts identifier. Keep this in a</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// static variable, so that we have to do this only once.  The ARTS</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// species index is ArtsMap[&lt;Arts String&gt;].</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">static</span> map&lt;String, SpecIsoMap&gt; ArtsMap;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// Remember if this stuff has already been initialized:</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> hinit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span> (!hinit) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    out3 &lt;&lt; <span class="stringliteral">&quot;  ARTS index table:\n&quot;</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> i = 0; i &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem(); ++i) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; sr = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[i];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> j = 0; j &lt; sr.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>(); ++j) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="classSpecIsoMap.html">SpecIsoMap</a> indicies(i, j);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="classmy__basic__string.html">String</a> buf = sr.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>() + <span class="stringliteral">&quot;-&quot;</span> + sr.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>()[j].Name();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        ArtsMap[buf] = indicies;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// Print the generated data structures (for debugging):</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// The explicit conversion of Name to a c-String is</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// necessary, because setw does not work correctly for</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// stl Strings.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&amp; i1 = ArtsMap[buf].<a class="code" href="classSpecIsoMap.html#a544c92f35207f9c75d562209f5653cf9">Speciesindex</a>();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a>&amp; i2 = ArtsMap[buf].Isotopologueindex();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        out3 &lt;&lt; <span class="stringliteral">&quot;  Arts Identifier = &quot;</span> &lt;&lt; buf &lt;&lt; <span class="stringliteral">&quot;   Species = &quot;</span> &lt;&lt; setw(10)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;             &lt;&lt; setiosflags(ios::left) &lt;&lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[i1].Name().c_str()</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;iso = &quot;</span> &lt;&lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[i1].Isotopologue()[i2].Name().c_str()</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    hinit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// This always contains the rest of the line to parse. At the</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// beginning the entire line. Line gets shorter and shorter as we</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// continue to extract stuff from the beginning.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="classmy__basic__string.html">String</a> line;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// Look for more comments?</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">bool</span> comment = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">while</span> (comment) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// Return true if eof is reached:</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (is.eof()) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// Throw runtime_error if stream is bad:</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (!is) <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Stream bad.&quot;</span>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Read line from file into linebuffer:</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    getline(is, line);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// It is possible that we were exactly at the end of the file before</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// calling getline. In that case the previous eof() was still false</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// because eof() evaluates only to true if one tries to read after the</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// end of the file. The following check catches this.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (line.<a class="code" href="classmy__basic__string.html#a3637b76008e2387e81318a7c50722a5d">nelem</a>() == 0 &amp;&amp; is.eof()) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// @ as first character marks catalogue entry</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">char</span> c;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="mystring_8h.html#afc5876f67c276e93394c19e99c23eba4">extract</a>(c, line, 1);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// check for empty line</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;@&#39;</span>) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      comment = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// read the arts identifier String</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  istringstream icecream(line);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  icecream &gt;&gt; artsid;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span> (artsid.length() != 0) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> mspecies;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> misotopologue;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// ok, now for the cool index map:</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// is this arts identifier valid?</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keyword">const</span> map&lt;String, SpecIsoMap&gt;::const_iterator i = ArtsMap.find(artsid);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (i == ArtsMap.end()) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      ostringstream os;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;ARTS Tag: &quot;</span> &lt;&lt; artsid &lt;&lt; <span class="stringliteral">&quot; is unknown.&quot;</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classSpecIsoMap.html">SpecIsoMap</a> <span class="keywordtype">id</span> = i-&gt;second;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Set mspecies:</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    mspecies = <span class="keywordtype">id</span>.<a class="code" href="classSpecIsoMap.html#a544c92f35207f9c75d562209f5653cf9">Speciesindex</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// Set misotopologue:</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    misotopologue = <span class="keywordtype">id</span>.Isotopologueindex();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classArray.html">ArrayOfGriddedField1</a> ratios;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ratios.resize(1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// Extract accuracies:</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> p = NAN;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      std::vector&lt;Numeric&gt; aux;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> ip = 0; ip &lt; nparams; ip++) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        icecream &gt;&gt; <a class="code" href="classdouble__imanip.html">double_imanip</a>() &gt;&gt; p;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        aux.push_back(p);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="classVector.html">Vector</a> grid;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">if</span> (aux.size() &gt; 1)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="math__funcs_8cc.html#a0ae25d3a4a2dc049c7c448f866f2ce37">nlinspace</a>(grid, 1, (<a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>)aux.size(), aux.size());</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        grid = <a class="code" href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">Vector</a>(1, .1);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      ratios[0].set_grid(0, grid);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      ratios[0].data = aux;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">mparams</a>[mspecies][misotopologue] = ratios;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> runtime_error&amp;) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Error reading SpeciesAuxData.&quot;</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// That&#39;s it!</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="absorption_8h.html#ae4748feadc4b7a101b1060346a4a78af">  301</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="absorption_8cc.html#ae4748feadc4b7a101b1060346a4a78af">checkIsotopologueRatios</a>(<span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfArrayOfSpeciesTag</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classSpeciesAuxData.html">SpeciesAuxData</a>&amp; isoratios) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// Check total number of species:</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem() != isoratios.<a class="code" href="classSpeciesAuxData.html#a4cbe4d27aff1c1f00135be6f14461f33">nspecies</a>()) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    ostringstream os;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Number of species in SpeciesAuxData (&quot;</span> &lt;&lt; isoratios.<a class="code" href="classSpeciesAuxData.html#a4cbe4d27aff1c1f00135be6f14461f33">nspecies</a>()</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;does not fit builtin species data (&quot;</span> &lt;&lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// For the selected species, we check all isotopes by looping over the</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// species data. (Trying to check only the isotopes actually used gets</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// quite complicated, actually, so we do the simple thing here.)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// Loop over the absorption species:</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> i = 0; i &lt; <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>.nelem(); i++) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// sp is the index of this species in the internal lookup table</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> sp = <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>[i][0].Species();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Get handle on species data for this species:</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; this_sd = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[sp];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// Check number of isotopologues:</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">nelem</a>() != isoratios.<a class="code" href="classSpeciesAuxData.html#a680f2554b995212186ed2357ecd001dd">nisotopologues</a>(sp)) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      ostringstream os;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Incorrect number of isotopologues in isotopologue data.\n&quot;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Species: &quot;</span> &lt;&lt; this_sd.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Number of isotopes in SpeciesAuxData (&quot;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         &lt;&lt; isoratios.<a class="code" href="classSpeciesAuxData.html#a680f2554b995212186ed2357ecd001dd">nisotopologues</a>(sp) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;does not fit builtin species data (&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         &lt;&lt; this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">nelem</a>() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a> = 0; <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a> &lt; this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>(); ++<a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">// For &quot;real&quot; species (not representing continau) the isotopologue</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">// ratio must not be NAN or below zero.</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">if</span> (!this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>()[<a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>].isContinuum()) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (std::isnan(isoratios.<a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(sp, <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>)[0].data[0]) ||</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            isoratios.<a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(sp, <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>)[0].data[0] &lt; 0.) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          ostringstream os;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot;Invalid isotopologue ratio.\n&quot;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Species: &quot;</span> &lt;&lt; this_sd.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;             &lt;&lt; this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>()[<a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>].Name() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;Ratio:   &quot;</span> &lt;&lt; isoratios.<a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(sp, <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>)[0].data[0];</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="absorption_8h.html#a8a96b3b64f2d5daab0cf237bdce30313">  356</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="absorption_8cc.html#a8a96b3b64f2d5daab0cf237bdce30313">checkPartitionFunctions</a>(<span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfArrayOfSpeciesTag</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classSpeciesAuxData.html">SpeciesAuxData</a>&amp; partfun) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// Check total number of species:</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem() != partfun.<a class="code" href="classSpeciesAuxData.html#a4cbe4d27aff1c1f00135be6f14461f33">nspecies</a>()) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    ostringstream os;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Number of species in SpeciesAuxData (&quot;</span> &lt;&lt; partfun.<a class="code" href="classSpeciesAuxData.html#a4cbe4d27aff1c1f00135be6f14461f33">nspecies</a>() &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;does not fit builtin species data (&quot;</span> &lt;&lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// For the selected species, we check all isotopes by looping over the</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// species data. (Trying to check only the isotopes actually used gets</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// quite complicated, actually, so we do the simple thing here.)</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// Loop over the absorption species:</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> i = 0; i &lt; <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>.nelem(); i++) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// sp is the index of this species in the internal lookup table</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> sp = <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>[i][0].Species();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// Get handle on species data for this species:</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; this_sd = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[sp];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// Check number of isotopologues:</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">nelem</a>() != partfun.<a class="code" href="classSpeciesAuxData.html#a680f2554b995212186ed2357ecd001dd">nisotopologues</a>(sp)) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      ostringstream os;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Incorrect number of isotopologues in partition function data.\n&quot;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Species: &quot;</span> &lt;&lt; this_sd.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>() &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Number of isotopes in SpeciesAuxData (&quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         &lt;&lt; partfun.<a class="code" href="classSpeciesAuxData.html#a680f2554b995212186ed2357ecd001dd">nisotopologues</a>(sp) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;does not fit builtin species data (&quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;         &lt;&lt; this_sd.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">nelem</a>() &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">throw</span> runtime_error(os.str());</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="absorption_8h.html#aa6e712ce2d9a4fbade1516c3acf13b66">  394</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="absorption_8cc.html#aa6e712ce2d9a4fbade1516c3acf13b66">fillSpeciesAuxDataWithIsotopologueRatiosFromSpeciesData</a>(</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classSpeciesAuxData.html">SpeciesAuxData</a>&amp; sad) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  sad.<a class="code" href="classSpeciesAuxData.html#a9241e409c2b7a56789faf65196103ace">InitFromSpeciesData</a>();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="classVector.html">Vector</a> grid(1, 1.);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="classArray.html">ArrayOfGriddedField1</a> ratios;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  ratios.resize(1);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  ratios[0].set_name(<span class="stringliteral">&quot;IsoRatios&quot;</span>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  ratios[0].set_grid_name(0, <span class="stringliteral">&quot;Index&quot;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  ratios[0].set_grid(0, grid);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  ratios[0].resize(1);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isp = 0; isp &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem(); isp++) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> iiso = 0; iiso &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[isp].Isotopologue().<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         iiso++) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      ratios[0].data[0] = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[isp].Isotopologue()[iiso].Abundance();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      sad.<a class="code" href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">setParam</a>(isp, iiso, <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa59b30c47673d74b0e042651cf57c1367">SpeciesAuxData::AT_ISOTOPOLOGUE_RATIO</a>, ratios);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="absorption_8h.html#ab09f5375e04dac0cc7e9df976e4e1dda">  417</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="absorption_8cc.html#ab09f5375e04dac0cc7e9df976e4e1dda">fillSpeciesAuxDataWithPartitionFunctionsFromSpeciesData</a>(</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classSpeciesAuxData.html">SpeciesAuxData</a>&amp; sad) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  sad.<a class="code" href="classSpeciesAuxData.html#a9241e409c2b7a56789faf65196103ace">InitFromSpeciesData</a>();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="classArray.html">ArrayOfGriddedField1</a> pfuncs;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  pfuncs.resize(2);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  pfuncs[0].set_name(<span class="stringliteral">&quot;PartitionFunction&quot;</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  pfuncs[0].set_grid_name(0, <span class="stringliteral">&quot;Coeff&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  pfuncs[1].set_grid_name(0, <span class="stringliteral">&quot;Temperature&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="classArray.html">ArrayOfString</a> tgrid;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  tgrid.resize(2);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  tgrid[0] = <span class="stringliteral">&quot;Tlower&quot;</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  tgrid[1] = <span class="stringliteral">&quot;Tupper&quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> isp = 0; isp &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem(); isp++) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> iiso = 0; iiso &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[isp].Isotopologue().<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         iiso++) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="classVector.html">Vector</a> grid;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; coeffs = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[isp].Isotopologue()[iiso].GetCoeff();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      assert(coeffs.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() &gt;= 2);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="math__funcs_8cc.html#a0ae25d3a4a2dc049c7c448f866f2ce37">nlinspace</a>(grid, 0, (<a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>)coeffs.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() - 1., coeffs.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>());</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      pfuncs[0].set_grid(0, grid);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      pfuncs[0].data = coeffs;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; temp_range =</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[isp].Isotopologue()[iiso].GetCoeffGrid();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="comment">// Temperature data should either contain two Ts, lower and upper value of</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="comment">// the valid range or be empty</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      assert(temp_range.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() == 0 || temp_range.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() == 2);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">if</span> (temp_range.<a class="code" href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">nelem</a>() == 2) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        pfuncs[1].set_grid(0, tgrid);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        pfuncs[1].data = temp_range;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        pfuncs[1].resize(0);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        pfuncs[1].set_grid(0, <a class="code" href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a>());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      sad.<a class="code" href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">setParam</a>(</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          isp, iiso, <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa5a7eb94d937638052c28e57b1e6e1718">SpeciesAuxData::AT_PARTITIONFUNCTION_COEFF</a>, pfuncs);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="absorption_8h.html#a1f2c42b98e6bfd0b3779b530419d1d32">  467</a></span>&#160;ostream&amp; <a class="code" href="absorption_8cc.html#a1f2c42b98e6bfd0b3779b530419d1d32">operator&lt;&lt;</a>(ostream&amp; os, <span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; sr) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> j = 0; j &lt; sr.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>().<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>(); ++j) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    os &lt;&lt; sr.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; sr.<a class="code" href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">Isotopologue</a>()[j].Name() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="absorption_8h.html#a3d9a6c58845ed8df2f1567cc826627d6">  474</a></span>&#160;ostream&amp; <a class="code" href="absorption_8cc.html#a1f2c42b98e6bfd0b3779b530419d1d32">operator&lt;&lt;</a>(ostream&amp; os, <span class="keyword">const</span> <a class="code" href="classSpeciesAuxData.html">SpeciesAuxData</a>&amp; sad) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> sp = 0; sp &lt; sad.<a class="code" href="classSpeciesAuxData.html#a4cbe4d27aff1c1f00135be6f14461f33">nspecies</a>(); sp++) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a> = 0; <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a> &lt; sad.<a class="code" href="classSpeciesAuxData.html#a680f2554b995212186ed2357ecd001dd">nisotopologues</a>(sp); <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>++) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      os &lt;&lt; <a class="code" href="absorption_8cc.html#a08fc2f701771c0375607192f6a4b4aa3">species_name_from_species_index</a>(sp) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;         &lt;&lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>[sp].Isotopologue()[<a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>].Name();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; sad.<a class="code" href="classSpeciesAuxData.html#ad4a71a5b6d023ce15f1dd743416c57f7">getTypeString</a>(sp, <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> ip = 0; ip &lt; sad.<a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(sp, <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>).<a class="code" href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">nelem</a>(); ip++)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;AuxData &quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; sad.<a class="code" href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">getParam</a>(sp, <a class="code" href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="absorption_8h.html#afeffa3292c18fa3c14d46a5c2fdef9e5">  500</a></span>&#160;<a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="absorption_8cc.html#afeffa3292c18fa3c14d46a5c2fdef9e5">wavenumber_to_joule</a>(<a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> e) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// Planck constant [Js]</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="constants_8cc.html#ad9059227f91d8cd58ddf8e9b2dcbb7f4">PLANCK_CONST</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// Speed of light [m/s]</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> <a class="code" href="cia_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// Constant to convert lower state energy from cm^-1 to J</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> lower_energy_const = <a class="code" href="constants_8cc.html#ad9059227f91d8cd58ddf8e9b2dcbb7f4">PLANCK_CONST</a> * <a class="code" href="cia_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a> * 1E2;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">return</span> e * lower_energy_const;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//             Functions related to species</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="absorption_8h.html#a8ff7f70d5bd12bd420b962c6a0ac050a">  531</a></span>&#160;<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> <a class="code" href="absorption_8cc.html#a8ff7f70d5bd12bd420b962c6a0ac050a">species_index_from_species_name</a>(<a class="code" href="classmy__basic__string.html">String</a> name) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a363bb2d8d468ea3aa5d932da30bfeb97">global_data::SpeciesMap</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// For the return value:</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> mspecies;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// Trim whitespace</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  name.<a class="code" href="classmy__basic__string.html#a87f8526eebe2e2b9bec82d163663eb09">trim</a>();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">//  cout &lt;&lt; &quot;name / def = &quot; &lt;&lt; name &lt;&lt; &quot; / &quot; &lt;&lt; def &lt;&lt; endl;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// Look for species name in species map:</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  map&lt;String, Index&gt;::const_iterator mi = <a class="code" href="namespaceglobal__data.html#a363bb2d8d468ea3aa5d932da30bfeb97">SpeciesMap</a>.find(name);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (mi != <a class="code" href="namespaceglobal__data.html#a363bb2d8d468ea3aa5d932da30bfeb97">SpeciesMap</a>.end()) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// Ok, we&#39;ve found the species. Set mspecies.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    mspecies = mi-&gt;second;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// The species does not exist!</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    mspecies = -1;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">return</span> mspecies;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="absorption_8h.html#a08fc2f701771c0375607192f6a4b4aa3">  569</a></span>&#160;<a class="code" href="classmy__basic__string.html">String</a> <a class="code" href="absorption_8cc.html#a08fc2f701771c0375607192f6a4b4aa3">species_name_from_species_index</a>(<span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> spec_ind) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// Species lookup data:</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="comment">// Assert that spec_ind is inside species data. (This is an assertion,</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// because species indices should never be user input, but set by the</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// program automatically, based on species names.)</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  assert(spec_ind &gt;= 0);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  assert(spec_ind &lt; <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>.nelem());</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// A reference to the relevant record of the species data:</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; spr = <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">species_data</a>[spec_ind];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">return</span> spr.<a class="code" href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">Name</a>();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="absorption_8h.html#adc4ba53d7c10fbad1cc87c6e27f86768">  597</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="absorption_8cc.html#adc4ba53d7c10fbad1cc87c6e27f86768">set_vmr_from_first_species</a>(<a class="code" href="classVector.html">Vector</a>&amp; vmr,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classmy__basic__string.html">String</a>&amp; species_name,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfArrayOfSpeciesTag</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classMatrix.html">Matrix</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aa3c8583f546f0aeedcbc3bf96b606c14">abs_vmrs</a>) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> index = <a class="code" href="abs__species__tags_8cc.html#a2a09f6b70a7eb3b968351bd55c4a9957">find_first_species_tg</a>(</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>, <a class="code" href="absorption_8cc.html#a8ff7f70d5bd12bd420b962c6a0ac050a">species_index_from_species_name</a> (species_name));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  vmr.<a class="code" href="classVector.html#a61656c22a30642d95b31ba73e1171323">resize</a>(<a class="code" href="namespaceARTS_1_1Var.html#aa3c8583f546f0aeedcbc3bf96b606c14">abs_vmrs</a>.ncols());</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">if</span> (index &lt; 0)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    vmr = -99;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    vmr = <a class="code" href="namespaceARTS_1_1Var.html#aa3c8583f546f0aeedcbc3bf96b606c14">abs_vmrs</a>(index, <a class="code" href="classRange.html">Range</a>(<a class="code" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>));</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno"><a class="line" href="absorption_8h.html#a68640b82587586e0e806f16a1d5ddac1">  611</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classSpeciesRecord.html">SpeciesRecord</a>&amp; <a class="code" href="absorption_8cc.html#a68640b82587586e0e806f16a1d5ddac1">SpeciesDataOfBand</a>(<span class="keyword">const</span> <a class="code" href="classAbsorption_1_1Lines.html">AbsorptionLines</a>&amp; band)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a>[band.<a class="code" href="classAbsorption_1_1Lines.html#ada11b2a5ee6a43cd9071cc7466bfacc0">Species</a>()];</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="absorption_8h.html#affc649df9d1d58549f338aee146982f8">  616</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="absorption_8cc.html#affc649df9d1d58549f338aee146982f8">xsec_species</a>(<a class="code" href="classMatrix.html">Matrix</a>&amp; xsec,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                  <a class="code" href="classMatrix.html">Matrix</a>&amp; source,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                  <a class="code" href="classMatrix.html">Matrix</a>&amp; phase,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                  <a class="code" href="classArray.html">ArrayOfMatrix</a>&amp; dxsec_dx,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                  <a class="code" href="classArray.html">ArrayOfMatrix</a>&amp; dsource_dx,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                  <a class="code" href="classArray.html">ArrayOfMatrix</a>&amp; dphase_dx,</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfRetrievalQuantity</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">jacobian_quantities</a>,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfIndex</a>&amp; jacobian_propmat_positions,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a656f34b4c40189bd3c971e2d3dbe3b95">f_grid</a>,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#ab85ad6bc45f2cbce376145d8f1bc15a5">abs_p</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#a8a9d2944bbbcaa17d12cbe5c4f9f289c">abs_t</a>,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classEnergyLevelMap.html">EnergyLevelMap</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aea97dfc5c925ab9fa8660722090cb8b6">abs_nlte</a>,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classMatrix.html">Matrix</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aa3c8583f546f0aeedcbc3bf96b606c14">abs_vmrs</a>,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfArrayOfSpeciesTag</a>&amp; <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classAbsorption_1_1Lines.html">AbsorptionLines</a>&amp; band,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&amp; isot_ratio,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810ef">SpeciesAuxData::AuxType</a>&amp; partfun_type,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classArray.html">ArrayOfGriddedField1</a>&amp; partfun_data) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// Size of problem</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> np = <a class="code" href="namespaceARTS_1_1Var.html#ab85ad6bc45f2cbce376145d8f1bc15a5">abs_p</a>.nelem();      <span class="comment">// number of pressure levels</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nf = <a class="code" href="namespaceARTS_1_1Var.html#a656f34b4c40189bd3c971e2d3dbe3b95">f_grid</a>.nelem();     <span class="comment">// number of Dirac frequencies</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nl = band.<a class="code" href="classAbsorption_1_1Lines.html#a6c31f06cb7594581da15971eb5af93f4">NumLines</a>();  <span class="comment">// number of lines in the catalog</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nj =</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      jacobian_propmat_positions.<a class="code" href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">nelem</a>();  <span class="comment">// number of partial derivatives</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> nt = source.<a class="code" href="classConstMatrixView.html#a8f6cf3776fcfc2f389d9514bc0676147">nrows</a>();         <span class="comment">// number of energy levels in NLTE</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// Type of problem</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> do_nonlte = nt;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <a class="code" href="classLinefunctions_1_1InternalData.html">Linefunctions::InternalData</a> scratch(nf, nj);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <a class="code" href="classLinefunctions_1_1InternalData.html">Linefunctions::InternalData</a> sum(nf, nj);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// Test if the size of the problem is 0</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">if</span> (not np or not nf or not nl) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// Constant for all lines</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> QT0 = <a class="code" href="linescaling_8cc.html#ae5ebeecda7288b6935a6de67a213a00c">single_partition_function</a>(band.<a class="code" href="classAbsorption_1_1Lines.html#a810c25d0831147858c34d1e8ae9a5c2c">T0</a>(), partfun_type, partfun_data);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <a class="code" href="classArray.html">ArrayOfString</a> fail_msg;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">bool</span> do_abort = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#pragma omp parallel for if (!arts_omp_in_parallel() &amp;&amp; np &gt; 1) \</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor">    firstprivate(scratch, sum)</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> ip = 0; ip &lt; np; ip++) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">if</span> (do_abort) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">// Constants for this level</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&amp; temperature = <a class="code" href="namespaceARTS_1_1Var.html#a8a9d2944bbbcaa17d12cbe5c4f9f289c">abs_t</a>[ip];</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a>&amp; pressure = <a class="code" href="namespaceARTS_1_1Var.html#ab85ad6bc45f2cbce376145d8f1bc15a5">abs_p</a>[ip];</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="comment">// Constants for this level</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> QT =</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          <a class="code" href="linescaling_8cc.html#ae5ebeecda7288b6935a6de67a213a00c">single_partition_function</a>(temperature, partfun_type, partfun_data);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> dQTdT = <a class="code" href="linescaling_8cc.html#a8dfba87e0c8a8c49c84a926bc609f9d1">dsingle_partition_function_dT</a>(</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          QT,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          temperature,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;          <a class="code" href="jacobian_8cc.html#adc8530aa92c4a96715f4be6203bd8b0b">temperature_perturbation</a>(<a class="code" href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">jacobian_quantities</a>),</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          partfun_type,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          partfun_data);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> DC =</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          <a class="code" href="namespaceLinefunctions.html#a770118e293deb4ed5108f7a481921162">Linefunctions::DopplerConstant</a>(temperature, band.<a class="code" href="classAbsorption_1_1Lines.html#ae5be0c6cd1039463fb1709432ad7e7db">SpeciesMass</a>());</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keyword">const</span> <a class="code" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> dDCdT = <a class="code" href="namespaceLinefunctions.html#a3e0ce20f6ce98dfe751eee8d6d86a2ab">Linefunctions::dDopplerConstant_dT</a>(temperature, DC);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> line_shape_vmr =</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          band.<a class="code" href="classAbsorption_1_1Lines.html#a04ba89b14162e6aef251b0c8255d323f">BroadeningSpeciesVMR</a>(<a class="code" href="namespaceARTS_1_1Var.html#aa3c8583f546f0aeedcbc3bf96b606c14">abs_vmrs</a>(<a class="code" href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a>, ip), <a class="code" href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">abs_species</a>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <a class="code" href="namespaceLinefunctions.html#aa8288ab4c09cddb5e3c3a28a96a64463">Linefunctions::set_cross_section_of_band</a>(scratch,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                               sum,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                               <a class="code" href="namespaceARTS_1_1Var.html#a656f34b4c40189bd3c971e2d3dbe3b95">f_grid</a>,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                               band,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                               <a class="code" href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">jacobian_quantities</a>,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                               jacobian_propmat_positions,</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                               line_shape_vmr,</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                               <a class="code" href="namespaceARTS_1_1Var.html#aea97dfc5c925ab9fa8660722090cb8b6">abs_nlte</a>[ip],</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                               pressure,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                               temperature,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                               isot_ratio,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                               0,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                               DC,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                               dDCdT,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                               QT,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                               dQTdT,</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                               QT0,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                               <span class="keyword">false</span>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="comment">// absorption cross-section</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <a class="code" href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a>(xsec).col(ip).noalias() += sum.<a class="code" href="classLinefunctions_1_1InternalData.html#ab601be0a3533006883949c8b234e9bb5">F</a>.real();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> j = 0; j &lt; nj; j++)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <a class="code" href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a>(dxsec_dx[j]).col(ip).noalias() += sum.<a class="code" href="classLinefunctions_1_1InternalData.html#a6899ae6ba5f3eddbcda5dedd8f6898e8">dF</a>.col(j).real();</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="comment">// phase cross-section</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">if</span> (not phase.<a class="code" href="classConstMatrixView.html#a9bd92eedf3e5d28cfcbd74a0f08016a4">empty</a>()) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a>(phase).col(ip).noalias() += sum.<a class="code" href="classLinefunctions_1_1InternalData.html#ab601be0a3533006883949c8b234e9bb5">F</a>.imag();</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> j = 0; j &lt; nj; j++)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          <a class="code" href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a>(dphase_dx[j]).col(ip).noalias() += sum.<a class="code" href="classLinefunctions_1_1InternalData.html#a6899ae6ba5f3eddbcda5dedd8f6898e8">dF</a>.col(j).imag();</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// source ratio cross-section</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (do_nonlte) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a>(source).col(ip).noalias() += sum.<a class="code" href="classLinefunctions_1_1InternalData.html#a735b02efcebad384f279b8d7c7d24c42">N</a>.real();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> j = 0; j &lt; nj; j++)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          <a class="code" href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a>(dsource_dx[j]).col(ip).noalias() += sum.<a class="code" href="classLinefunctions_1_1InternalData.html#a9fd5e8a8fb10337cf83b0744081a1268">dN</a>.col(j).real();</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::runtime_error&amp; e) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      ostringstream os;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Runtime-error in cross-section calculation at p_abs index &quot;</span> &lt;&lt; ip</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;: \n&quot;</span>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      os &lt;&lt; e.what();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor">#pragma omp critical(xsec_species_cross_sections)</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        do_abort = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        fail_msg.push_back(os.str());</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span> (do_abort) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Error messages from failed cases:\n&quot;</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; msg : fail_msg) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      os &lt;&lt; msg &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(os.str());</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassMatrix_html"><div class="ttname"><a href="classMatrix.html">Matrix</a></div><div class="ttdoc">The Matrix class.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8h_source.html#l01193">matpackI.h:1193</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_a8a96b3b64f2d5daab0cf237bdce30313"><div class="ttname"><a href="absorption_8cc.html#a8a96b3b64f2d5daab0cf237bdce30313">checkPartitionFunctions</a></div><div class="ttdeci">void checkPartitionFunctions(const ArrayOfArrayOfSpeciesTag &amp;abs_species, const SpeciesAuxData &amp;partfun)</div><div class="ttdoc">Check that partition functions for the given species are correctly defined.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00356">absorption.cc:356</a></div></div>
<div class="ttc" id="aclassLinefunctions_1_1InternalData_html_a6899ae6ba5f3eddbcda5dedd8f6898e8"><div class="ttname"><a href="classLinefunctions_1_1InternalData.html#a6899ae6ba5f3eddbcda5dedd8f6898e8">Linefunctions::InternalData::dF</a></div><div class="ttdeci">Eigen::MatrixXcd dF</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8h_source.html#l00522">linefunctions.h:522</a></div></div>
<div class="ttc" id="aclassQuantumIdentifier_html_ab35ca56206cf1a9688d15fcce7732a7a"><div class="ttname"><a href="classQuantumIdentifier.html#ab35ca56206cf1a9688d15fcce7732a7a">QuantumIdentifier::Isotopologue</a></div><div class="ttdeci">void Isotopologue(Index iso)</div><div class="ttdoc">Set the Isotopologue.</div><div class="ttdef"><b>Definition:</b> <a href="quantum_8h_source.html#l00487">quantum.h:487</a></div></div>
<div class="ttc" id="aclassQuantumIdentifier_html"><div class="ttname"><a href="classQuantumIdentifier.html">QuantumIdentifier</a></div><div class="ttdoc">Class to identify and match lines by their quantum numbers.</div><div class="ttdef"><b>Definition:</b> <a href="quantum_8h_source.html#l00390">quantum.h:390</a></div></div>
<div class="ttc" id="aauto__md_8h_html"><div class="ttname"><a href="auto__md_8h.html">auto_md.h</a></div></div>
<div class="ttc" id="aclassSpecIsoMap_html"><div class="ttname"><a href="classSpecIsoMap.html">SpecIsoMap</a></div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00338">absorption.h:338</a></div></div>
<div class="ttc" id="aclassAbsorption_1_1Lines_html_a04ba89b14162e6aef251b0c8255d323f"><div class="ttname"><a href="classAbsorption_1_1Lines.html#a04ba89b14162e6aef251b0c8255d323f">Absorption::Lines::BroadeningSpeciesVMR</a></div><div class="ttdeci">Vector BroadeningSpeciesVMR(const ConstVectorView, const ArrayOfArrayOfSpeciesTag &amp;) const</div><div class="ttdoc">Returns the VMRs of the broadening species.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8cc_source.html#l02730">absorptionlines.cc:2730</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a750085e9b1eb18fb917b5fd5a3c82149"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a750085e9b1eb18fb917b5fd5a3c82149">ARTS::Var::jacobian_quantities</a></div><div class="ttdeci">ArrayOfRetrievalQuantity jacobian_quantities(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l03924">autoarts.h:3924</a></div></div>
<div class="ttc" id="aabsorption_8h_html"><div class="ttname"><a href="absorption_8h.html">absorption.h</a></div><div class="ttdoc">Declarations required for the calculation of absorption coefficients.</div></div>
<div class="ttc" id="apartition__function__data_8cc_html_a0617b447ed1866508e296f0a2435a6b3"><div class="ttname"><a href="partition__function__data_8cc.html#a0617b447ed1866508e296f0a2435a6b3">iso</a></div><div class="ttdeci">void iso(Array&lt; IsotopologueRecord &gt;::iterator &amp;ii, String name, const ArrayOfNumeric &amp;coeff, const ArrayOfNumeric &amp;temp_range, const Index &amp;coefftype)</div><div class="ttdoc">Initialize isotopologue and move iterator to next one.</div><div class="ttdef"><b>Definition:</b> <a href="partition__function__data_8cc_source.html#l01732">partition_function_data.cc:1732</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_ab09f5375e04dac0cc7e9df976e4e1dda"><div class="ttname"><a href="absorption_8cc.html#ab09f5375e04dac0cc7e9df976e4e1dda">fillSpeciesAuxDataWithPartitionFunctionsFromSpeciesData</a></div><div class="ttdeci">void fillSpeciesAuxDataWithPartitionFunctionsFromSpeciesData(SpeciesAuxData &amp;sad)</div><div class="ttdoc">Fill SpeciesAuxData with default partition functions from species data.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00417">absorption.cc:417</a></div></div>
<div class="ttc" id="aclassLinefunctions_1_1InternalData_html_a735b02efcebad384f279b8d7c7d24c42"><div class="ttname"><a href="classLinefunctions_1_1InternalData.html#a735b02efcebad384f279b8d7c7d24c42">Linefunctions::InternalData::N</a></div><div class="ttdeci">Eigen::VectorXcd N</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8h_source.html#l00521">linefunctions.h:521</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_a68640b82587586e0e806f16a1d5ddac1"><div class="ttname"><a href="absorption_8cc.html#a68640b82587586e0e806f16a1d5ddac1">SpeciesDataOfBand</a></div><div class="ttdeci">const SpeciesRecord &amp; SpeciesDataOfBand(const AbsorptionLines &amp;band)</div><div class="ttdoc">Returns the species data.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00611">absorption.cc:611</a></div></div>
<div class="ttc" id="aclassAbsorption_1_1Lines_html_a6c31f06cb7594581da15971eb5af93f4"><div class="ttname"><a href="classAbsorption_1_1Lines.html#a6c31f06cb7594581da15971eb5af93f4">Absorption::Lines::NumLines</a></div><div class="ttdeci">Index NumLines() const noexcept</div><div class="ttdoc">Number of lines.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8h_source.html#l00852">absorptionlines.h:852</a></div></div>
<div class="ttc" id="anamespaceLinefunctions_html_aa8288ab4c09cddb5e3c3a28a96a64463"><div class="ttname"><a href="namespaceLinefunctions.html#aa8288ab4c09cddb5e3c3a28a96a64463">Linefunctions::set_cross_section_of_band</a></div><div class="ttdeci">void set_cross_section_of_band(InternalData &amp;scratch, InternalData &amp;sum, const ConstVectorView f_grid, const AbsorptionLines &amp;band, const ArrayOfRetrievalQuantity &amp;derivatives_data, const ArrayOfIndex &amp;derivatives_data_active, const Vector &amp;vmrs, const EnergyLevelMap &amp;nlte, const Numeric &amp;P, const Numeric &amp;T, const Numeric &amp;isot_ratio, const Numeric &amp;H, const Numeric &amp;DC, const Numeric &amp;dDCdT, const Numeric &amp;QT, const Numeric &amp;dQTdT, const Numeric &amp;QT0, const bool no_negatives=false, const bool zeeman=false, const Zeeman::Polarization zeeman_polarization=Zeeman::Polarization::Pi)</div><div class="ttdoc">Computes the cross-section of an absorption band.</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8cc_source.html#l01291">linefunctions.cc:1291</a></div></div>
<div class="ttc" id="amatpackI_8cc_html_a90b23039dd2b40cea42532da6f731144"><div class="ttname"><a href="matpackI_8cc.html#a90b23039dd2b40cea42532da6f731144">joker</a></div><div class="ttdeci">const Joker joker</div></div>
<div class="ttc" id="aclassAbsorption_1_1Lines_html_a810c25d0831147858c34d1e8ae9a5c2c"><div class="ttname"><a href="classAbsorption_1_1Lines.html#a810c25d0831147858c34d1e8ae9a5c2c">Absorption::Lines::T0</a></div><div class="ttdeci">Numeric T0() const noexcept</div><div class="ttdoc">Returns reference temperature.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8h_source.html#l01311">absorptionlines.h:1311</a></div></div>
<div class="ttc" id="aconstants_8cc_html_ad9059227f91d8cd58ddf8e9b2dcbb7f4"><div class="ttname"><a href="constants_8cc.html#ad9059227f91d8cd58ddf8e9b2dcbb7f4">PLANCK_CONST</a></div><div class="ttdeci">const Numeric PLANCK_CONST</div><div class="ttdoc">Global constant, the Planck constant [Js].</div></div>
<div class="ttc" id="alinefunctions_8h_html"><div class="ttname"><a href="linefunctions_8h.html">linefunctions.h</a></div><div class="ttdoc">Stuff related to lineshape functions.</div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a7ed018d4c1e770e0480c72d2ae91cfff"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a7ed018d4c1e770e0480c72d2ae91cfff">ARTS::Var::verbosity</a></div><div class="ttdeci">Verbosity verbosity(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l07112">autoarts.h:7112</a></div></div>
<div class="ttc" id="ajacobian_8cc_html_adc8530aa92c4a96715f4be6203bd8b0b"><div class="ttname"><a href="jacobian_8cc.html#adc8530aa92c4a96715f4be6203bd8b0b">temperature_perturbation</a></div><div class="ttdeci">Numeric temperature_perturbation(const ArrayOfRetrievalQuantity &amp;js) noexcept</div><div class="ttdoc">Returns the temperature perturbation if it exists.</div><div class="ttdef"><b>Definition:</b> <a href="jacobian_8cc_source.html#l01304">jacobian.cc:1304</a></div></div>
<div class="ttc" id="alinescaling_8cc_html_a8dfba87e0c8a8c49c84a926bc609f9d1"><div class="ttname"><a href="linescaling_8cc.html#a8dfba87e0c8a8c49c84a926bc609f9d1">dsingle_partition_function_dT</a></div><div class="ttdeci">Numeric dsingle_partition_function_dT(const Numeric &amp;QT, const Numeric &amp;T, const Numeric &amp;dT, const SpeciesAuxData::AuxType &amp;partition_type, const ArrayOfGriddedField1 &amp;partition_data)</div><div class="ttdoc">Computes the partition function temperature derivative.</div><div class="ttdef"><b>Definition:</b> <a href="linescaling_8cc_source.html#l00087">linescaling.cc:87</a></div></div>
<div class="ttc" id="anamespaceglobal__data_html_a363bb2d8d468ea3aa5d932da30bfeb97"><div class="ttname"><a href="namespaceglobal__data.html#a363bb2d8d468ea3aa5d932da30bfeb97">global_data::SpeciesMap</a></div><div class="ttdeci">const map&lt; String, Index &gt; SpeciesMap</div><div class="ttdoc">The map associated with species_data.</div><div class="ttdef"><b>Definition:</b> <a href="species__data_8cc_source.html#l00044">species_data.cc:44</a></div></div>
<div class="ttc" id="aclassVector_html_a61656c22a30642d95b31ba73e1171323"><div class="ttname"><a href="classVector.html#a61656c22a30642d95b31ba73e1171323">Vector::resize</a></div><div class="ttdeci">void resize(Index n)</div><div class="ttdoc">Resize function.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8cc_source.html#l00404">matpackI.cc:404</a></div></div>
<div class="ttc" id="alinescaling_8cc_html_ae5ebeecda7288b6935a6de67a213a00c"><div class="ttname"><a href="linescaling_8cc.html#ae5ebeecda7288b6935a6de67a213a00c">single_partition_function</a></div><div class="ttdeci">Numeric single_partition_function(const Numeric &amp;T, const SpeciesAuxData::AuxType &amp;partition_type, const ArrayOfGriddedField1 &amp;partition_data)</div><div class="ttdoc">Computes the partition function at one temperature.</div><div class="ttdef"><b>Definition:</b> <a href="linescaling_8cc_source.html#l00072">linescaling.cc:72</a></div></div>
<div class="ttc" id="aclassLinefunctions_1_1InternalData_html"><div class="ttname"><a href="classLinefunctions_1_1InternalData.html">Linefunctions::InternalData</a></div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8h_source.html#l00518">linefunctions.h:518</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_a0e1c07089fb5ec4af31b796b8cfbd8a4"><div class="ttname"><a href="classSpeciesAuxData.html#a0e1c07089fb5ec4af31b796b8cfbd8a4">SpeciesAuxData::ReadFromStream</a></div><div class="ttdeci">bool ReadFromStream(String &amp;artsid, istream &amp;is, Index nparams, const Verbosity &amp;verbosity)</div><div class="ttdoc">Read parameters from input stream (only for version 1 format).</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00167">absorption.cc:167</a></div></div>
<div class="ttc" id="aclassConstMatrixView_html_a8f6cf3776fcfc2f389d9514bc0676147"><div class="ttname"><a href="classConstMatrixView.html#a8f6cf3776fcfc2f389d9514bc0676147">ConstMatrixView::nrows</a></div><div class="ttdeci">Index nrows() const</div><div class="ttdoc">Returns the number of rows.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8cc_source.html#l00429">matpackI.cc:429</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_ace534a09a20ff381fd83fd67761810efa5f1a54b54d34a94c173a4b2504a2bb76"><div class="ttname"><a href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa5f1a54b54d34a94c173a4b2504a2bb76">SpeciesAuxData::AT_FINAL_ENTRY</a></div><div class="ttdeci">@ AT_FINAL_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00227">absorption.h:226</a></div></div>
<div class="ttc" id="anamespaceglobal__data_html_a009dd2016507743cacae2f8ceec72cab"><div class="ttname"><a href="namespaceglobal__data.html#a009dd2016507743cacae2f8ceec72cab">global_data::species_data</a></div><div class="ttdeci">const Array&lt; SpeciesRecord &gt; species_data</div><div class="ttdoc">Species Data.</div><div class="ttdef"><b>Definition:</b> <a href="partition__function__data_8cc_source.html#l00042">partition_function_data.cc:42</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_a57d8ea1a75c23afb7ae89e1b3d4cd42b"><div class="ttname"><a href="classSpeciesAuxData.html#a57d8ea1a75c23afb7ae89e1b3d4cd42b">SpeciesAuxData::setParam</a></div><div class="ttdeci">void setParam(const Index species, const Index isotopologue, const AuxType auxtype, const ArrayOfGriddedField1 &amp;auxdata)</div><div class="ttdoc">Set parameter.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00076">absorption.cc:76</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_a982f08bf85a593800a48efbc56b277e2"><div class="ttname"><a href="classSpeciesAuxData.html#a982f08bf85a593800a48efbc56b277e2">SpeciesAuxData::getParam</a></div><div class="ttdeci">const ArrayOfGriddedField1 &amp; getParam(const Index species, const Index isotopologue) const</div><div class="ttdoc">Return a constant reference to the parameters.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00145">absorption.cc:145</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html"><div class="ttname"><a href="classSpeciesAuxData.html">SpeciesAuxData</a></div><div class="ttdoc">Auxiliary data for isotopologues.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00217">absorption.h:217</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_aa3c8583f546f0aeedcbc3bf96b606c14"><div class="ttname"><a href="namespaceARTS_1_1Var.html#aa3c8583f546f0aeedcbc3bf96b606c14">ARTS::Var::abs_vmrs</a></div><div class="ttdeci">Matrix abs_vmrs(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02267">autoarts.h:2267</a></div></div>
<div class="ttc" id="amystring_8h_html_afc5876f67c276e93394c19e99c23eba4"><div class="ttname"><a href="mystring_8h.html#afc5876f67c276e93394c19e99c23eba4">extract</a></div><div class="ttdeci">void extract(T &amp;x, String &amp;line, Index n)</div><div class="ttdoc">Extract something from the beginning of a string.</div><div class="ttdef"><b>Definition:</b> <a href="mystring_8h_source.html#l00297">mystring.h:297</a></div></div>
<div class="ttc" id="aclassAbsorption_1_1Lines_html_ae5be0c6cd1039463fb1709432ad7e7db"><div class="ttname"><a href="classAbsorption_1_1Lines.html#ae5be0c6cd1039463fb1709432ad7e7db">Absorption::Lines::SpeciesMass</a></div><div class="ttdeci">Numeric SpeciesMass() const noexcept</div><div class="ttdoc">Mass of the molecule.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8cc_source.html#l02725">absorptionlines.cc:2725</a></div></div>
<div class="ttc" id="aclassArray_html"><div class="ttname"><a href="classArray.html">Array</a></div><div class="ttdoc">This can be used to make arrays out of anything.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00108">array.h:108</a></div></div>
<div class="ttc" id="aclassSpeciesTag_html"><div class="ttname"><a href="classSpeciesTag.html">SpeciesTag</a></div><div class="ttdoc">A tag group can consist of the sum of several of these.</div><div class="ttdef"><b>Definition:</b> <a href="abs__species__tags_8h_source.html#l00044">abs_species_tags.h:44</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_ace534a09a20ff381fd83fd67761810efa5a7eb94d937638052c28e57b1e6e1718"><div class="ttname"><a href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa5a7eb94d937638052c28e57b1e6e1718">SpeciesAuxData::AT_PARTITIONFUNCTION_COEFF</a></div><div class="ttdeci">@ AT_PARTITIONFUNCTION_COEFF</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00224">absorption.h:224</a></div></div>
<div class="ttc" id="anamespaceAbsorption_html_a5694bacde9aa335dc5ec69d50f201992"><div class="ttname"><a href="namespaceAbsorption.html#a5694bacde9aa335dc5ec69d50f201992">Absorption::nelem</a></div><div class="ttdeci">Index nelem(const Lines &amp;l)</div><div class="ttdoc">Number of lines.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8h_source.html#l01820">absorptionlines.h:1820</a></div></div>
<div class="ttc" id="acomplex_8cc_html_a79a18b72864daf76c36f123c0ca626b4"><div class="ttname"><a href="complex_8cc.html#a79a18b72864daf76c36f123c0ca626b4">MapToEigen</a></div><div class="ttdeci">ComplexConstMatrixViewMap MapToEigen(const ConstComplexMatrixView &amp;A)</div><div class="ttdef"><b>Definition:</b> <a href="complex_8cc_source.html#l01655">complex.cc:1655</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_af5b40edaf07dc531b56f62e0066e6867"><div class="ttname"><a href="classSpeciesAuxData.html#af5b40edaf07dc531b56f62e0066e6867">SpeciesAuxData::mparam_type</a></div><div class="ttdeci">ArrayOfArrayOfAuxType mparam_type</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00318">absorption.h:318</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_a8ff7f70d5bd12bd420b962c6a0ac050a"><div class="ttname"><a href="absorption_8cc.html#a8ff7f70d5bd12bd420b962c6a0ac050a">species_index_from_species_name</a></div><div class="ttdeci">Index species_index_from_species_name(String name)</div><div class="ttdoc">Return species index for given species name.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00531">absorption.cc:531</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_af768c736d4ad29753bcb30cddf1ae09c"><div class="ttname"><a href="classSpeciesAuxData.html#af768c736d4ad29753bcb30cddf1ae09c">SpeciesAuxData::getIsotopologueRatio</a></div><div class="ttdeci">Numeric getIsotopologueRatio(const SpeciesTag &amp;st) const</div><div class="ttdoc">Returns mparams[st.Species()][st.Isotopologue()][0].data[0] if st.Isotopologue() &gt; 0,...</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00150">absorption.cc:150</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_ae4748feadc4b7a101b1060346a4a78af"><div class="ttname"><a href="absorption_8cc.html#ae4748feadc4b7a101b1060346a4a78af">checkIsotopologueRatios</a></div><div class="ttdeci">void checkIsotopologueRatios(const ArrayOfArrayOfSpeciesTag &amp;abs_species, const SpeciesAuxData &amp;isoratios)</div><div class="ttdoc">Check that isotopologue ratios for the given species are correctly defined.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00301">absorption.cc:301</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_adc4ba53d7c10fbad1cc87c6e27f86768"><div class="ttname"><a href="absorption_8cc.html#adc4ba53d7c10fbad1cc87c6e27f86768">set_vmr_from_first_species</a></div><div class="ttdeci">void set_vmr_from_first_species(Vector &amp;vmr, const String &amp;species_name, const ArrayOfArrayOfSpeciesTag &amp;abs_species, const Matrix &amp;abs_vmrs)</div><div class="ttdoc">set_abs_from_first_species.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00597">absorption.cc:597</a></div></div>
<div class="ttc" id="amessages_8h_html_a1ad21a2081b7fa459cace45d863de67d"><div class="ttname"><a href="messages_8h.html#a1ad21a2081b7fa459cace45d863de67d">CREATE_OUT3</a></div><div class="ttdeci">#define CREATE_OUT3</div><div class="ttdef"><b>Definition:</b> <a href="messages_8h_source.html#l00207">messages.h:207</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_a08fc2f701771c0375607192f6a4b4aa3"><div class="ttname"><a href="absorption_8cc.html#a08fc2f701771c0375607192f6a4b4aa3">species_name_from_species_index</a></div><div class="ttdeci">String species_name_from_species_index(const Index spec_ind)</div><div class="ttdoc">Return species name for given species index.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00569">absorption.cc:569</a></div></div>
<div class="ttc" id="aclassQuantumIdentifier_html_ad875cde8f4af6b5e84ed5d0c2ceefa47"><div class="ttname"><a href="classQuantumIdentifier.html#ad875cde8f4af6b5e84ed5d0c2ceefa47">QuantumIdentifier::Species</a></div><div class="ttdeci">void Species(Index sp)</div><div class="ttdoc">Set the Species.</div><div class="ttdef"><b>Definition:</b> <a href="quantum_8h_source.html#l00481">quantum.h:481</a></div></div>
<div class="ttc" id="amessages_8h_html"><div class="ttname"><a href="messages_8h.html">messages.h</a></div><div class="ttdoc">Declarations having to do with the four output streams.</div></div>
<div class="ttc" id="aabsorption_8cc_html_a1f2c42b98e6bfd0b3779b530419d1d32"><div class="ttname"><a href="absorption_8cc.html#a1f2c42b98e6bfd0b3779b530419d1d32">operator&lt;&lt;</a></div><div class="ttdeci">ostream &amp; operator&lt;&lt;(ostream &amp;os, const SpeciesRecord &amp;sr)</div><div class="ttdoc">Output operator for SpeciesRecord.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00467">absorption.cc:467</a></div></div>
<div class="ttc" id="aclassmy__basic__string_html"><div class="ttname"><a href="classmy__basic__string.html">my_basic_string&lt; char &gt;</a></div></div>
<div class="ttc" id="amystring_8h_html_a5a4f816cf420f583aa1b2e24453fdd74"><div class="ttname"><a href="mystring_8h.html#a5a4f816cf420f583aa1b2e24453fdd74">ArrayOfString</a></div><div class="ttdeci">Array&lt; String &gt; ArrayOfString</div><div class="ttdoc">An array of Strings.</div><div class="ttdef"><b>Definition:</b> <a href="mystring_8h_source.html#l00283">mystring.h:283</a></div></div>
<div class="ttc" id="aclassConstVectorView_html_a213a97c28cd05116cab820e32d2f102f"><div class="ttname"><a href="classConstVectorView.html#a213a97c28cd05116cab820e32d2f102f">ConstVectorView::nelem</a></div><div class="ttdeci">Index nelem() const</div><div class="ttdoc">Returns the number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8cc_source.html#l00051">matpackI.cc:51</a></div></div>
<div class="ttc" id="aclassdouble__imanip_html"><div class="ttname"><a href="classdouble__imanip.html">double_imanip</a></div><div class="ttdoc">Input manipulator class for doubles to enable nan and inf parsing.</div><div class="ttdef"><b>Definition:</b> <a href="file_8h_source.html#l00117">file.h:117</a></div></div>
<div class="ttc" id="aabs__species__tags_8cc_html_a2a09f6b70a7eb3b968351bd55c4a9957"><div class="ttname"><a href="abs__species__tags_8cc.html#a2a09f6b70a7eb3b968351bd55c4a9957">find_first_species_tg</a></div><div class="ttdeci">Index find_first_species_tg(const ArrayOfArrayOfSpeciesTag &amp;tgs, const Index &amp;spec)</div><div class="ttdoc">Find first occurrence of species in tag groups.</div><div class="ttdef"><b>Definition:</b> <a href="abs__species__tags_8cc_source.html#l00532">abs_species_tags.cc:532</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_aef486282e8f77527bb23bbb623a64e16"><div class="ttname"><a href="namespaceARTS_1_1Var.html#aef486282e8f77527bb23bbb623a64e16">ARTS::Var::abs_species</a></div><div class="ttdeci">ArrayOfArrayOfSpeciesTag abs_species(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02157">autoarts.h:2157</a></div></div>
<div class="ttc" id="amatpack_8h_html_ad9a8dbb27c0bbea7271d916036122f6a"><div class="ttname"><a href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a></div><div class="ttdeci">NUMERIC Numeric</div><div class="ttdoc">The type to use for all floating point numbers.</div><div class="ttdef"><b>Definition:</b> <a href="matpack_8h_source.html#l00033">matpack.h:33</a></div></div>
<div class="ttc" id="aclassVerbosity_html"><div class="ttname"><a href="classVerbosity.html">Verbosity</a></div><div class="ttdef"><b>Definition:</b> <a href="messages_8h_source.html#l00049">messages.h:49</a></div></div>
<div class="ttc" id="aclassSpecIsoMap_html_a544c92f35207f9c75d562209f5653cf9"><div class="ttname"><a href="classSpecIsoMap.html#a544c92f35207f9c75d562209f5653cf9">SpecIsoMap::Speciesindex</a></div><div class="ttdeci">const Index &amp; Speciesindex() const</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00345">absorption.h:345</a></div></div>
<div class="ttc" id="anamespaceLinefunctions_html_a3e0ce20f6ce98dfe751eee8d6d86a2ab"><div class="ttname"><a href="namespaceLinefunctions.html#a3e0ce20f6ce98dfe751eee8d6d86a2ab">Linefunctions::dDopplerConstant_dT</a></div><div class="ttdeci">Numeric dDopplerConstant_dT(const Numeric &amp;T, const Numeric &amp;dc)</div><div class="ttdoc">Returns the temperature derivative of the frequency-independent part of the Doppler broadening.</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8cc_source.html#l00811">linefunctions.cc:811</a></div></div>
<div class="ttc" id="amath__funcs_8h_html"><div class="ttname"><a href="math__funcs_8h.html">math_funcs.h</a></div></div>
<div class="ttc" id="aglobal__data_8h_html"><div class="ttname"><a href="global__data_8h.html">global_data.h</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a656f34b4c40189bd3c971e2d3dbe3b95"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a656f34b4c40189bd3c971e2d3dbe3b95">ARTS::Var::f_grid</a></div><div class="ttdeci">Vector f_grid(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l03449">autoarts.h:3449</a></div></div>
<div class="ttc" id="aclassAbsorption_1_1Lines_html"><div class="ttname"><a href="classAbsorption_1_1Lines.html">Absorption::Lines</a></div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8h_source.html#l00547">absorptionlines.h:547</a></div></div>
<div class="ttc" id="aclassmy__basic__string_html_a87f8526eebe2e2b9bec82d163663eb09"><div class="ttname"><a href="classmy__basic__string.html#a87f8526eebe2e2b9bec82d163663eb09">my_basic_string::trim</a></div><div class="ttdeci">void trim()</div><div class="ttdoc">Trim leading and trailing whitespace.</div><div class="ttdef"><b>Definition:</b> <a href="mystring_8h_source.html#l00225">mystring.h:225</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_a680f2554b995212186ed2357ecd001dd"><div class="ttname"><a href="classSpeciesAuxData.html#a680f2554b995212186ed2357ecd001dd">SpeciesAuxData::nisotopologues</a></div><div class="ttdeci">Index nisotopologues(const Index species) const</div><div class="ttdoc">Returns number of isotopologues for a certain species.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00242">absorption.h:242</a></div></div>
<div class="ttc" id="aclassEnergyLevelMap_html"><div class="ttname"><a href="classEnergyLevelMap.html">EnergyLevelMap</a></div><div class="ttdef"><b>Definition:</b> <a href="energylevelmap_8h_source.html#l00060">energylevelmap.h:60</a></div></div>
<div class="ttc" id="aclassAbsorption_1_1Lines_html_ada11b2a5ee6a43cd9071cc7466bfacc0"><div class="ttname"><a href="classAbsorption_1_1Lines.html#ada11b2a5ee6a43cd9071cc7466bfacc0">Absorption::Lines::Species</a></div><div class="ttdeci">Index Species() const noexcept</div><div class="ttdoc">Species Index.</div><div class="ttdef"><b>Definition:</b> <a href="absorptionlines_8h_source.html#l00846">absorptionlines.h:846</a></div></div>
<div class="ttc" id="aclassSpeciesRecord_html"><div class="ttname"><a href="classSpeciesRecord.html">SpeciesRecord</a></div><div class="ttdoc">Contains the lookup data for one species.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00144">absorption.h:144</a></div></div>
<div class="ttc" id="aclassLinefunctions_1_1InternalData_html_a9fd5e8a8fb10337cf83b0744081a1268"><div class="ttname"><a href="classLinefunctions_1_1InternalData.html#a9fd5e8a8fb10337cf83b0744081a1268">Linefunctions::InternalData::dN</a></div><div class="ttdeci">Eigen::MatrixXcd dN</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8h_source.html#l00523">linefunctions.h:523</a></div></div>
<div class="ttc" id="aclassmy__basic__string_html_a3637b76008e2387e81318a7c50722a5d"><div class="ttname"><a href="classmy__basic__string.html#a3637b76008e2387e81318a7c50722a5d">my_basic_string::nelem</a></div><div class="ttdeci">Index nelem() const</div><div class="ttdoc">Number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="mystring_8h_source.html#l00246">mystring.h:246</a></div></div>
<div class="ttc" id="ainterpolation__poly_8h_html"><div class="ttname"><a href="interpolation__poly_8h.html">interpolation_poly.h</a></div><div class="ttdoc">Header file for interpolation_poly.cc.</div></div>
<div class="ttc" id="aclassConstMatrixView_html_a9bd92eedf3e5d28cfcbd74a0f08016a4"><div class="ttname"><a href="classConstMatrixView.html#a9bd92eedf3e5d28cfcbd74a0f08016a4">ConstMatrixView::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Returns true if variable size is zero.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8cc_source.html#l00426">matpackI.cc:426</a></div></div>
<div class="ttc" id="amath__funcs_8cc_html_a0ae25d3a4a2dc049c7c448f866f2ce37"><div class="ttname"><a href="math__funcs_8cc.html#a0ae25d3a4a2dc049c7c448f866f2ce37">nlinspace</a></div><div class="ttdeci">void nlinspace(Vector &amp;x, const Numeric start, const Numeric stop, const Index n)</div><div class="ttdoc">nlinspace</div><div class="ttdef"><b>Definition:</b> <a href="math__funcs_8cc_source.html#l00231">math_funcs.cc:231</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_a8a9d2944bbbcaa17d12cbe5c4f9f289c"><div class="ttname"><a href="namespaceARTS_1_1Var.html#a8a9d2944bbbcaa17d12cbe5c4f9f289c">ARTS::Var::abs_t</a></div><div class="ttdeci">Vector abs_t(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02186">autoarts.h:2186</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_ace534a09a20ff381fd83fd67761810efa59b30c47673d74b0e042651cf57c1367"><div class="ttname"><a href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa59b30c47673d74b0e042651cf57c1367">SpeciesAuxData::AT_ISOTOPOLOGUE_RATIO</a></div><div class="ttdeci">@ AT_ISOTOPOLOGUE_RATIO</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00221">absorption.h:221</a></div></div>
<div class="ttc" id="anamespaceoem_html_aa1efddaf6e1a5516b2db0bebc1479752"><div class="ttname"><a href="namespaceoem.html#aa1efddaf6e1a5516b2db0bebc1479752">oem::Vector</a></div><div class="ttdeci">invlib::Vector&lt; ArtsVector &gt; Vector</div><div class="ttdoc">invlib wrapper type for ARTS vectors.</div><div class="ttdef"><b>Definition:</b> <a href="oem_8h_source.html#l00032">oem.h:32</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div><div class="ttdoc">The range class.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8h_source.html#l00160">matpackI.h:160</a></div></div>
<div class="ttc" id="aclassSpeciesRecord_html_ac03fd87defae19805ba86dc72b615d65"><div class="ttname"><a href="classSpeciesRecord.html#ac03fd87defae19805ba86dc72b615d65">SpeciesRecord::Isotopologue</a></div><div class="ttdeci">const Array&lt; IsotopologueRecord &gt; &amp; Isotopologue() const</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00199">absorption.h:199</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_aa6e712ce2d9a4fbade1516c3acf13b66"><div class="ttname"><a href="absorption_8cc.html#aa6e712ce2d9a4fbade1516c3acf13b66">fillSpeciesAuxDataWithIsotopologueRatiosFromSpeciesData</a></div><div class="ttdeci">void fillSpeciesAuxDataWithIsotopologueRatiosFromSpeciesData(SpeciesAuxData &amp;sad)</div><div class="ttdoc">Fill SpeciesAuxData with default isotopologue ratios from species data.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00394">absorption.cc:394</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_afeffa3292c18fa3c14d46a5c2fdef9e5"><div class="ttname"><a href="absorption_8cc.html#afeffa3292c18fa3c14d46a5c2fdef9e5">wavenumber_to_joule</a></div><div class="ttdeci">Numeric wavenumber_to_joule(Numeric e)</div><div class="ttdoc">A little helper function to convert energy from units of wavenumber (cm^-1) to Joule (J).</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00500">absorption.cc:500</a></div></div>
<div class="ttc" id="alogic_8h_html"><div class="ttname"><a href="logic_8h.html">logic.h</a></div><div class="ttdoc">Header file for logic.cc.</div></div>
<div class="ttc" id="anamespaceLinefunctions_html_a770118e293deb4ed5108f7a481921162"><div class="ttname"><a href="namespaceLinefunctions.html#a770118e293deb4ed5108f7a481921162">Linefunctions::DopplerConstant</a></div><div class="ttdeci">Numeric DopplerConstant(Numeric T, Numeric mass)</div><div class="ttdoc">Returns the frequency-independent part of the Doppler broadening.</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8cc_source.html#l00807">linefunctions.cc:807</a></div></div>
<div class="ttc" id="aclassSpeciesRecord_html_a15ad9e24e532ae0f833f46806fac8bea"><div class="ttname"><a href="classSpeciesRecord.html#a15ad9e24e532ae0f833f46806fac8bea">SpeciesRecord::Name</a></div><div class="ttdeci">const String &amp; Name() const</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00197">absorption.h:197</a></div></div>
<div class="ttc" id="alinescaling_8h_html"><div class="ttname"><a href="linescaling_8h.html">linescaling.h</a></div><div class="ttdoc">Constains various line scaling functions.</div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_aa8bb4c5adf0ac7bdeb3b4bc7c443869d"><div class="ttname"><a href="classSpeciesAuxData.html#aa8bb4c5adf0ac7bdeb3b4bc7c443869d">SpeciesAuxData::mparams</a></div><div class="ttdeci">ArrayOfArrayOfAuxData mparams</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00317">absorption.h:317</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_ace534a09a20ff381fd83fd67761810efa88394e7381e5bfd835e3a4fc3db24d54"><div class="ttname"><a href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810efa88394e7381e5bfd835e3a4fc3db24d54">SpeciesAuxData::AT_NONE</a></div><div class="ttdeci">@ AT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00220">absorption.h:220</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_a4cbe4d27aff1c1f00135be6f14461f33"><div class="ttname"><a href="classSpeciesAuxData.html#a4cbe4d27aff1c1f00135be6f14461f33">SpeciesAuxData::nspecies</a></div><div class="ttdeci">Index nspecies() const</div><div class="ttdoc">Returns number of species.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00239">absorption.h:239</a></div></div>
<div class="ttc" id="aclassSpeciesTag_html_aefba8571b13a2b77b4e046a77939ca83"><div class="ttname"><a href="classSpeciesTag.html#aefba8571b13a2b77b4e046a77939ca83">SpeciesTag::Isotopologue</a></div><div class="ttdeci">Index Isotopologue() const</div><div class="ttdoc">Isotopologue species index.</div><div class="ttdef"><b>Definition:</b> <a href="abs__species__tags_8h_source.html#l00087">abs_species_tags.h:87</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_a9241e409c2b7a56789faf65196103ace"><div class="ttname"><a href="classSpeciesAuxData.html#a9241e409c2b7a56789faf65196103ace">SpeciesAuxData::InitFromSpeciesData</a></div><div class="ttdeci">void InitFromSpeciesData()</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00059">absorption.cc:59</a></div></div>
<div class="ttc" id="acia_8cc_html_aa5e69bbdf03c635c138519482cd20dfb"><div class="ttname"><a href="cia_8cc.html#aa5e69bbdf03c635c138519482cd20dfb">SPEED_OF_LIGHT</a></div><div class="ttdeci">const Numeric SPEED_OF_LIGHT</div></div>
<div class="ttc" id="afile_8h_html"><div class="ttname"><a href="file_8h.html">file.h</a></div><div class="ttdoc">This file contains basic functions to handle ASCII files.</div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_ace534a09a20ff381fd83fd67761810ef"><div class="ttname"><a href="classSpeciesAuxData.html#ace534a09a20ff381fd83fd67761810ef">SpeciesAuxData::AuxType</a></div><div class="ttdeci">AuxType</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8h_source.html#l00219">absorption.h:219</a></div></div>
<div class="ttc" id="amatpack_8h_html_aedca4b4670b166565b5b40c700d65a7c"><div class="ttname"><a href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a></div><div class="ttdeci">INDEX Index</div><div class="ttdoc">The type to use for all integer numbers and indices.</div><div class="ttdef"><b>Definition:</b> <a href="matpack_8h_source.html#l00039">matpack.h:39</a></div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_ab85ad6bc45f2cbce376145d8f1bc15a5"><div class="ttname"><a href="namespaceARTS_1_1Var.html#ab85ad6bc45f2cbce376145d8f1bc15a5">ARTS::Var::abs_p</a></div><div class="ttdeci">Vector abs_p(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02129">autoarts.h:2129</a></div></div>
<div class="ttc" id="aclassSpeciesAuxData_html_ad4a71a5b6d023ce15f1dd743416c57f7"><div class="ttname"><a href="classSpeciesAuxData.html#ad4a71a5b6d023ce15f1dd743416c57f7">SpeciesAuxData::getTypeString</a></div><div class="ttdeci">String getTypeString(const Index species, const Index isotopologue) const</div><div class="ttdoc">Return a parameter type as string.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00161">absorption.cc:161</a></div></div>
<div class="ttc" id="aabsorption_8cc_html_affc649df9d1d58549f338aee146982f8"><div class="ttname"><a href="absorption_8cc.html#affc649df9d1d58549f338aee146982f8">xsec_species</a></div><div class="ttdeci">void xsec_species(Matrix &amp;xsec, Matrix &amp;source, Matrix &amp;phase, ArrayOfMatrix &amp;dxsec_dx, ArrayOfMatrix &amp;dsource_dx, ArrayOfMatrix &amp;dphase_dx, const ArrayOfRetrievalQuantity &amp;jacobian_quantities, const ArrayOfIndex &amp;jacobian_propmat_positions, const Vector &amp;f_grid, const Vector &amp;abs_p, const Vector &amp;abs_t, const EnergyLevelMap &amp;abs_nlte, const Matrix &amp;abs_vmrs, const ArrayOfArrayOfSpeciesTag &amp;abs_species, const AbsorptionLines &amp;band, const Numeric &amp;isot_ratio, const SpeciesAuxData::AuxType &amp;partfun_type, const ArrayOfGriddedField1 &amp;partfun_data)</div><div class="ttdoc">Cross-section algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="absorption_8cc_source.html#l00616">absorption.cc:616</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdoc">The Vector class.</div><div class="ttdef"><b>Definition:</b> <a href="matpackI_8h_source.html#l00860">matpackI.h:860</a></div></div>
<div class="ttc" id="aclassSpeciesTag_html_a5830fa3d4aa5b07e2da5dbbdca682db9"><div class="ttname"><a href="classSpeciesTag.html#a5830fa3d4aa5b07e2da5dbbdca682db9">SpeciesTag::Species</a></div><div class="ttdeci">Index Species() const</div><div class="ttdoc">Molecular species index.</div><div class="ttdef"><b>Definition:</b> <a href="abs__species__tags_8h_source.html#l00064">abs_species_tags.h:64</a></div></div>
<div class="ttc" id="aclassArray_html_a90ce1cf3f99646da9d0efd6e8a661369"><div class="ttname"><a href="classArray.html#a90ce1cf3f99646da9d0efd6e8a661369">Array::nelem</a></div><div class="ttdeci">Index nelem() const</div><div class="ttdoc">Number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00195">array.h:195</a></div></div>
<div class="ttc" id="aclassLinefunctions_1_1InternalData_html_ab601be0a3533006883949c8b234e9bb5"><div class="ttname"><a href="classLinefunctions_1_1InternalData.html#ab601be0a3533006883949c8b234e9bb5">Linefunctions::InternalData::F</a></div><div class="ttdeci">Eigen::VectorXcd F</div><div class="ttdef"><b>Definition:</b> <a href="linefunctions_8h_source.html#l00520">linefunctions.h:520</a></div></div>
<div class="ttc" id="aarts_8h_html"><div class="ttname"><a href="arts_8h.html">arts.h</a></div><div class="ttdoc">The global header file for ARTS.</div></div>
<div class="ttc" id="anamespaceARTS_1_1Var_html_aea97dfc5c925ab9fa8660722090cb8b6"><div class="ttname"><a href="namespaceARTS_1_1Var.html#aea97dfc5c925ab9fa8660722090cb8b6">ARTS::Var::abs_nlte</a></div><div class="ttdeci">EnergyLevelMap abs_nlte(Workspace &amp;ws) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="autoarts_8h_source.html#l02111">autoarts.h:2111</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="absorption_8cc.html">absorption.cc</a></li>
    <li class="footer">Generated on Thu Oct 15 2020 08:52:57 for ARTS by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
