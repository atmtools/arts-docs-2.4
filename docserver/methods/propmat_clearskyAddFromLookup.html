<!DOCTYPE html>
<html lang="en">
<head>
<title>propmat_clearskyAddFromLookup - ARTS built-in documentation server</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" href="../styles.css">
</head>
<body>
<div id="navbar"><div class="breadcrumbs"><a href="../index.html">Home</a>&nbsp;>>&nbsp;<a href="../methods.html">Methods</a>&nbsp;>>&nbsp;propmat_clearskyAddFromLookup</div>
<div class="goto">Go to: <a href="../groups/index.html">Groups</a>&nbsp;-&nbsp;<a href="../variables/index.html">Variables</a>&nbsp;-&nbsp;<a href="index.html">Methods</a>&nbsp;-&nbsp;<a href="../agendas/index.html">Agendas</a></div></div>
<div class="content">
<h1>ARTS built-in documentation server</h1>
<h2>Workspace Method propmat_clearskyAddFromLookup</h2>
<h3>Description</h3>
<pre>
Extract gas absorption coefficients from lookup table.

This extracts the absorption coefficient for all species from the
lookup table, and adds them to the propagation matrix. Extraction is
for one specific atmospheric condition, i.e., a set of pressure,
temperature, and VMR values.

Some special species are ignored, for example Zeeman species and free
electrons, since their absorption properties are not simple scalars
and cannot be handled by the lookup table.

The interpolation order in T and H2O is given by <a href="../variables/abs_t_interp_order.html">abs_t_interp_order</a>
and <a href="../variables/abs_nls_interp_order.html">abs_nls_interp_order</a>, respectively.

Extraction is done for the frequencies in f_grid. Frequency
interpolation is controlled by <a href="../variables/abs_f_interp_order.html">abs_f_interp_order</a>. If this is zero,
then f_grid must either be the same as the internal frequency grid of
the lookup table (for efficiency reasons, only the first and last
element of f_grid are checked), or must have only a single element.
If <a href="../variables/abs_f_interp_order.html">abs_f_interp_order</a> is above zero, then frequency is interpolated
along with the other interpolation dimensions. This is useful for
calculations with Doppler shift.

For Doppler calculations, you should generate the table with a
somewhat larger frequency grid than the calculation itself has, since
the Doppler shift will push the frequency grid out of the table range
on one side.

Some extrapolation is allowed. For pressure and frequency interpolation
the standard extrapolation factor of 0.5 is applied. The factor is the
default for temperature and VMR interpolation, but the extrapolation
limit can here be adjusted by the *extpolfac* argument.

See also: <a href="propmat_clearskyAddOnTheFly.html">propmat_clearskyAddOnTheFly</a>.

</pre>

<p><b>Authors: </b>Stefan Buehler, Richard Larsson
<h3>Synopsis</h3>
<p><table><tr><td>propmat_clearskyAddFromLookup(&nbsp;</td><td><a href="../variables/propmat_clearsky.html">propmat_clearsky</a>, <a href="../variables/dpropmat_clearsky_dx.html">dpropmat_clearsky_dx</a>, <a href="../variables/abs_lookup.html">abs_lookup</a>, <a href="../variables/abs_lookup_is_adapted.html">abs_lookup_is_adapted</a>, <a href="../variables/abs_p_interp_order.html">abs_p_interp_order</a>, <a href="../variables/abs_t_interp_order.html">abs_t_interp_order</a>, <a href="../variables/abs_nls_interp_order.html">abs_nls_interp_order</a>, <a href="../variables/abs_f_interp_order.html">abs_f_interp_order</a>, <a href="../variables/f_grid.html">f_grid</a>, <a href="../variables/rtp_pressure.html">rtp_pressure</a>, <a href="../variables/rtp_temperature.html">rtp_temperature</a>, <a href="../variables/rtp_vmr.html">rtp_vmr</a>, <a href="../variables/jacobian_quantities.html">jacobian_quantities</a>, extpolfac )</td></tr></table>
<h3>Variables</h3>
<table>
<tr><td>OUT+IN</td><td class="right"><a href="../variables/propmat_clearsky.html">propmat_clearsky</a></td><td>(<a href="../groups/ArrayOfPropagationMatrix.html">ArrayOfPropagationMatrix</a>)</td><td>This contains the absorption coefficients for one point in the atmosphere (one set of pressure, temperature, magnetic field, and VMR values).</td></tr>
<tr><td>OUT+IN</td><td class="right"><a href="../variables/dpropmat_clearsky_dx.html">dpropmat_clearsky_dx</a></td><td>(<a href="../groups/ArrayOfPropagationMatrix.html">ArrayOfPropagationMatrix</a>)</td><td>Partial derivative of absorption coefficients.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/abs_lookup.html">abs_lookup</a></td><td>(<a href="../groups/GasAbsLookup.html">GasAbsLookup</a>)</td><td>An absorption lookup table.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/abs_lookup_is_adapted.html">abs_lookup_is_adapted</a></td><td>(<a href="../groups/Index.html">Index</a>)</td><td>Flag to indicate whether <a href="abs_lookupAdapt.html">abs_lookupAdapt</a> has already been called.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/abs_p_interp_order.html">abs_p_interp_order</a></td><td>(<a href="../groups/Index.html">Index</a>)</td><td>The interpolation order to use when interpolating absorption between pressure levels.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/abs_t_interp_order.html">abs_t_interp_order</a></td><td>(<a href="../groups/Index.html">Index</a>)</td><td>The interpolation order to use when interpolating absorption between the temperature values given by <a href="../variables/abs_t_pert.html">abs_t_pert</a>.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/abs_nls_interp_order.html">abs_nls_interp_order</a></td><td>(<a href="../groups/Index.html">Index</a>)</td><td>The interpolation order to use when interpolating absorption between the H2O values given by <a href="../variables/abs_nls_pert.html">abs_nls_pert</a>.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/abs_f_interp_order.html">abs_f_interp_order</a></td><td>(<a href="../groups/Index.html">Index</a>)</td><td>Frequency interpolation order for absorption lookup table.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/f_grid.html">f_grid</a></td><td>(<a href="../groups/Vector.html">Vector</a>)</td><td>The frequency grid for monochromatic pencil beam calculations.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/rtp_pressure.html">rtp_pressure</a></td><td>(<a href="../groups/Numeric.html">Numeric</a>)</td><td>Pressure at a radiative transfer point.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/rtp_temperature.html">rtp_temperature</a></td><td>(<a href="../groups/Numeric.html">Numeric</a>)</td><td>Temperature at a radiative transfer point.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/rtp_vmr.html">rtp_vmr</a></td><td>(<a href="../groups/Vector.html">Vector</a>)</td><td>Absorption species abundances for radiative transfer calculations.</td></tr>
<tr><td>IN</td><td class="right"><a href="../variables/jacobian_quantities.html">jacobian_quantities</a></td><td>(<a href="../groups/ArrayOfRetrievalQuantity.html">ArrayOfRetrievalQuantity</a>)</td><td>The retrieval quantities in the Jacobian matrix.</td></tr>
<tr><td>GIN</td><td class="right">extpolfac</td><td>(<a href="../groups/Numeric.html">Numeric</a>, Default: 0.5)</td><td>Extrapolation factor (for temperature and VMR grid edges).</td></tr>
</table>
</div>
<div class="footer">Page generated by arts-2.4.0 (git: 4fb77825)</div>

</body>
</html>